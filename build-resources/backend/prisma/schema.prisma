generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearchPostgres"]
  schemaFolders   = ["./prisma/schema"]
  engineType      = "client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Diagnostic {
  id                         String  @id @default(cuid())
  pharmacyId                 String? @unique
  name                       String?
  smsPhone                   String?
  sendPCSMS                  Boolean @default(false)
  phone1                     String?
  phone2                     String?
  address                    String?
  logo                       String?
  offlineLogo                String?
  division                   String
  city                       String?
  email                      String?
  isEmailVerified            Boolean @default(false)
  // template settings
  printTemplate              String?
  printIndoorTemplate        Int     @default(1)
  printIndoorSummaryTemplate Int     @default(1)
  printAdmissionTemplate     Int     @default(1)
  printLabTemplate           Int     @default(1)

  // hospital management settings managed by superadmin

  isHospitalManagement  Boolean  @default(false)
  isOutdoorManagement   Boolean  @default(true)
  isPCManagement        Boolean  @default(true)
  isIncomeManagement    Boolean  @default(true)
  inExpenseManagement   Boolean  @default(true)
  showStatements        Boolean  @default(true)
  isLabManagement       Boolean?
  isSerialManagement    Boolean?
  isInventoryManagement Boolean?
  isMarketingManagement Boolean?
  isSMSManagement       Boolean?

  // permission settings

  paymentDate                         DateTime  @default(now())
  paymentAmount                       Float?
  isPCSamePayment                     Boolean?
  isAddDoctor                         Boolean?
  isAddTest                           Boolean?
  isEditPatient                       Boolean?
  isEditDoctor                        Boolean?
  isEditDiscount                      Boolean?
  isRefundBillPermission              Boolean?
  isDoctorPayPermission               Boolean?
  isDoctorSetPermission               Boolean?
  isPCPayPermission                   Boolean?
  isPCSetPermission                   Boolean?
  isShowCommissionExpense             Boolean?
  isShowAccessoryInBill               Boolean?
  isTestDiscountIncludeInBill         Boolean?
  enableTokenPrintInSerialMS          Boolean   @default(false)
  enableQueueManagementInSerialMS     Boolean   @default(false)
  enableBreakSystemInSerialMS         Boolean   @default(false)
  enableBedGraceCheckout              Boolean   @default(false)
  bedGraceCheckoutFrom                DateTime?
  bedGraceCheckoutTo                  DateTime?
  allowManualBedDayOverride           Boolean   @default(false)
  enableBedDurationGrace              Boolean   @default(false)
  bedDurationGraceMinutes             Int?
  enableBranch                        Boolean  @default(false)
  enableDepartment                    Boolean  @default(false)
  isShowDueWatermark                  Boolean?
  isShowPaidWatermark                 Boolean?
  isShowRefundedWatermark             Boolean?
  isIndoorPaymentEnabled              Boolean?
  isAttendanceEnabled                 Boolean?
  isSalaryManagementEnabled           Boolean?
  allowIndoorReleaseWithOutdoorDue    Boolean   @default(false)
  allowIndoorReleaseWithIndoorDue     Boolean   @default(false)
  allowOutdoorBillClearanceFromIndoor Boolean   @default(false)
  allowIndoorToAddOPD                 Boolean   @default(false)
  isDutyDoctorSameAsReferredDoctor    Boolean?  @default(false)
  isAdmissionFeePaymentReceiver       Boolean?  @default(false)
  filterDoctorCommissionByReferenceType Boolean? @default(false)
  filterPcCommissionByReferenceType   Boolean? @default(false)

  isAccessoriesIncludedInDiscountCalculation Boolean? @default(false)
  isAccessoriesIncludedInRefundCalculation Boolean? @default(false)

  isDoctorPaymentPerTest            Boolean? // true then deduct from doctor's commission
  isPCPaymentPerTest                Boolean?
  isDoctorCommissionEnabled         Boolean?           @default(false)
  // isPcCommissio
  doctorCommissionBasis             COMMISSION_BASE?
  includeDiscountInPcCommission     Boolean?           @default(true)
  includeDiscountInDoctorCommission Boolean?           @default(false)
  commissionSettings                CommissionSettings @default(INCLUDE_BOTH)
  // SMS Settings 

  sendSMSForBillCreation              Boolean  @default(false)
  sendSMSForLabReportCompletion       Boolean  @default(false)
  sendSMSForSingleLabReportCompletion Boolean  @default(false)
  sendSMSForPatientAdmission          Boolean  @default(false)
  sendSMSForBillPayment               Boolean  @default(false)
  sendSMSForIndoorBillPayment         Boolean  @default(false)
  sendSMSForAppointmentReminder       Boolean  @default(false)
  sendSMSForAbsentEmployee            Boolean? @default(false)
  sendSMSForSalaryDisbursement        Boolean? @default(false)
  sendSMSForSalaryAdvance             Boolean? @default(false)
  sendSMSForSalaryRevision            Boolean? @default(false)
  sendSMSToAdminWhenPcPayment         Boolean? @default(false)
  sendSMSToPCWithPcCode               Boolean? @default(false)

  enableEmployeeLogin            Boolean? @default(false)
  canChangeServiceChargeSettings Boolean?
  canEditReleasedIndoorBill      Boolean?
  showOnlyAdminDoctor            Boolean?
  showCustomFieldInBillCreation  Boolean?

  // receptionist permissions
  canReceptionistChangePcCommission Boolean? @default(true)
  canReceptionistPayMonthlyExpenses Boolean? @default(true)
  canReceptionistPaySalary          Boolean? @default(false)
  canReceptionistPaySalaryAdvance   Boolean? @default(false)
  canReceptionistPayBonus           Boolean? @default(false)
  canReceptionistPaySalaryRevision  Boolean? @default(false)
  canReceptionistPaySalaryDeduction Boolean? @default(false)
  canReceptionistPaySalaryAllowance Boolean? @default(false)
  canReceptionistEditOutdoorBill    Boolean? @default(true)
  canReceptionistEditIndoorBill     Boolean? @default(true)

  // inventory related permissions
  deductInventoryOnBillCreation   Boolean @default(false)
  deductInventoryOnHospitalBill   Boolean @default(false)
  deductInventoryOnTestCompletion Boolean @default(false)
  canReceptionistManageInventory  Boolean @default(false)
  canReceptionistAddToInventory   Boolean @default(false)
  canLabAssistantManageInventory  Boolean @default(false)

  enableOperationCategoryInOperation Boolean? @default(false)
  minimumPercentageToPrint           Int      @default(0)

  maximumPercentageReceptionistCanSetInIndoorBill  Int @default(100)
  maximumPercentageReceptionistCanSetInOutdoorBill Int @default(100)

  middleDate               DateTime?
  firstDeliveryDate        DateTime?
  secondDeliveryDate       DateTime?
  roomCheckInDate          DateTime?
  labStartDate             DateTime?
  lastSyncedWithCloud      DateTime?
  ckEditorToken            String?
  ckEditorUpdateDate       DateTime?
  ckEditorFreePlanDuration Int       @default(14)
  labFirstSign             String?
  labSecondSign            String?
  labThirdSign             String?

  // SasthoTech service charge settings
  serviceCharge                  Int       @default(0)
  indoorServiceCharge            Int       @default(0)
  serviceChargePaymentPeriod     Int       @default(7)
  serviceChargePaymentDate       DateTime?
  serviceChargeExpenseCategoryId String?

  // PC Code Settings
  pcCodeFormat    String @default("numeric") // "numeric", "alphabetic", "mixed", "custom"
  pcCodePrefix    String @default("") // e.g., "PC-", "REF-", etc.
  pcCodeLength    Int    @default(4) // Padding length for numeric portion
  pcCodeStartFrom Int    @default(1) // Starting number

  // Relations
  users                               User[]
  tests                               Test[]
  doctors                             Doctor[]
  labs                                Lab[]
  bills                               Bill[]
  billTest                            BillTest[]
  dailyExpense                        DailyExpense[]
  Appointment                         DoctorAppointment[]
  DoctorChamber                       DoctorChamber[]
  Patient                             Patient[]
  TestCategory                        TestCategory[]
  SubTestCategory                     SubTestCategory[]
  PC                                  PC[]
  commission                          Commission[]
  service                             Service[]
  hospitalBill                        HospitalBill[]
  hospitalBillService                 HospitalBillService[]
  Nurse                               Nurse[]
  dailyExpenseCategory                DailyExpenseCategory[]
  testTemplates                       TestTemplate[]
  accessories                         Accessory[]
  billAccessories                     BillAccessory[]
  pCTestCategoryPercentages           PCTestCategoryPercentage[]
  PCTestPercentages                   PCTestPercentage[]
  doctorTestCategoryPercentages       DoctorTestCategoryPercentage[]
  doctorTestPercentages               DoctorTestPercentage[]
  signatures                          Signatures[]
  servicChargeTrx                     ServiceChargeTrx[]
  operations                          Operation[]
  sugeonOperations                    SurgeonOperation[]
  surgeon                             Surgeon[]
  anesthesiologist                    Anesthesiologist[]
  BedCategory                         BedCategory[]
  BedSubCategory                      BedSubCategory[]
  SurgeonOperationTrx                 SurgeonOperationTrx[]
  Beds                                Bed[]
  BedBookings                         BedBooking[]
  fieldVisibility                     IndoorFieldVisibility?
  serviceVersion                      ServiceVersion[]
  surgeonOperationFee                 SurgeonOperationFee[]
  anethesiologistOperationFee         AnesthesiologistOperationFee[]
  doctorUpdate                        DoctorUpdateInfo[]
  messages                            Message[]
  appointmentSlots                    Slot[]
  followups                           patientFollowups[]
  followupHistory                     PatientFollowupHistory[]
  publicHospital                      publicHospital[]
  monthlyExpenseCategory              MonthlyExpenseCategory[]
  monthlyExpenses                     MonthlyExpense[]
  employees                           Employee[]
  attendances                         Attendance[]
  shifts                              Shift[]
  employeeShifts                      EmployeeShift[]
  leaves                              Leave[]
  leaveTypes                          LeaveType[]
  leavePolicies                       LeavePolicy[]
  attendanceSettings                  AttendanceSettings?
  attendanceLogs                      AttendanceLog[]
  fingerprintDevices                  FingerprintDevice[]
  holidays                            Holiday[]
  salaryStructures                    SalaryStructure[]
  employeeSalaries                    EmployeeSalary[]
  payrollPeriods                      PayrollPeriod[]
  payslips                            Payslip[]
  salaryAdvances                      SalaryAdvance[]
  bonuses                             Bonus[]
  salaryRevisions                     SalaryRevision[]
  allowanceTypes                      AllowanceType[]
  deductionTypes                      DeductionType[]
  advanceRepayments                   AdvanceRepayment[]
  operationCategories                 OperationCategory[]
  operationCategoryBreakdownTemplates OperationCategoryBreakdownFeeTemplate[]
  operationBreakdownFees              OperationBreakdownFee[]
  surgeonOperationBreakdownFees       SurgeonOperationBreakdownFee[]
  smsTemplates                        SMSTemplate[]
  dailyIncomeCategories               DailyIncomeCategory[]
  dailyExtraIncomes                   DailyExtraIncome[]
  smsPackagePurchases                 SMSPackagePurchase[]
  testAccessories                     TestAccessories[]
  stores                              Store[]
  tags                                Tag[]
  storeTags                           StoreTag[]
  storeInventories                    StoreInventoryItems[]
  inventoryItems                      InventoryItem[]
  inventoryTransactions               InventoryTransaction[]
  inventoryPackages                   InventoryPackage[]
  inventoryPackageItems               InventoryPackageItem[]
  deductionSettings                   InventoryItemDeductionSetting[]
  triggerEvent                        TriggerEvent[]
  //  itemDeductionExecutions ItemDeductionExecution[]
  itemsConsumptionTrackers                       ItemConsumptionTracker[]
  doctorSession                                          DoctorSession[]
  sessionNotice                                            SessionNotice[]
  sessionHistories                                       DoctorSessionHistory[]
  missedQueueLogs                                         MissedQueueLog[]
  reportQueues                                               ReportQueue[]
  billInventoryItems                         BillInventoryItem[]
  userPermissions                          UserPermissions[]
  indoorStores                             defaultInventoryStore[]
  userInventoryStores                      UserInventoryStore[]
  scheduledSummaryConfigs                 ScheduledSummaryConfig[]
  versions                               HospitalServiceVersion[]
  discountReferrers                      DiscountReferrer[]
  notifications                                 Notification[]
  notificationPreferences                       NotificationPreference[]
  templates                                     DiagnosticTemplate[]
  templateCategories                            TemplateCategory[]
  documents                                     Document[]
  pcGroups                                     PCGroup[]
  pcGroupMembers                              PCGroupMember[]
  pcVisits                            PCVisit[]
  marketerTargets                     MarketerTarget[]
  scheduleSummaryRecipientConfig          ScheduledSummaryRecipientConfig?

  // Branch and Department Management Relations (NEW)
  branches                      Branch[]
  branchManagers                BranchManager[]
  branchServices                BranchService[]
  branchServicePricing          BranchServicePricing[]
  departments                   Department[]
  departmentManagers            DepartmentManager[]
  departmentFieldConfigurations DepartmentFieldConfiguration[]
  departmentServices            DepartmentService[]
  departmentServicePricing      DepartmentServicePricing[]

  deletedAt DateTime?
  updatedAt DateTime  @default(now()) @updatedAt()

  @@index([division])
}

enum CommissionSettings {
  INCLUDE_BOTH
  EXCLUDE_BOTH
  INCLUDE_PC_ONLY
  INCLUDE_DOCTOR_ONLY
}

model defaultInventoryStore {
  id           String     @id @default(cuid())
  diagnostic   Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String
  store        Store      @relation(fields: [storeId], references: [id], onDelete: Cascade)
  storeId      String
  billType     BillType // e.g., "indoor", "outdoor", "pharmacy", etc.
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  deletedAt    DateTime?

  @@unique([diagnosticId, storeId, billType, deletedAt])
  @@index([diagnosticId, storeId, billType])
}

enum BillType {
  INDOOR
  OUTDOOR
  APPOINTMENT
}

// Public API models
model publicDoctor {
  id              String                   @id @unique @default(uuid())
  smallId         Int
  name            String
  designation     String
  specialties     String?
  qualifications  String?
  hospitals       publicDoctorHospital[]
  specialtiesList publicDoctorSpecialty[]
  createdAt       DateTime                 @default(now())
  updatedAt       DateTime                 @updatedAt
  searchVector    Unsupported("tsvector")?

  // Relation to internal system Doctor
  internalDoctor   Doctor? @relation(fields: [internalDoctorId], references: [id])
  internalDoctorId String?

  @@index([name])
  @@index([designation])
  @@index([specialties])
  @@index([searchVector], type: Gist)
}

model publicHospital {
  id           String                   @id @unique @default(uuid())
  name         String
  smallId      Int
  location     String?
  services     String?
  introduction String?
  webLink      String?
  fbLink       String?
  doctors      publicDoctorHospital[]
  createdAt    DateTime                 @default(now())
  updatedAt    DateTime                 @updatedAt
  searchVector Unsupported("tsvector")?

  // Relation to internal system Diagnostic
  diagnostic   Diagnostic? @relation(fields: [diagnosticId], references: [id])
  diagnosticId String?

  @@index([name])
  @@index([searchVector], type: Gist)
}

model publicDoctorHospital {
  id         String         @id @unique @default(uuid())
  doctorId   String
  doctor     publicDoctor   @relation(fields: [doctorId], references: [id], onDelete: Cascade)
  hospitalId String
  hospital   publicHospital @relation(fields: [hospitalId], references: [id], onDelete: Cascade)
  createdAt  DateTime       @default(now())
  updatedAt  DateTime       @updatedAt
  phone      String?
  time       String?

  @@unique([doctorId, hospitalId])
  @@index([doctorId, hospitalId])
}

model publicSpecialty {
  id        String                  @id @default(uuid())
  name      String                  @unique
  doctors   publicDoctorSpecialty[]
  createdAt DateTime                @default(now())
  updatedAt DateTime                @updatedAt
}

model publicDoctorSpecialty {
  id          String          @id @default(uuid())
  doctorId    String
  doctor      publicDoctor    @relation(fields: [doctorId], references: [id], onDelete: Cascade)
  specialtyId String
  specialty   publicSpecialty @relation(fields: [specialtyId], references: [id], onDelete: Cascade)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt

  @@unique([doctorId, specialtyId])
  @@index([doctorId, specialtyId])
}

model User {
  id                        String                          @id @default(cuid())
  name                      String?
  email                     String                          @unique()
  password                  String
  role                      String
  createdAt                 DateTime                        @default(now())
  updatedAt                 DateTime                        @updatedAt()
  deletedAt                 DateTime?
  labFirstSign              String?
  labSecondSign             String?
  labThirdSign              String?
  Diagnostic                Diagnostic?                     @relation(fields: [diagnosticId], references: [id])
  diagnosticId              String?
  bills                     Bill[]
  expenses                  DailyExpense[]
  hospitalBill              HospitalBill[]
  commissions               Commission[]
  userTestCategory          String[]
  operation                 SurgeonOperation[]
  serviceChargeTrx          ServiceChargeTrx[]
  SurgeonOperationTrx       SurgeonOperationTrx[]
  doctorChamber             DoctorChamber[]
  appointments              DoctorAppointment[]
  collectedTests            BillTest[]                      @relation("collectedBy") // Tests collected by this user
  preparedTests             BillTest[]                      @relation("preparedBy") // Tests prepared by this user
  followups                 PatientFollowupHistory[]
  monthlyExpenses           MonthlyExpense[]
  extraIncomes              DailyExtraIncome[]
  leaveApproved             Leave[]
  attendanceLogs            AttendanceLog[]
  approvedPayrolls          PayrollPeriod[]                 @relation("payrollApprover")
  processedPayslips         Payslip[]                       @relation("payslipProcessor")
  approvedAdvances          SalaryAdvance[]                 @relation("advanceApprover")
  approvedBonuses           Bonus[]                         @relation("bonusApprover")
  approvedSalaryRevisions   SalaryRevision[]                @relation("revisionApprover")
  doctorCommissionPaid      BillTest[]                      @relation("doctorCommissionPaid") // Tests for which this user has paid commission to doctors
  stores                    Store[]
  inventoryItems            InventoryItem[]
  storeInventoryItems       StoreInventoryItems[]
  inventoryTransactions     InventoryTransaction[]
  inventoryPackages         InventoryPackage[]
  deductionSettings         InventoryItemDeductionSetting[]
  triggerEventInInventory   TriggerEvent[]
  doctorSessionHistories    DoctorSessionHistory[]
  reportQueues              ReportQueue[]
  deletedReportQueues       ReportQueue[]                   @relation("ReportQueueDeletedBy")
  permissions               UserPermissions?
  userInventoryStores       UserInventoryStore[]
  appSession                VersionAdminSession[]
  notifications             Notification[]
  versionAdminNotifications Notification[]                  @relation("versionAdminNotifications")
  revokedNotifications      Notification[]                  @relation("notificationRevoker")
  sentNotifications         Notification[]                  @relation("notificationSender")
  notificationPreferences   NotificationPreference[]
  pcGroupMembers            PCGroupMember[]
  pcVisits                  PCVisit[]
  marketerTargets           MarketerTarget[]
  branchManagerId String?        @unique
  branchManager   BranchManager? @relation(fields: [branchManagerId], references: [id])

  departmentManagerId String?            @unique
  departmentManager   DepartmentManager? @relation(fields: [departmentManagerId], references: [id])

  // Branch and Department Manager Relations (NEW)
  assignedBranchManagers     BranchManager[]     @relation("BranchManagerAssignedByUser")
  assignedDepartmentManagers DepartmentManager[] @relation("DepartmentManagerAssignedByUser")

  // itemsConsumptionTrackers ItemConsumptionTracker[]
  @@index([email])
}

model UserPermissions {
  id                             String     @id @default(cuid())
  user                           User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId                         String     @unique
  diagnosticId                   String
  diagnostic                     Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  canManageDoctors               Boolean    @default(true)
  canManagePCs                   Boolean    @default(true)
  canManageTests                 Boolean    @default(true)
  canManageAppointments          Boolean    @default(false)
  canManageOutdoorBills          Boolean    @default(true)
  canManageIndoorBills           Boolean    @default(true)
  canManageExpenses              Boolean    @default(true)
  canManageInventory             Boolean    @default(false)
  canManageIncomes               Boolean    @default(false)
  canManageStatements            Boolean    @default(false)
  canManageSMS                   Boolean    @default(false)
  canManagePathologists          Boolean    @default(false)
  canManageSerialManagers        Boolean    @default(false)
  maximumOutdoorDiscountPercent  Float?
  maximumIndoorDiscountPercent   Float?
  canGiveOutdoorDiscount         Boolean    @default(true)
  canGiveIndoorDiscount          Boolean    @default(true)
  canGiveOutdoorDiscountInAmount Boolean    @default(true)
  canGiveIndoorDiscountInAmount  Boolean    @default(true)
  createdAt                      DateTime   @default(now())
  updatedAt                      DateTime   @updatedAt()
  deletedAt                      DateTime?

  @@unique([userId, diagnosticId])
  @@index([userId, diagnosticId])
}

model Doctor {
  id                            String                         @id @default(cuid())
  name                          String
  image                         String?
  uniqueId                      Int                            @default(-1)
  designation                   String
  phone1                        String?
  phone2                        String?
  percentage                    Float?
  description                   String?
  division                      String
  isAppointed                   Boolean?
  totalCommission               Float                          @default(0)
  totalPaid                     Float                          @default(0)
  createdAt                     DateTime                       @default(now())
  updatedAt                     DateTime                       @updatedAt()
  deletedAt                     DateTime?
  Diagnostic                    Diagnostic?                    @relation(fields: [diagnosticId], references: [id])
  diagnosticId                  String?
  bills                         Bill[]
  doctorChamber                 DoctorChamber[]
  commission                    Commission[]
  hospitalBill                  HospitalBill[]
  doctorUpdateInfo              DoctorUpdateInfo[]
  publicDoctor                  publicDoctor[]
  doctorTestCategoryPercentages DoctorTestCategoryPercentage[]
  doctorTestPercentages         DoctorTestPercentage[]
  referredHospitalBills         HospitalBill[]                 @relation("ReferredDoctorHospitalBill")

  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([diagnosticId, name, designation, deletedAt])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model DoctorUpdateInfo {
  id                    String        @id @default(cuid())
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt()
  doctorUniqueId        Int
  operationName         OperationType @default(UPDATE)
  isApproved            Boolean       @default(false)
  hasActionTaken        Boolean       @default(false)
  approvedAt            DateTime?
  previousDoctorName    String?
  previousDesignation   String?
  Diagnostic            Diagnostic?   @relation(fields: [diagnosticId], references: [id])
  diagnosticId          String?
  Doctor                Doctor?       @relation(fields: [doctorId], references: [id])
  doctorId              String?
  branch                Branch?       @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId              String?
  department            Department?   @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId          String?
  applyToOnlySuperAdmin Boolean?
  applyAllDiagnostics   Boolean?
  diagnosticIds         String[]      @default([])

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model PC {
  id                        String                     @id @default(cuid())
  name                      String
  pcCode                    String?
  fathersName               String                     @default("")
  mobile                    String                     @default("")
  address                   String                     @default("")
  thana                     String                     @default("")
  district                  String                     @default("")
  percentage                Float?
  totalCommission           Float                      @default(0)
  totalPaid                 Float                      @default(0)
  createdAt                 DateTime                   @default(now())
  Diagnostic                Diagnostic                 @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId              String
  branch                    Branch?                    @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId                  String?
  department                Department?                @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId              String?
  bills                     Bill[]
  pcTestCategoryPercentages PCTestCategoryPercentage[]
  pcTestPercentages         PCTestPercentage[]
  commission                Commission[]
  hospitalBill              HospitalBill[]
  operations                SurgeonOperation[]
  appointments              DoctorAppointment[]
  pcGroupMembers            PCGroupMember[]
  pcVisits                  PCVisit[]
  updatedAt                 DateTime                   @default(now()) @updatedAt()
  deletedAt                 DateTime?

  @@unique([name, diagnosticId, deletedAt])
  @@unique([pcCode, diagnosticId, deletedAt])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model PCGroup {
  id           String          @id @default(cuid())
  name         String
  description  String?
  code         String?
  diagnostic   Diagnostic      @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String
  members      PCGroupMember[]
  branch       Branch?         @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department?     @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt()
  deletedAt DateTime?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model PCGroupMember {
  id           String      @id @default(cuid())
  pcGroup      PCGroup     @relation(fields: [pcGroupId], references: [id], onDelete: Cascade)
  pcGroupId    String
  pc           PC          @relation(fields: [pcId], references: [id], onDelete: Cascade)
  pcId         String
  marketerId   String?
  marketer     User?       @relation(fields: [marketerId], references: [id], onDelete: SetNull)
  diagnosticId String
  diagnostic   Diagnostic  @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt()
  deletedAt DateTime?

  @@unique([pcGroupId, pcId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model PCVisit {
  id             String     @id @default(cuid())
  imageUrl       String // proof image (camera only)
  deviceLocation String // google maps location
  userLocation   String // user-entered text (shop name, landmark, etc.)
  note           String? // optional note
  metaData       Json? // additional metadata if needed
  pc             PC         @relation(fields: [pcId], references: [id], onDelete: Cascade)
  pcId           String
  marketer       User       @relation(fields: [marketerId], references: [id], onDelete: Cascade)
  marketerId     String
  diagnostic     Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId   String

  visitedAt DateTime  @default(now())
  createdAt DateTime  @default(now())
  deletedAt DateTime?

  @@index([pcId, marketerId, visitedAt])
  @@index([diagnosticId, visitedAt])
}

model MarketerTarget {
  id String @id @default(cuid())

  marketerId String
  marketer   User   @relation(fields: [marketerId], references: [id], onDelete: Cascade)

  diagnosticId String
  diagnostic   Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)

  targetType  TargetType // DAILY / WEEKLY / MONTHLY / YEARLY
  targetValue Int // 

  startDate DateTime
  endDate   DateTime

  createdById String?
  createdBy   String?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  @@index([marketerId, diagnosticId, targetType])
}

model TestCategory {
  id                           String                         @id @default(cuid())
  name                         String
  roomNo                       String?
  isPcPayable                  Boolean                        @default(false)
  pcAmount                     Float                          @default(0)
  pcAmountType                 String                         @default("percentage")
  isDoctorCommissionaire       Boolean                        @default(false)
  doctorCommissionAmount       Float                          @default(0)
  doctorCommissionType         String                         @default("amount")
  discount                     Float                          @default(0)
  discountType                 String                         @default("percentage")
  tests                        Test[]
  PCTestCategoryPercentage     PCTestCategoryPercentage[]
  DoctorTestCategoryPercentage DoctorTestCategoryPercentage[]
  dignostic                    Diagnostic?                    @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId                 String?
  branch                       Branch?                        @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId                     String?
  department                   Department?                    @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId                 String?
  deletedAt                    DateTime?
  updatedAt                    DateTime                       @default(now()) @updatedAt()

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model PCTestCategoryPercentage {
  id             String       @id @default(cuid())
  discount       Float?
  discountType   String       @default("percentage")
  PC             PC           @relation(fields: [pCId], references: [id], onDelete: Cascade)
  pCId           String
  TestCategory   TestCategory @relation(fields: [testCategoryId], references: [id], onDelete: Cascade)
  testCategoryId String

  updatedAt DateTime @default(now()) @updatedAt()

  dignostic    Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([pCId, testCategoryId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model PCTestPercentage {
  id           String @id @default(cuid())
  discount     Float?
  discountType String @default("percentage")
  PC           PC     @relation(fields: [pCId], references: [id], onDelete: Cascade)
  pCId         String
  test         Test   @relation(fields: [testId], references: [id], onDelete: Cascade)
  testId       String

  updatedAt DateTime @default(now()) @updatedAt()

  dignostic    Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([pCId, testId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model DoctorTestCategoryPercentage {
  id             String       @id @default(cuid())
  discount       Float?
  discountType   String       @default("percentage")
  Doctor         Doctor       @relation(fields: [doctorId], references: [id], onDelete: Cascade)
  doctorId       String
  TestCategory   TestCategory @relation(fields: [testCategoryId], references: [id], onDelete: Cascade)
  testCategoryId String

  updatedAt DateTime @default(now()) @updatedAt()

  diagnostic   Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([doctorId, testCategoryId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model DoctorTestPercentage {
  id           String @id @default(cuid())
  discount     Float?
  discountType String @default("percentage")
  Doctor       Doctor @relation(fields: [doctorId], references: [id], onDelete: Cascade)
  doctorId     String
  test         Test   @relation(fields: [testId], references: [id], onDelete: Cascade)
  testId       String

  updatedAt DateTime @default(now()) @updatedAt()

  diagnostic   Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([doctorId, testId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Commission {
  id                 String     @id @default(cuid())
  totalAmount        Float
  paidAmount         Float
  info               Json?
  createdAt          DateTime   @default(now())
  isTestWise         Boolean    @default(false)
  diagnostic         Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId       String
  doctor             Doctor?    @relation(fields: [doctorId], references: [id], onDelete: Cascade)
  doctorId           String?
  pC                 PC?        @relation(fields: [pCId], references: [id], onDelete: Cascade)
  pCId               String?
  user               User?      @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId             String?
  isIndoorCommission Boolean    @default(false)
  updatedAt          DateTime   @default(now()) @updatedAt()
  deletedAt          DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  // Dashboard query indexes - OPTIMIZED
  @@index([diagnosticId, createdAt, isIndoorCommission, deletedAt])
  @@index([diagnosticId, isIndoorCommission, pCId, deletedAt])
  @@index([diagnosticId, isIndoorCommission, doctorId, deletedAt])
  @@index([diagnosticId, branchId, departmentId])
}

model Test {
  id                    String                 @id @default(cuid())
  name                  String
  roomNo                String?
  price                 Float?
  sample                String?
  discount              Float                  @default(0)
  discountType          String                 @default("percentage")
  reportDelayInDays     Int?                   @default(0) // delay in days for report generation
  reportDelayInHours    Int?                   @default(0) // delay in hours for report generation
  reportDelayInMinutes  Int?                   @default(0) // delay in minutes for report generation
  showOnLab             Boolean?               @default(true)
  dignostic             Diagnostic?            @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId          String?
  billTest              BillTest[]
  testCategory          TestCategory           @relation(fields: [testCategoryId], references: [id], onDelete: Cascade)
  testCategoryId        String
  subTestCategory       SubTestCategory?       @relation(fields: [subTestCategoryId], references: [id], onDelete: Cascade)
  subTestCategoryId     String?
  testTemplates         TestTemplate[]
  pcTestPercentages     PCTestPercentage[]
  doctorTestPercentages DoctorTestPercentage[]
  pcAmount              Float                  @default(0)
  pcAmountType          String                 @default("percentage")

  doctorCommissionAmount Float  @default(0)
  doctorCommissionType   String @default("amount")

  isDoctorPayable  Boolean @default(false)
  doctorAmount     Float   @default(0)
  doctorAmountType String  @default("amount")

  deletedAt         DateTime?
  updatedAt         DateTime                        @default(now()) @updatedAt()
  testAccessories   TestAccessories[]
  deductionSettings InventoryItemDeductionSetting[]
  triggerEvent      TriggerEvent[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Accessory {
  id              String            @id @default(cuid())
  name            String
  price           Float?
  discount        Float             @default(0)
  discountType    String            @default("percentage")
  diagnostic      Diagnostic?       @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId    String?
  billAccessories BillAccessory[]
  deletedAt       DateTime?
  updatedAt       DateTime          @default(now()) @updatedAt()
  testAccessories TestAccessories[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model TestAccessories {
  id           String      @id @default(cuid())
  testId       String
  test         Test        @relation(fields: [testId], references: [id], onDelete: Cascade)
  accessoryId  String
  accessory    Accessory   @relation(fields: [accessoryId], references: [id], onDelete: Cascade)
  diagnosticId String?
  diagnostic   Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  // deletedAt       DateTime??
  name         String
  quantity     Int         @default(0)
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @default(now()) @updatedAt()
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model TestTemplate {
  id                 String      @id @default(cuid())
  name               String
  value              String
  isItFromSuperAdmin Boolean     @default(false)
  sourceDiagnosticId String?
  Test               Test        @relation(fields: [testId], references: [id], onDelete: Cascade)
  testId             String
  dignostic          Diagnostic? @relation(fields: [diagnosticId], references: [id])
  diagnosticId       String?
  reports            BillTest[]
  deletedAt          DateTime?
  updatedAt          DateTime    @default(now()) @updatedAt()

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Lab {
  id           String      @id @default(cuid())
  name         String
  labId        String      @unique
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt()
  dignostic    Diagnostic? @relation(fields: [diagnosticId], references: [id])
  diagnosticId String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Patient {
  id                       String    @id @default(cuid())
  patientId                Int       @default(autoincrement())
  name                     String
  email                    String?
  photo                    String?
  phone                    String
  ageYear                  Int?
  ageMonth                 Int?
  ageDay                   Int?
  gender                   String?
  address                  String    @default("")
  thana                    String    @default("")
  district                 String    @default("")
  createdAt                DateTime  @default(now())
  deletedAt                DateTime?
  updatedAt                DateTime  @default(now()) @updatedAt()
  // fields for Authentication
  enablePasswordBasedLogin Boolean   @default(false)
  password                 String?
  lastLoggedIn             DateTime?
  lastLoginIp              String?
  failedLoginAttempts      Int?      @default(0)
  lastFailedLogin          DateTime?
  securityTimestamp        DateTime?
  // For admin login
  lastAdminLoggedIn        DateTime?
  lastAdminLoginIp         String?
  temporaryPassword        String?
  temporaryPasswordExpire  DateTime?

  //For Password Reset
  resetPasswordToken   String?
  resetPasswordExpires DateTime?

  // User status tracking
  isActive      Boolean @default(true)
  emailVerified Boolean @default(false)

  // Relations
  diagnostic       Diagnostic?         @relation(fields: [diagnosticId], references: [id])
  diagnosticId     String?
  bills            Bill[]
  hospitalBill     HospitalBill[]
  operations       SurgeonOperation[]
  bedBooking       BedBooking[]
  appointments     DoctorAppointment[]
  followups        patientFollowups[]
  otp              OTPVerification[]
  activeToken      ActiveToken[]
  blackListedToken TokenBlacklist[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([phone, name, diagnosticId])
  @@index([phone])
  @@index([patientId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model ActiveToken {
  id         String   @id @default(cuid())
  jti        String   @unique
  patientId  String
  ipAddress  String?
  deviceInfo Json?
  lastUsed   DateTime @default(now())
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now()) @updatedAt // add default value of now
  tokenType  String // "access" or "refresh"
  patient    Patient  @relation(fields: [patientId], references: [id])

  @@index([patientId])
  @@index([jti])
}

model TokenBlacklist {
  id            String   @id @default(cuid())
  jti           String   @unique // The JWT ID that was blacklisted
  tokenType     String // "access" or "refresh"
  patientId     String? // Reference to the user who owned this token
  issuedAt      DateTime // When the token was originally issued
  expiresAt     DateTime // When the token naturally expires
  blacklistedAt DateTime @default(now())
  reason        String? // Why it was blacklisted (e.g., "logout", "compromise")
  ipAddress     String? // IP address that requested the blacklisting
  updatedAt     DateTime @default(now()) @updatedAt // add default value of now 
  patient       Patient? @relation(fields: [patientId], references: [id])

  @@index([jti])
  @@index([expiresAt])
  @@index([patientId])
}

model Bill {
  id                        String    @id @default(cuid())
  billId                    String
  labId                     String
  customId                  String?
  name                      String
  ageYear                   Int?
  ageMonth                  Int?
  ageDay                    Int?
  gender                    String
  phone                     String
  src                       String    @default("online")
  totalAmout                Float
  paidAmount                Float
  paidInAmount              Float     @default(0)
  commissionAmount          Float     @default(0)
  doctorCommissionAmount    Float     @default(0)
  hospitalDiscount          Float
  hospitalDiscountType      String    @default("percentage")
  discountReference         String?
  totalAmountWithDiscount   Float     @default(0)
  totalInAmountWithDiscount Float     @default(0)
  doctorPercentage          Float     @default(0)
  pcPercentage              Float     @default(0)
  referenceBy               String
  isPaid                    Boolean   @default(false)
  isCommissionPaid          Boolean   @default(false)
  isDoctorCommissionPaid    Boolean   @default(false)
  status                    String    @default("created")
  refundedAmount            Int       @default(0)
  serviceCharge             Int       @default(0)
  isServiceChargePaid       Boolean   @default(false)
  isAccessoriesIncludedInDiscountCalculation Boolean? @default(false)
  type                      String    @default("new")
  deliveryDate              DateTime?
  createdAt                 DateTime  @default(now())
  updatedAt                 DateTime  @updatedAt()
  deletedAt                 DateTime?
  hospitalBillId            String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  dignostic          Diagnostic?       @relation(fields: [diagnosticId], references: [id])
  diagnosticId       String?
  doctor             Doctor?           @relation(fields: [doctorId], references: [id])
  doctorId           String?
  tests              BillTest[]
  user               User?             @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId             String?
  patient            Patient?          @relation(fields: [patientId], references: [id])
  patientId          String?
  PC                 PC?               @relation(fields: [pCId], references: [id])
  pCId               String?
  discountReferrer   DiscountReferrer? @relation(fields: [discountReferrerId], references: [id])
  discountReferrerId String?
  remarks            String?
  accessories        BillAccessory[]

  @@index([billId])
  @@index([doctorId, diagnosticId])
  @@index([labId, diagnosticId])
  @@index([billId, diagnosticId])
  // Dashboard query indexes - OPTIMIZED
  @@index([diagnosticId, createdAt, type, deletedAt])
  @@index([diagnosticId, type, deletedAt])
  @@index([diagnosticId, deletedAt])
  // Branch and Department indexes - OPTIMIZED
  @@index([diagnosticId, branchId, departmentId])
}

model BillTest {
  id                String             @id @default(cuid())
  name              String
  roomNo            String?
  price             Float
  discount          Float
  isTestSample      Boolean            @default(false)
  template          String?
  order             Int?
  discountType      String             @default("percentage")
  deliveryDate      DateTime?
  // reportDelayInDays Int? @default(0) // delay in days for report generation
  // reportDelayInHours Int? @default(0) // delay in hours for report generation
  // reportDelayInMinutes Int? @default(0) // delay in minutes for report generation
  isDeliver         Boolean            @default(false)
  isInitial         Boolean            @default(false)
  isRefunded        Boolean            @default(false)
  isShowInLab       Boolean            @default(true)
  createdAt         DateTime           @default(now())
  dignostic         Diagnostic?        @relation(fields: [diagnosticId], references: [id])
  diagnosticId      String?
  test              Test?              @relation(fields: [testId], references: [id], onDelete: SetNull)
  testId            String?
  bill              Bill?              @relation(fields: [billId], references: [id], onDelete: Cascade)
  billId            String?
  appointment       DoctorAppointment? @relation(fields: [appointmentId], references: [id], onDelete: SetNull)
  appointmentId     String?
  testTemplate      TestTemplate?      @relation(fields: [testTemplateId], references: [id], onDelete: Cascade)
  testTemplateId    String?
  savedWithoutValue Boolean            @default(false)
  sampleCollectedAt DateTime?
  reportGeneratedAt DateTime?
  reportStatus      ReportStatus       @default(PENDING)
  collectedBy       User?              @relation("collectedBy", fields: [collectedByUserId], references: [id], onDelete: Cascade)
  collectedByUserId String?
  preparedBy        User?              @relation("preparedBy", fields: [preparedByUserId], references: [id], onDelete: Cascade)
  preparedByUserId  String?
  remarks           String?
  updatedAt         DateTime           @default(now()) @updatedAt()
  deletedAt         DateTime?

  // doctor payment related fields
  isDoctorPayable          Boolean   @default(false)
  doctorAmount             Float     @default(0)
  doctorAmountType         String    @default("amount") // "amount" or "percentage
  isDoctorCommissionPaid   Boolean   @default(false)
  doctorCommissionPaidAt   DateTime?
  doctorCommissionPaidBy   User?     @relation("doctorCommissionPaid", fields: [doctorCommissionPaidById], references: [id], onDelete: SetNull)
  doctorCommissionPaidById String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  // Primary query filter indexes
  @@index([diagnosticId, deletedAt, isShowInLab])
  @@index([billId])
  @@index([testId])
  // Date-based filtering indexes
  @@index([diagnosticId, createdAt])
  @@index([diagnosticId, updatedAt])
  // For relationship lookups
  @@index([collectedByUserId])
  @@index([preparedByUserId])
  @@index([testTemplateId])
  // Branch and Department - OPTIMIZED
  @@index([diagnosticId, branchId, departmentId])
}

model BillAccessory {
  id          String    @id @default(cuid())
  bill        Bill      @relation(fields: [billId], references: [id], onDelete: Cascade)
  billId      String
  accessory   Accessory @relation(fields: [accessoryId], references: [id], onDelete: Cascade)
  accessoryId String
  quantity    Int       @default(1)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt()
  deletedAt   DateTime?

  dignostic    Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model DailyExpenseCategory {
  id            String         @id @default(cuid())
  name          String
  dailyExpenses DailyExpense[]
  dignostic     Diagnostic?    @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId  String?
  updatedAt     DateTime       @default(now()) @updatedAt()
  deletedAt     DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model DailyExpense {
  id                     String                @id @default(cuid())
  handedTo               String
  amount                 Int
  type                   String?
  createdAt              DateTime              @default(now())
  diagnostic             Diagnostic?           @relation(fields: [diagnosticId], references: [id])
  diagnosticId           String
  User                   User?                 @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId                 String?
  DailyExpenseCategory   DailyExpenseCategory? @relation(fields: [dailyExpenseCategoryId], references: [id])
  dailyExpenseCategoryId String?
  isIndoorExpense        Boolean               @default(false)
  serviceChargeTrx       ServiceChargeTrx?
  SurgeonOperationTrx    SurgeonOperationTrx?
  reason                 String?
  referenceId            String?
  updatedAt              DateTime              @default(now()) @updatedAt()
  deletedAt              DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  // Dashboard query indexes - OPTIMIZED
  @@index([diagnosticId, createdAt, deletedAt, isIndoorExpense])
  @@index([diagnosticId, branchId, departmentId])
}

model MonthlyExpenseCategory {
  id              String           @id @default(cuid())
  name            String
  amount          Int              @default(0)
  monthlyExpenses MonthlyExpense[]
  diagnostic      Diagnostic       @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId    String
  isIndoorExpense Boolean          @default(false)
  updatedAt       DateTime         @default(now()) @updatedAt()
  createdAt       DateTime         @default(now())
  deletedAt       DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([name, diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model MonthlyExpense {
  id                       String                 @id @default(cuid())
  amount                   Int
  type                     String?
  isIndoorExpense          Boolean                @default(false)
  diagnostic               Diagnostic             @relation(fields: [diagnosticId], references: [id])
  diagnosticId             String
  MonthlyExpenseCategory   MonthlyExpenseCategory @relation(fields: [monthlyExpenseCategoryId], references: [id])
  monthlyExpenseCategoryId String
  paidBy                   User?                  @relation(fields: [paidById], references: [id], onDelete: SetNull)
  paidById                 String?
  paidAt                   DateTime?
  expenseMonth             Int
  expenseYear              Int
  createdAt                DateTime               @default(now())
  updatedAt                DateTime               @default(now()) @updatedAt()
  deletedAt                DateTime?
  notes                    String?
  // @@unique([monthlyExpenseCategoryId, diagnosticId, expenseMonth, expenseYear])

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId, monthlyExpenseCategoryId, expenseMonth, expenseYear])
  @@index([paidById, diagnosticId])
  @@index([paidAt])
  @@index([diagnosticId, branchId, departmentId])
}

model DailyIncomeCategory {
  id           String             @id @default(cuid())
  name         String
  incomes      DailyExtraIncome[] // Relation to incomes
  diagnostic   Diagnostic?        @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?
  updatedAt    DateTime           @default(now()) @updatedAt
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

// Now create the DailyExtraIncome model, similar to DailyExpense
model DailyExtraIncome {
  id                    String               @id @default(cuid())
  receivedFrom          String // Person or entity income was received from
  amount                Int // Amount in the smallest currency unit (e.g., cents)
  type                  String? // Optional type field
  description           String? // Brief description of the income
  createdAt             DateTime             @default(now())
  diagnostic            Diagnostic?          @relation(fields: [diagnosticId], references: [id])
  diagnosticId          String
  User                  User?                @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId                String? // User who recorded this income
  DailyIncomeCategory   DailyIncomeCategory? @relation(fields: [dailyIncomeCategoryId], references: [id])
  dailyIncomeCategoryId String?
  isIndoorIncome        Boolean              @default(false) // Whether related to indoor department
  invoiceNumber         String? // Optional reference number/invoice
  paymentMethod         String? // Method of payment (cash, card, etc.)
  updatedAt             DateTime             @default(now()) @updatedAt()
  deletedAt             DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId, createdAt, deletedAt])
  @@index([userId])
  @@index([dailyIncomeCategoryId])
  @@index([diagnosticId, branchId, departmentId])
}

model ContactUs {
  id             String   @id @default(cuid())
  name           String
  status         String   @default("Panding")
  diagnosticName String
  phone          String
  email          String
  district       String
  division       String
  createdAt      DateTime @default(now())

  updatedAt DateTime  @default(now()) @updatedAt()
  deletedAt DateTime?
}

model Service {
  id                  String                @id @default(cuid())
  name                String
  price               Float?
  dignostic           Diagnostic?           @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId        String?
  hospitalBillService HospitalBillService[]

  // Branch and Department Relations (NEW)
  branchServices     BranchService[]
  branchPricing      BranchServicePricing[]
  departmentServices DepartmentService[]
  departmentPricing  DepartmentServicePricing[]

  updatedAt DateTime  @default(now()) @updatedAt()
  deletedAt DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Nurse {
  id           String         @id @default(cuid())
  name         String
  createdAt    DateTime       @default(now())
  Diagnostic   Diagnostic     @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String
  hospitalBill HospitalBill[]

  updatedAt DateTime  @default(now()) @updatedAt()
  deletedAt DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([name, diagnosticId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model DiscountReferrer {
  id           String      @id @default(cuid())
  name         String
  designation  String?
  phone        String?
  diagnostic   Diagnostic? @relation(fields: [diagnosticId], references: [id])
  diagnosticId String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @default(now()) @updatedAt
  deletedAt    DateTime?

  indoorBills  HospitalBill[]
  outdoorBills Bill[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([name, diagnosticId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model HospitalBill {
  id                          String    @id @default(cuid())
  billId                      String
  cabinNo                     String?
  floor                       String?
  diagnosis                   String?
  src                         String    @default("online")
  admissionFee                Int       @default(0)
  admissionInFee              Int                   @default(0)
  admissionInFeeTotal         Int                   @default(0)
  advanceFee                  Int       @default(0)
  advanceInFee                Int       @default(0)
  advanceInFeeTotal           Int       @default(0)
  contactRelation             String?
  contactName                 String?
  contactNumber               String?
  totalAmount                 Float
  paidAmount                  Float
  paidInAmount                Float     @default(0)
  paidInAmountTotal           Float     @default(0)
  commissionAmount            Float     @default(0)
  hospitalDiscount            Float
  discountReference           String?
  referralDiscount            Int       @default(0)
  serviceCharge               Int       @default(0)
  inventoryCharge             Int       @default(0)
  includeInventoryItemsInBill Boolean   @default(false)
  isServiceChargePaid         Boolean   @default(false)
  hospitalDiscountType        String    @default("percentage")
  totalAmountWithDiscount     Float     @default(0)
  totalInAmountWithDiscount   Float     @default(0)
  pcAmount                    Float     @default(0)
  isPaid                      Boolean   @default(false)
  isCommissionPaid            Boolean   @default(false)
  status                      String    @default("Admitted")
  type                        String    @default("new")
  admissionDate               DateTime?
  releasedDate                DateTime?
  createdAt                   DateTime  @default(now())
  updatedAt                   DateTime  @updatedAt()
  deletedAt                   DateTime?
  pharmacyOrder               Json? // JSON to store pharmacy order details
  pharmacyOrderStatus         String? // Status of the pharmacy order (e.g., "pending", "completed")
  isIntegratedWithPharmacy    Boolean   @default(false) // Whether this bill is integrated with the pharmacy system
  lastPharmacySyncDate        DateTime? // Last sync date with the pharmacy system
  lastPharmacySyncStatus      String? // Status of the last sync with the pharmacy system (e.g., "success", "failed")
  pharmacyDueAmount           Float     @default(0) // Amount due for the pharmacy order
  pharmacyOrderId             String? // ID of the pharmacy order if applicable
  pharmacyPaidAmount          Float     @default(0) // Amount paid for the pharmacy order
  pharmacyTotalAmount         Float     @default(0) // Total amount for the pharmacy order
  remarks                     String?
  outdoorBillIds              String[]  @default([])

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  // Relations
  dignostic          Diagnostic?           @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId       String?
  doctor             Doctor?               @relation(fields: [doctorId], references: [id], onDelete: SetNull)
  doctorId           String?
  user               User?                 @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId             String?
  patient            Patient?              @relation(fields: [patientId], references: [id])
  patientId          String?
  PC                 PC?                   @relation(fields: [pCId], references: [id])
  pCId               String?
  nurse              Nurse?                @relation(fields: [nurseId], references: [id])
  nurseId            String?
  surgeon            Surgeon?              @relation(fields: [surgeonId], references: [id], onDelete: SetNull)
  surgeonId          String?
  anethesiologist    Anesthesiologist?     @relation(fields: [anesthesiologistId], references: [id], onDelete: SetNull)
  anesthesiologistId String?
  discountReferrer   DiscountReferrer?     @relation(fields: [discountReferrerId], references: [id], onDelete: SetNull)
  discountReferrerId String?
  referredDoctor     Doctor?               @relation("ReferredDoctorHospitalBill", fields: [referredDoctorId], references: [id], onDelete: SetNull)
  referredDoctorId   String?
  manualBedDayCount           Int?
  manualBedDayOverrideBy      String? // userId
  manualBedDayOverrideAt      DateTime?
  manualBedDayReason          String?
  bedDayCalculationSource     BedDaySource          @default(SYSTEM)
  services           HospitalBillService[]
  operations         SurgeonOperation[]
  bookings           BedBooking[]
  followups          patientFollowups[]
  inventoryItems     BillInventoryItem[]

  @@index([billId])
  // Dashboard query indexes - OPTIMIZED
  @@index([diagnosticId, createdAt, type, deletedAt])
  @@index([diagnosticId, type, deletedAt])
  @@index([diagnosticId, deletedAt])
  @@index([diagnosticId, status, deletedAt])
  @@index([diagnosticId, type, status, deletedAt])
  // Branch and Department indexes - OPTIMIZED
  @@index([diagnosticId, branchId, departmentId])
}

model HospitalBillService {
  id             String        @id @default(cuid())
  name           String
  price          Float
  discount       Float
  unit           Int
  createdAt      DateTime      @default(now())
  dignostic      Diagnostic?   @relation(fields: [diagnosticId], references: [id])
  diagnosticId   String?
  service        Service?      @relation(fields: [serviceId], references: [id], onDelete: SetNull)
  serviceId      String?
  hospitalBill   HospitalBill? @relation(fields: [hospitalBillId], references: [id], onDelete: Cascade)
  hospitalBillId String?
  deletedAt      DateTime?
  updatedAt      DateTime      @default(now()) @updatedAt()

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Signatures {
  id           String      @id @default(cuid())
  name         String
  designation  String?
  image        String?
  dignostic    Diagnostic? @relation(fields: [diagnosticId], references: [id])
  diagnosticId String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @default(now()) @updatedAt
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([id])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model SubTestCategory {
  id           String      @id @default(cuid())
  name         String
  machine      String      @default("")
  order        Int         @default(1)
  tests        Test[]
  dignostic    Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @default(now()) @updatedAt()
  deletedAt    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([name, diagnosticId, deletedAt])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model ServiceChargeTrx {
  id                           String     @id @default(cuid())
  totalAmount                  Float
  paidAmount                   Float
  isApproved                   Boolean    @default(false)
  info                         Json?
  createdAt                    DateTime   @default(now())
  diagnostic                   Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId                 String
  user                         User?      @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId                       String?
  serviceChargeLastPaymentDate DateTime?

  updatedAt      DateTime      @default(now()) @updatedAt()
  deletedAt      DateTime?
  // Relation with DailyExpense
  dailyExpense   DailyExpense? @relation(fields: [dailyExpenseId], references: [id])
  dailyExpenseId String?       @unique

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model OperationCategory {
  id                                    String                                  @id @default(cuid())
  name                                  String
  description                           String?
  price                                 Int
  discount                              Int                                     @default(0)
  discountType                          String                                  @default("amount")
  operations                            Operation[]
  operationCategoryBreakdownFeeTemplate OperationCategoryBreakdownFeeTemplate[]
  diagnostic                            Diagnostic                              @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId                          String
  createdAt                             DateTime                                @default(now())
  updatedAt                             DateTime                                @default(now()) @updatedAt()
  deletedAt                             DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([id])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
  @@index([name])
  @@index([name, diagnosticId, deletedAt])
}

model Operation {
  id                           String                          @id @default(cuid())
  name                         String
  description                  String?
  price                        Int
  discount                     Int                             @default(0)
  discountType                 String                          @default("amount")
  diagnostic                   Diagnostic?                     @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId                 String?
  operationCategory            OperationCategory?              @relation(fields: [operationCategoryId], references: [id], onDelete: Cascade)
  operationCategoryId          String?
  surgeonOperation             SurgeonOperation[]
  surgeonOperationFee          SurgeonOperationFee[]
  anesthesiologistOperationFee AnesthesiologistOperationFee[]
  breakdownFees                OperationBreakdownFee[]
  deductionSettings            InventoryItemDeductionSetting[]
  triggerEvent                 TriggerEvent[]
  createdAt                    DateTime                        @default(now())
  updatedAt                    DateTime                        @default(now()) @updatedAt
  deletedAt                    DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([id])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model SurgeonOperation {
  id                     String                         @id @default(cuid())
  name                   String
  description            String?
  price                  Int
  discount               Int                            @default(0)
  discountType           String                         @default("amount")
  surgeonAmount          Int                            @default(0)
  anesthesiologistAmount Int                            @default(0)
  isSurgeonPaid          Boolean                        @default(false)
  isAnesthesiologistPaid Boolean                        @default(false)
  operationType          String?
  status                 String                         @default("pending")
  priority               String                         @default("routine")
  type                   String                         @default("new")
  referredBy             String?
  referredById           String?
  referralDiscount       Int                            @default(0)
  referralDiscountType   String                         @default("amount")
  operationStartTime     DateTime?
  operationEndTime       DateTime?
  note                   String?
  createdAt              DateTime                       @default(now())
  updatedAt              DateTime                       @default(now()) @updatedAt
  deletedAt              DateTime?
  diagnostic             Diagnostic                     @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId           String
  operation              Operation                      @relation(fields: [operationId], references: [id], onDelete: Cascade)
  operationId            String
  surgeon                Surgeon?                       @relation(fields: [surgeonId], references: [id], onDelete: Cascade)
  surgeonId              String?
  anesthesiologist       Anesthesiologist?              @relation(fields: [anesthesiologistId], references: [id], onDelete: Cascade)
  anesthesiologistId     String?
  patient                Patient?                       @relation(fields: [patientId], references: [id], onDelete: Cascade)
  patientId              String?
  hospitalBill           HospitalBill                   @relation(fields: [hospitalBillId], references: [id], onDelete: Cascade)
  hospitalBillId         String
  pc                     PC?                            @relation(fields: [pCId], references: [id], onDelete: Cascade)
  pCId                   String?
  user                   User?                          @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId                 String?
  surgeonOperationTrx    SurgeonOperationTrx[]
  breakdownFees          SurgeonOperationBreakdownFee[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([id, status, priority])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model OperationCategoryBreakdownFeeTemplate {
  id                  String            @id @default(cuid())
  name                String // e.g., "Bed Charge", "Machine Charge"
  description         String?
  amount              Int
  operationCategory   OperationCategory @relation(fields: [operationCategoryId], references: [id], onDelete: Cascade)
  operationCategoryId String
  diagnostic          Diagnostic        @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId        String
  createdAt           DateTime          @default(now())
  updatedAt           DateTime          @default(now()) @updatedAt
  deletedAt           DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([operationCategoryId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model OperationBreakdownFee {
  id           String     @id @default(cuid())
  name         String // e.g., "Bed Charge", "Machine Charge"
  description  String?
  amount       Int
  operation    Operation  @relation(fields: [operationId], references: [id], onDelete: Cascade)
  operationId  String
  diagnostic   Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @default(now()) @updatedAt
  deletedAt    DateTime?

  // Optional reference to the category template it was based on
  categoryTemplateId String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([operationId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model SurgeonOperationBreakdownFee {
  id                 String           @id @default(cuid())
  name               String // e.g., "Bed Charge", "Machine Charge"
  description        String?
  amount             Int
  discount           Int              @default(0)
  discountType       String           @default("amount")
  surgeonOperation   SurgeonOperation @relation(fields: [surgeonOperationId], references: [id], onDelete: Cascade)
  surgeonOperationId String
  diagnostic         Diagnostic       @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId       String
  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @default(now()) @updatedAt
  deletedAt          DateTime?

  // Optional reference to the operation template it was created from
  operationTemplateId String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([surgeonOperationId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Surgeon {
  id                  String                @id @default(cuid())
  name                String
  designation         String?
  image               String?
  performedOperation  SurgeonOperation[]
  surgeonOperationFee SurgeonOperationFee[]
  hospitalBills       HospitalBill[]
  Diagnostic          Diagnostic?           @relation(fields: [diagnosticId], references: [id])
  diagnosticId        String
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @default(now()) @updatedAt
  deletedAt           DateTime?
  surgeonOperationTrx SurgeonOperationTrx[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([id, diagnosticId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model SurgeonOperationFee {
  id               String      @id @default(cuid())
  surgeon          Surgeon     @relation(fields: [surgeonId], references: [id], onDelete: Cascade)
  surgeonId        String
  operation        Operation   @relation(fields: [operationId], references: [id], onDelete: Cascade)
  operationId      String
  surgeonFeeAmount Int         @default(0)
  createdAt        DateTime    @default(now())
  updatedAt        DateTime    @default(now()) @updatedAt
  deletedAt        DateTime?
  Diagnostic       Diagnostic? @relation(fields: [diagnosticId], references: [id])
  diagnosticId     String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([surgeonId, operationId])
  @@index([id, surgeonId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Anesthesiologist {
  id                           String                         @id @default(cuid())
  name                         String
  designation                  String?
  image                        String?
  createdAt                    DateTime                       @default(now())
  updatedAt                    DateTime                       @default(now()) @updatedAt
  anesthesiologistOperationFee AnesthesiologistOperationFee[]
  operation                    SurgeonOperation[]
  hospitalBills                HospitalBill[]
  Diagnostic                   Diagnostic                     @relation(fields: [diagnosticId], references: [id])
  diagnosticId                 String
  deletedAt                    DateTime?
  surgeonOperationTrx          SurgeonOperationTrx[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([id, diagnosticId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model AnesthesiologistOperationFee {
  id                        String           @id @default(cuid())
  anesthesiologist          Anesthesiologist @relation(fields: [anesthesiologistId], references: [id], onDelete: Cascade)
  anesthesiologistId        String
  operation                 Operation        @relation(fields: [operationId], references: [id], onDelete: Cascade)
  operationId               String
  anesthesiologistFeeAmount Int // store the surgeon's fee for this operation type
  createdAt                 DateTime         @default(now())
  updatedAt                 DateTime         @default(now()) @updatedAt
  deletedAt                 DateTime?
  Diagnostic                Diagnostic?      @relation(fields: [diagnosticId], references: [id])
  diagnosticId              String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([anesthesiologistId, operationId])
  @@index([id, anesthesiologistId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model BedCategory {
  id             String           @id @default(cuid())
  name           String
  description    String?
  Diagnostic     Diagnostic       @relation(fields: [diagnosticId], references: [id])
  diagnosticId   String
  BedSubCategory BedSubCategory[]
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @default(now()) @updatedAt
  deletedAt      DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model BedSubCategory {
  id            String      @id @default(cuid())
  name          String
  price         Int         @default(0)
  description   String?
  BedCategory   BedCategory @relation(fields: [bedCategoryId], references: [id])
  bedCategoryId String
  Diagnostic    Diagnostic  @relation(fields: [diagnosticId], references: [id])
  diagnosticId  String
  beds          Bed[]
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @default(now()) @updatedAt
  deletedAt     DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Bed {
  id                  String         @id @default(cuid())
  bedNumber           String
  roomNo              String
  price               Int            @default(0)
  discount            Int            @default(0)
  discountType        String         @default("amount")
  bedSubCategoryId    String
  BedSubCategory      BedSubCategory @relation(fields: [bedSubCategoryId], references: [id])
  bookings            BedBooking[] // Relation to bookings if a bed can have multiple bookings over time
  Diagnostic          Diagnostic     @relation(fields: [diagnosticId], references: [id])
  diagnosticId        String
  // isAvailableForBooking        Boolean @default(true)
  // bookingStatus    String @default("available")
  isOutOfService      Boolean        @default(false)
  outOfServiceReason  String?
  lastMaintenanceDate DateTime?
  floorNumber         Int?
  wing                String?
  roomType            String?
  note                String?
  bedDescription      String?
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @default(now()) @updatedAt
  deletedAt           DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([roomNo, bedSubCategoryId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model BedBooking {
  id                 String       @id @default(cuid())
  bedId              String
  price              Int          @default(0)
  discount           Int          @default(0)
  discountType       String       @default("amount")
  depositAmount      Int          @default(0)
  bookingSource      String       @default("walk-in") //online,phone,walk-in
  startDate          DateTime     @default(now())
  endDate            DateTime?
  Bed                Bed          @relation(fields: [bedId], references: [id])
  Patient            Patient?     @relation(fields: [patientId], references: [id])
  patientId          String?
  HospitalBill       HospitalBill @relation(fields: [HospitalBillId], references: [id])
  HospitalBillId     String
  Diagnostic         Diagnostic   @relation(fields: [diagnosticId], references: [id])
  diagnosticId       String
  canceledBy         String?
  cancellationReason String?
  totalCost          Int          @default(0)
  isDischarged       Boolean      @default(false)
  bookingStatus      String       @default("active")
  paymentStatus      Boolean      @default(false)
  note               String?
  createdAt          DateTime     @default(now())
  updatedAt          DateTime     @default(now()) @updatedAt
  deletedAt          DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([id, startDate, endDate, paymentStatus, bookingStatus])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model AuditLog {
  id          String    @id @default(cuid())
  action      String // The action performed, e.g., "CREATE", "UPDATE", "DELETE", "CANCEL_BOOKING"
  model       String // The name of the model being affected, e.g., "Bed", "BedBooking"
  modelId     String // The ID of the record being affected
  changes     Json // A JSON object containing the before and after states of the record
  performedBy String // The user or staff member who performed the action
  timestamp   DateTime  @default(now())
  updatedAt   DateTime  @default(now()) @updatedAt // add default value of now 
  note        String?
  deletedAt   DateTime?
}

model IndoorFieldVisibility {
  id                 String     @id @default(cuid())
  // Personal Information Fields
  phone              Boolean    @default(true)
  name               Boolean    @default(true)
  address            Boolean    @default(true)
  thana              Boolean    @default(true)
  district           Boolean    @default(true)
  diseaseName        Boolean    @default(true)
  gender             Boolean    @default(true)
  ageYear            Boolean    @default(true)
  ageMonth           Boolean    @default(true)
  ageDay             Boolean    @default(true)
  // Patient Information Fields
  bed                Boolean    @default(true)
  admissionFee       Boolean    @default(true)
  advance            Boolean    @default(true)
  // Operation Information Fields
  operationId        Boolean    @default(true)
  doctorId           Boolean    @default(true)
  referredDoctorId   Boolean    @default(false)
  nurseId            Boolean    @default(true)
  pcId               Boolean    @default(true)
  surgeonId          Boolean    @default(true)
  anesthesiologistId Boolean    @default(true)
  // Relation Information Fields
  contactRelation    Boolean    @default(true)
  contactName        Boolean    @default(true)
  contactNumber      Boolean    @default(true)
  patientCard        Boolean    @default(true)
  contactCard        Boolean    @default(true)
  wardCard           Boolean    @default(true)
  doctorCard         Boolean    @default(true)
  Diagnostic         Diagnostic @relation(fields: [diagnosticId], references: [id])
  diagnosticId       String     @unique
  deletedAt          DateTime?
  createdAt          DateTime   @default(now())
  updatedAt          DateTime   @default(now()) @updatedAt
  // Additional settings fields can be added as needed
}

// This is the transaction table for all the payments related to surgeon and diagnostic
model SurgeonOperationTrx {
  id                 String            @id @default(cuid())
  totalAmount        Float
  paidAmount         Float
  info               Json?
  diagnostic         Diagnostic        @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId       String
  user               User?             @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId             String?
  updatedAt          DateTime          @default(now()) @updatedAt()
  createdAt          DateTime          @default(now())
  deletedAt          DateTime?
  dailyExpense       DailyExpense?     @relation(fields: [dailyExpenseId], references: [id])
  dailyExpenseId     String?           @unique
  surgeonOperation   SurgeonOperation? @relation(fields: [surgeonOperationId], references: [id])
  surgeonOperationId String?
  surgeon            Surgeon?          @relation(fields: [surgeonId], references: [id], onDelete: Cascade)
  surgeonId          String?
  anesthesiologist   Anesthesiologist? @relation(fields: [anesthesiologistId], references: [id], onDelete: Cascade)
  anesthesiologistId String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  // Dashboard query indexes
  @@index([diagnosticId, createdAt])
  @@index([diagnosticId, createdAt, surgeonId])
  @@index([diagnosticId, createdAt, anesthesiologistId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Version {
  id          String    @id @default(cuid())
  component   String // e.g., "nodejs-server-1", "nextjs-frontend", "desktop-app"
  version     String
  filename    String
  downloadUrl String
  changelog   String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  deletedAt   DateTime?
}

model OTPVerification {
  id           String    @id @default(cuid())
  phone        String // Phone number receiving the OTP
  otp          String // The actual OTP code
  expiresAt    DateTime // When this OTP expires
  verified     Boolean   @default(false) // Whether the OTP has been verified
  verifiedAt   DateTime? // When the OTP was verified
  attemptCount Int       @default(0) // Number of verification attempts
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  // Optional: purpose of the OTP (e.g., "appointment_booking", "login")
  purpose     OTP_CREATION_PURPOSE @default(APPOINTMENT_BOOKING)
  contextData Json?

  patient   Patient? @relation(fields: [patientId], references: [id], onDelete: Cascade)
  patientId String?

  @@index([phone])
  @@index([otp])
}

model ServiceVersion {
  id           String      @id @default(cuid())
  service      String // e.g., "nodejs-server-1", "nextjs-frontend", "desktop-app"
  version      String
  updatedAt    DateTime    @updatedAt
  deletedAt    DateTime?
  diagnostic   Diagnostic? @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([service, diagnosticId])
  @@index([service, diagnosticId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model patientFollowups {
  id                 String                   @id @default(cuid())
  status             FollowUpStatus           @default(PENDING)
  followUpMsg        String?
  followUpDate       DateTime?
  isPregnancyPatient Boolean                  @default(false)
  deliveryDate       DateTime?
  diagnostic         Diagnostic               @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId       String
  patient            Patient                  @relation(fields: [patientId], references: [id], onDelete: Cascade)
  patientId          String
  hospitalBill       HospitalBill?            @relation(fields: [hospitalBillId], references: [id], onDelete: Cascade)
  hospitalBillId     String?
  createdAt          DateTime                 @default(now())
  updatedAt          DateTime                 @updatedAt
  deletedAt          DateTime?
  history            PatientFollowupHistory[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model PatientFollowupHistory {
  id                   String           @id @default(cuid())
  followup             patientFollowups @relation(fields: [followupId], references: [id], onDelete: Cascade)
  followupId           String
  previousStatus       FollowUpStatus?
  newStatus            FollowUpStatus
  previousFollowUpDate DateTime?
  newFollowUpDate      DateTime?
  previousFollowUpMsg  String?
  newFollowUpMsg       String?
  diagnostic           Diagnostic?      @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId         String?
  updatedBy            User             @relation(fields: [updatedById], references: [id])
  updatedById          String
  updatedAt            DateTime         @default(now())
  changeDetails        Json?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Message {
  id              String             @id @default(uuid())
  type            String?
  content         String
  phone           String?
  status          MessageStatus      @default(PENDING)
  charCount       Int                @default(0)
  inBengali       Boolean            @default(false) // Whether the message is in Bangla
  sentAt          DateTime?
  error           String?
  requestId       Int? // SMS API request ID
  deliveryStatus  Json? // Store the delivery status response
  lastStatusCheck DateTime? // Last time we checked the delivery status
  appointmentId   String?
  appointment     DoctorAppointment? @relation(fields: [appointmentId], references: [id])
  diagnosticId    String
  diagnostic      Diagnostic         @relation(fields: [diagnosticId], references: [id])
  createdAt       DateTime           @default(now())
  updatedAt       DateTime           @updatedAt
  deletedAt       DateTime?

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model SMSTemplate {
  id             String       @id @default(cuid())
  name           String // Descriptive name of the template
  eventType      SMSEventType
  englishMessage String? // Message template in English
  bengaliMessage String? // Message template in Bangla (optional)
  isActive       Boolean      @default(true)
  senderId       String? // ID of the sender (if applicable)
  sendInBengali  Boolean      @default(false) // Whether to send in Bangla
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  deletedAt      DateTime?
  // Relations
  diagnostic     Diagnostic   @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId   String
  // @@unique([eventType, diagnosticId, deletedAt])

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
  @@index([eventType])
}

model SMSPackage {
  id            String               @id @default(cuid())
  name          String // Name of the package (e.g., "Basic", "Premium", "Enterprise")
  totalSMS      Int // Total number of SMS in the package
  price         Int // Cost of the package
  discount      Int                  @default(0) // Discount amount
  discountType  String?              @default("amount") // Optional: "amount" or "percentage"
  validityDays  Int? // Optional: how many days the package is valid for
  features      Json?
  isActive      Boolean              @default(true)
  createdAt     DateTime             @default(now())
  updatedAt     DateTime             @updatedAt
  deletedAt     DateTime?
  buyedPackages SMSPackagePurchase[] // Relation to track purchases of this package
}

// SMS Package Purchase Model - tracks when a diagnostic center purchases a package
model SMSPackagePurchase {
  id                   String           @id @default(cuid())
  purchaseDate         DateTime         @default(now())
  name                 String // Name of the package purchased
  expiryDate           DateTime?
  features             Json?
  totalSMS             Int // Total SMS in this purchase
  remainingSMS         Int // Remaining SMS balance
  price                Float // Cost of the purchase
  status               SMSPackageStatus @default(PENDING)
  transactionId        String? // Optional: payment transaction reference
  transactionReference String? // Optional: additional reference info. //phone or trxId
  notes                String?
  approvedAt           DateTime? // When the purchase was approved
  // expiresAt     DateTime? // When the package expires
  createdAt            DateTime         @default(now())
  updatedAt            DateTime         @updatedAt
  deletedAt            DateTime?

  diagnostic   Diagnostic @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId String

  package   SMSPackage @relation(fields: [packageId], references: [id], onDelete: Cascade)
  packageId String

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([status])
  @@index([purchaseDate])
  @@index([expiryDate])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model Template {
  id                  String               @id @default(cuid())
  transformFunction   String? // Name of the transformation function
  name                String // Name of the template
  html                String // HTML content of the template
  previewImage        String? // URL or base64 string of the preview image
  expressionMap       Json?
  pageHeight          Int?
  pageWidth           Int?
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  deletedAt           DateTime?
  diagnosticTemplates DiagnosticTemplate[]
  categoryId          String
  category            TemplateCategory     @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@index([categoryId])
}

model TemplateCategory {
  id                  String               @id @default(cuid())
  name                TemplateCategoryType
  dummyData           Json? // JSON object containing dummy data for this category
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  deletedAt           DateTime?
  diagnostic          Diagnostic?          @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId        String?
  templates           Template[]
  diagnosticTemplates DiagnosticTemplate[]

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@index([diagnosticId, name])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

model DiagnosticTemplate {
  id                String           @id @default(cuid())
  diagnostic        Diagnostic       @relation(fields: [diagnosticId], references: [id], onDelete: Cascade)
  diagnosticId      String
  template          Template?        @relation(fields: [templateId], references: [id], onDelete: Cascade)
  templateId        String?
  transformFunction String? // Name of the transformation function
  expressionMap     Json?
  name              String // Name of the template
  html              String // HTML content of the template
  previewImage      String? // URL or base64 string of the preview image
  pageHeight        Int?
  pageWidth         Int?
  isDefault         Boolean          @default(false)
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  deletedAt         DateTime?
  categoryId        String
  category          TemplateCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  // Branch and Department Relations (NEW)
  branch       Branch?     @relation(fields: [branchId], references: [id], onDelete: SetNull)
  branchId     String?
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  @@unique([diagnosticId, templateId])
  @@index([diagnosticId])
  @@index([diagnosticId, branchId, departmentId])
}

enum TemplateCategoryType {
  OUTDOOR_SUMMARY
  INDOOR_SUMMARY
  LAB_REPORT
  RECEPTIONIST_SUMMARY
  MONTHLY_SUMMARY
  OUTDOOR_TOTAL_BILL
  OUTDOOR_BILL
  INDOOR_BILL_SUMMARY
  INDOOR_ADMISSION
  INDOOR_BILL_DETAILS
  TEST_SUMMARY
  OPD_SUMMARY
  APPOINTMENT_SUMMARY
  APPOINTMENT_TICKET
  INVENTORY_TRANSACTION_REPORT
  TEST_CATEGORY_STATEMENT
  TEST_WISE_STATEMENT
  BILL_BY_PC_STATEMENT
  BILL_BY_DOCTOR_STATEMENT
  PC_WISE_STATEMENT
  DOCTOR_WISE_STATEMENT
  PC_COMMISSION_CATEGORY_WISE_STATEMENT
  DOCTOR_COMMISSION_CATEGORY_WISE_STATEMENT
  PC_COMMISSION_TEST_WISE_STATEMENT
  DOCTOR_COMMISSION_TEST_WISE_STATEMENT
  DAILY_EXTRA_INCOME_STATEMENT
  DAILY_EXPENSE_STATEMENT
}

enum MessageStatus {
  REQUEST_SUBMITTED
  PENDING
  ON_HOLD
  SENT
  FAILED
}

enum ReportStatus {
  PENDING // Sample received but not yet processed
  IN_PROGRESS // Currently being analyzed
  FINALIZED // Testing finished and verified
  REJECTED // Sample couldn't be processed
  CANCELLED // Order cancelled
  ON_HOLD // Testing temporarily suspended
  AMENDED // Results updated after initial release
  CRITICAL // Results requiring immediate attention
  REFERRED // Sent to reference laboratory
  VERIFIED // Verified by authorized personnel
  RELEASED // Released to requesting provider/patient
  ARCHIVED // Moved to long-term storage
  DELETED // Marked as deleted (soft delete)
}

enum OperationType {
  CREATE
  UPDATE
  DELETE
}

enum FollowUpStatus {
  PENDING
  CONFIRMED
  COMPLETED
}

enum OTP_CREATION_PURPOSE {
  AUTHENTICATION
  PASSWORD_RESET
  APPOINTMENT_BOOKING
  GET_PATIENT_CREDENTIALS
}

// Enums
enum AttendanceStatus {
  PRESENT
  ABSENT
  LATE
  HALF_DAY
  ON_LEAVE
  HOLIDAY
  WEEKEND
  EARLY
  WORK_FROM_HOME
  LATE_IN_EARLY_OUT
  LATE_IN
  EARLY_OUT
  WORK_FROM_HOME_LATE
  WORK_FROM_HOME_EARLY
  WORK_FROM_HOME_LATE_IN
  WORK_FROM_HOME_EARLY_OUT
  WORK_FROM_HOME_HALF_DAY
  WORK_FROM_HOME_ABSENT
  WORK_FROM_HOME_ON_LEAVE
}

enum CheckInStatus {
  CHECKED_IN
  RECHECK_IN
  NOT_CHECKED_IN
  LATE
  EARLY
}

enum CheckOutStatus {
  CHECKED_OUT
  NOT_CHECKED_OUT
  EARLY
  LATE
  SECONDARY_CHECK_OUT
}

enum VerificationMethod {
  FINGERPRINT
  MANUAL
  FACE_RECOGNITION
  CARD
  MOBILE_APP
}

enum Leavetype {
  CASUAL
  SICK
  ANNUAL
  MATERNITY
  PATERNITY
  UNPAID
  BONUS
  COMPENSATORY
  OTHER
}

enum LeaveStatus {
  PENDING
  APPROVED
  REJECTED
  CANCELLED
}

enum PayrollStatus {
  DRAFT
  PROCESSING
  APPROVED
  COMPLETED
  CANCELLED
}

enum PaymentStatus {
  PENDING
  PAID
  CANCELLED
  PARTIAL
}

enum ApprovalStatus {
  PENDING
  APPROVED
  REJECTED
  CANCELLED
}

enum RepaymentPlan {
  SINGLE_DEDUCTION
  INSTALLMENTS
  PERCENTAGE_OF_SALARY
}

enum SMSEventType {
  BILL_CREATED
  LAB_REPORT_COMPLETED
  LAB_REPORT_SINGLE_COMPLETED
  PATIENT_ADMITTED
  BILL_PAYMENT_RECEIVED
  INDOOR_BILL_PAYMENT_RECEIVED
  APPOINTMENT_REMINDER
  EMPLOYEE_ABSENT
  SALARY_DISBURSEMENT
  SALARY_ADVANCE
  SALARY_REVISION
  PC_PAYMENT
  // CUSTOM
}

enum SMSPackageStatus {
  ACTIVE
  EXPIRED
  DEPLETED
  CANCELLED
  PENDING // For purchases that are not yet activated
}

enum COMMISSION_BASE {
  TEST_WISE
  CATEGORY_WISE
  SUBCATEGORY_WISE
  PERSONAL
}

enum TargetType {
  DAILY
  WEEKLY
  MONTHLY
  YEARLY
}

enum BedDaySource {
  SYSTEM
  MANUAL
}
