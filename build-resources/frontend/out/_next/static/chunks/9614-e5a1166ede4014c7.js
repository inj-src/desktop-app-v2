(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9614],{19614:function(e,t,o){"use strict";o.d(t,{Z:function(){return W}});var i=o(68328),r=o(85626),l=o(7203),n=function(e){let{checkedColor:t,uncheckedColor:o,size:r,children:l,onToggle:n,checked:d,id:s}=e;return(0,i.jsx)("div",{style:{display:"inline-flex",alignItems:"center",padding:"md"===r?"8px 12px":"4px 8px",borderRadius:"16px",backgroundColor:d?t:o,color:d?"#FF800E":"#4EBA45",cursor:"pointer"},onClick:()=>null==n?void 0:n(s),children:l})},d=o(72940),s=o(6780),a=o(67732);let u=async e=>{try{let t=await s.default.post("".concat("http://sasthotech.local:5000/api/v1","/bed/booking"),e,{...d.FD,...d.Hn});return{success:!0,data:t.data.data}}catch(e){if(e instanceof a.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}};var c=o(99878),p=o(90685),h=o(22614),b=o(68242),g=o(31204),x=o(3741),y=o(48604),v=o(22041),m=o(41224),j=o(76029),f=o(29533),C=o(53729),k=o(91590),w=o(55911),S=o(29259),B=o(81209),I=o(22975),T=o(77052),D=o(47720),E=o(46557),O=o(25299),P=o(37947),N=o(39558),A=o(1790),F=o(98215),G=o(14285),R=o(45437),q=o(12697),H=o(83458),Z=o(39127),V=o(13520),Q=o(4505),_=o(90660),z=o.n(_),M=o(80827),L=o.n(M);function U(e){let{subCat:t,refetch:o,setFieldValue:l,onClose:d,bedPreviousValue:s}=e,[a,c]=(0,Q.useState)(null),[y,T]=(0,Q.useState)(!1),[_,{open:M,close:L}]=(0,E.q)(!1),[U]=(0,p.lq)(),W=e=>{c(a===e?null:e)},Y=(0,D.c)({initialValues:{HospitalBillId:"",price:0,discount:0,discountType:"amount",bedId:""},validate:{HospitalBillId:e=>e.length<9?"Hospital Bill is Required":null}}),[J,X]=(0,Q.useState)(void 0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.Stack,{my:10,style:{border:".5px dashed gray",padding:"10px 5px",borderRadius:10},children:(0,i.jsxs)("div",{children:[(0,i.jsxs)(h.Group,{my:10,justify:"space-between",children:[(0,i.jsx)(v.Text,{}),(0,i.jsx)(b.Title,{ta:"center",order:3,children:null==t?void 0:t.name}),y?(0,i.jsx)(P.Z,{style:{cursor:"pointer"},onClick:()=>T(!1)}):(0,i.jsx)(v.Text,{style:{cursor:"pointer"},onClick:()=>T(!0),children:"Edit"})]}),(0,i.jsxs)(h.Group,{children:[null==t?void 0:t.beds.map((e,t)=>{var r,p,b,m,I,T,D,E,P,Q,_,L,J,K,$,ee,et,eo,ei;let er="B"+e.bedNumber+"-"+e.roomNo;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n,{id:e.id,uncheckedColor:e.isOutOfService?"gray":"#D6FFC3",checkedColor:"#FFE4C3",size:"md",onToggle:e.isOutOfService||0!==e.bookings.length?void 0:W,checked:e.bookings.length>0,children:(0,i.jsx)(j.u,{label:e.bookings.length>0?"Already Booked":e.isOutOfService?"Out Of Service":a===e.id?"Selected":"Available -- Click to Book",children:(0,i.jsxs)(f.J,{width:350,disabled:y,position:"bottom",withArrow:!0,shadow:"md",onOpen:()=>{var t;Y.setValues({price:null!==(t=e.price)&&void 0!==t?t:0,bedId:e.id,discount:null==e?void 0:e.discount,discountType:null==e?void 0:e.discountType,HospitalBillId:""})},onClose:()=>c(null),children:[(0,i.jsx)(f.J.Target,{children:(0,i.jsxs)(h.Group,{children:[y,e.isOutOfService&&0===e.bookings.length&&(0,i.jsx)(N.Z,{style:{width:(0,C.h)(20),height:(0,C.h)(20),color:"black"}}),a&&a===e.id&&(0,i.jsx)(A.Z,{style:{width:(0,C.h)(22),height:(0,C.h)(22),color:"1c7ed6"}}),(0,i.jsx)(F.Z,{})," ",(0,i.jsxs)("span",{style:{color:"black",fontWeight:600},children:[" ",er]}),(0,i.jsx)(k.A,{size:"md",color:e.bookings.length>0?"#FF800E":"#4EBA45",icon:(0,i.jsx)(G.Z,{color:"black",style:{width:(0,C.h)(20),height:(0,C.h)(20)}}),checked:!0,children:(0,i.jsxs)(v.Text,{c:"black",children:[e.price," TK"]})}),y&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.Text,{onClick:()=>{M(),X(e)},children:(0,i.jsx)(R.Z,{})}),(0,i.jsx)(x.A,{onClick:async()=>{try{O.qk.openConfirmModal({title:"Delete",centered:!0,children:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("span",{className:"d-block h4",children:"Are you sure?"})}),labels:{confirm:"Delete",cancel:"Cancel"},onConfirm:async()=>{let t=await U(e.id);if("error"in t)throw Error("Unexpected Error Occurred");o(),z().fire("Success","Bed is deleted","success")},onCancel:()=>{}})}catch(e){z().fire("Failed",e instanceof Error?e.message:"Unexpected Error","success")}finally{}},bg:"red",children:(0,i.jsx)(q.Z,{})})]})]})}),(0,i.jsx)(f.J.Dropdown,{children:(null==e?void 0:null===(r=e.bookings)||void 0===r?void 0:r.length)>0?(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsxs)(v.Text,{fw:600,tt:"capitalize",children:[null==e?void 0:null===(b=e.bookings[0])||void 0===b?void 0:null===(p=b.HospitalBill)||void 0===p?void 0:p.patient.name,"("," ",null==e?void 0:null===(T=e.bookings)||void 0===T?void 0:null===(I=T[0])||void 0===I?void 0:null===(m=I.HospitalBill)||void 0===m?void 0:m.patient.patientId,")"]}),(0,i.jsxs)(v.Text,{children:["Disease : ",null==e?void 0:null===(P=e.bookings)||void 0===P?void 0:null===(E=P[0])||void 0===E?void 0:null===(D=E.HospitalBill)||void 0===D?void 0:D.diagnosis," "]}),(0,i.jsxs)(v.Text,{children:["Supervision :",null==e?void 0:null===(J=e.bookings)||void 0===J?void 0:null===(L=J[0])||void 0===L?void 0:null===(_=L.HospitalBill)||void 0===_?void 0:null===(Q=_.doctor)||void 0===Q?void 0:Q.name," "]}),(0,i.jsxs)(h.Group,{children:[(0,i.jsx)(V.default,{href:"/patient/details?id=".concat(null==e?void 0:null===(ee=e.bookings)||void 0===ee?void 0:null===($=ee[0])||void 0===$?void 0:null===(K=$.HospitalBill)||void 0===K?void 0:K.billId),children:"Bill Summary"}),(0,i.jsx)(V.default,{href:"/patient/details?id=".concat(null==e?void 0:null===(ei=e.bookings)||void 0===ei?void 0:null===(eo=ei[0])||void 0===eo?void 0:null===(et=eo.HospitalBill)||void 0===et?void 0:et.billId,"&billing=true"),children:"Patient Billing"})]})]}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("form",{onSubmit:Y.onSubmit(async e=>{try{if(l){let{HospitalBillId:t,...o}=e}else{let i=await u(e);if(i.success)o(),c(null);else{var t;throw Error(null!==(t=null==i?void 0:i.data)&&void 0!==t?t:"Something went wrong")}}}catch(e){z().fire("Error",e instanceof Error?e.message:"Error Occurred","error")}}),children:[!l&&(0,i.jsx)(w.TextInput,{my:10,withAsterisk:!0,label:"Bill ID",min:0,description:"",variant:"default",size:"md",styles:{input:{backgroundColor:"white"}},placeholder:"Enter Bill ID",...Y.getInputProps("HospitalBillId")},Y.key("HospitalBillId")),(0,i.jsx)(S.Y,{my:10,withAsterisk:!0,label:"Price",min:0,description:"",variant:"default",size:"md",styles:{input:{backgroundColor:"white"}},placeholder:"Category Price",...Y.getInputProps("price"),defaultValue:e.price},Y.key("price")),(0,i.jsx)(S.Y,{min:0,styles:{input:{backgroundColor:"white"}},label:"Discount",placeholder:"Enter discount",...Y.getInputProps("discount"),defaultValue:0}),(0,i.jsx)(B.r,{size:"md",my:10,color:"blue",label:"Discount Type",labelPosition:"left",checked:"amount"===Y.values.discountType,offLabel:(0,i.jsx)(H.Z,{}),onLabel:(0,i.jsx)(Z.Z,{}),onChange:e=>{let t=e.currentTarget.checked?"amount":"percentage";Y.setFieldValue("discountType",t)}}),l?(0,i.jsx)(g.Button,{onClick:()=>{let{HospitalBillId:e,...t}=Y.values;l("bed",[...null!=s?s:[],t]),null==d||d()},type:"button",my:10,children:"Select Bed"}):(0,i.jsx)(g.Button,{type:"submit",my:10,children:"Book Now"})]})})})]})})})})}),(0,i.jsx)(g.Button,{component:V.default,href:"/indoor/bed/add-bed?categoryId=".concat(t.bedCategoryId,"&subCategoryId=").concat(t.id),children:"Add New"})]})]})},t.id),(0,i.jsx)(I.u,{size:"lg",opened:_,onClose:L,title:"Update Bed",children:(0,i.jsx)(r.C,{close:L,refetch:o,bedInfo:J,selectedSubCategory:t})})]})}var W=e=>{var t;let{setFieldValue:o,onClose:r,bedPreviousValue:n}=e,[d,s]=(0,Q.useState)([new Date,null]),{data:a,isLoading:u,refetch:p}=(0,c.Ok)({from:d[0]||void 0,to:d[1]||void 0});return((0,Q.useEffect)(()=>{p()},[d,p]),u)?(0,i.jsx)(l.Z,{}):(0,i.jsxs)("div",{className:L().container,children:[(0,i.jsxs)(h.Group,{align:"start",justify:"space-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Title,{mr:"auto",children:"Bed Layout"}),(0,i.jsx)(T.DatePickerInput,{w:"300px",styles:{input:{backgroundColor:"white"}},type:"range",label:"Pick dates range",placeholder:"Pick dates range",value:d,onChange:s})]}),(0,i.jsx)(h.Group,{children:(0,i.jsx)(g.Button,{component:V.default,href:"/indoor/bed/bed-category",children:"Add Category"})})]}),(0,i.jsxs)(h.Group,{my:10,children:[(0,i.jsx)(x.A,{bg:"red"})," Already Booked",(0,i.jsx)(x.A,{bg:"#D6FFC3"})," Available",(0,i.jsx)(x.A,{bg:"gray"})," Out of Service"]})," ",null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.map(e=>{var t;let l=e.BedSubCategory.reduce((e,t)=>e+t.beds.length,0),d=e.BedSubCategory.reduce((e,t)=>e+t.beds.filter(e=>e.bookings.length>0).length,0);return(0,i.jsxs)(y.Z,{my:20,shadow:"lg",radius:"lg",children:[" ",(0,i.jsxs)(h.Group,{mb:20,h:"100%",justify:"space-between",children:[(0,i.jsxs)(h.Group,{children:[(0,i.jsx)(b.Title,{c:"#367EDF",order:2,children:null==e?void 0:e.name}),(0,i.jsxs)(h.Group,{bg:"#D6FFC3",p:10,style:{borderRadius:"25px"},children:[(0,i.jsx)(v.Text,{style:{borderRadius:"50%",backgroundColor:"#4EBA45",width:"18px",height:"18px"}}),(0,i.jsx)(v.Text,{fw:700,children:"".concat(l-d,"/").concat(l," Available")})]})]}),(0,i.jsx)(g.Button,{variant:"outline",component:V.default,href:"/indoor/bed/bed-sub-category",children:"Add Sub-Category"})]}),null==e?void 0:null===(t=e.BedSubCategory)||void 0===t?void 0:t.map(e=>(0,i.jsx)(U,{refetch:p,subCat:e,setFieldValue:o,bedPreviousValue:n,onClose:r},e.id))]},e.id)})]})}},85626:function(e,t,o){"use strict";o.d(t,{C:function(){return C}});var i=o(68328),r=o(90685),l=o(34473),n=o(22041),d=o(29663),s=o(55911),a=o(29259),u=o(87967),c=o(72375),p=o(57956),h=o(76029),b=o(31204),g=o(71996),x=o(47720),y=o(44388),v=o(4505),m=o(14193),j=o(90660),f=o.n(j);function C(e){var t;let{selectedSubCategory:o,bedInfo:j,refetch:C,close:k}=e,w=m.Ry().shape({bedNumber:m.Z_().required("Bed Number is required"),roomNo:m.Z_().required("Room No is required")}),S=(0,x.c)({initialValues:{bedNumber:"",roomNo:"",price:null!==(t=null==o?void 0:o.price)&&void 0!==t?t:0,discount:0,discountType:"amount",bedSubCategoryId:"",isOutOfService:!1,outOfServiceReason:"",lastMaintenanceDate:null,floorNumber:0,wing:"",roomType:"",note:"",bedDescription:""},validate:(0,y.X)(w)}),[B]=(0,r.kt)(),[I]=(0,r.ww)(),T=async e=>{try{let t;if(j?(t=await I({id:j.id,...e}),C&&await C(),k&&k()):t=await B(e),t&&"error"in t)throw Error("Error");f().fire("Success","Bed Added Successfully","success"),console.log("Form Submitted",t)}catch(e){f().fire("Error","Something Went Wrong","error")}};return(0,v.useEffect)(()=>{if(j)S.setValues({bedNumber:j.bedNumber,roomNo:j.roomNo,price:j.price,discount:j.discount,discountType:j.discountType,bedSubCategoryId:j.bedSubCategoryId,isOutOfService:j.isOutOfService,outOfServiceReason:j.outOfServiceReason||"",lastMaintenanceDate:(null==j?void 0:j.lastMaintenanceDate)?null==j?void 0:j.lastMaintenanceDate:null,floorNumber:j.floorNumber||0,wing:(null==j?void 0:j.wing)||"",roomType:j.roomType||"",note:j.note||"",bedDescription:j.bedDescription||""});else if(o){var e;S.setValues({price:null!==(e=o.price)&&void 0!==e?e:0,bedSubCategoryId:null==o?void 0:o.id})}else S.reset()},[o]),(0,i.jsx)("form",{onSubmit:S.onSubmit(T),children:(0,i.jsxs)(l.Container,{py:"xl",px:"md",children:[(0,i.jsxs)(n.Text,{size:"xl",fw:700,mb:5,children:[j?"Update":"Create New"," Bed"]}),(0,i.jsxs)(d.Grid,{gutter:"md",columns:2,children:[(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(s.TextInput,{withAsterisk:!0,styles:{input:{backgroundColor:"white"}},label:"Bed Number",placeholder:"Enter bed number",...S.getInputProps("bedNumber")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(s.TextInput,{withAsterisk:!0,styles:{input:{backgroundColor:"white"}},label:"Room No",placeholder:"Enter room number",...S.getInputProps("roomNo")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(a.Y,{min:0,styles:{input:{backgroundColor:"white"}},label:"Price",placeholder:"Enter price",...S.getInputProps("price")})}),(0,i.jsx)(d.Grid.Col,{span:1}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(a.Y,{min:0,styles:{input:{backgroundColor:"white"}},label:"Discount",placeholder:"Enter discount",...S.getInputProps("discount")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(u.P,{styles:{input:{backgroundColor:"white"}},label:"Discount Type",data:[{value:"amount",label:"Discount"},{value:"percentage",label:"Percentage"}],...S.getInputProps("discountType")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(c.X,{label:"Out of Service",...S.getInputProps("isOutOfService",{type:"checkbox"})})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(p.g,{styles:{input:{backgroundColor:"white"}},label:"Out of Service Reason",placeholder:"Enter out of service reason",...S.getInputProps("outOfServiceReason")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(g.W,{styles:{input:{backgroundColor:"white"}},label:"Last Maintenance Date",placeholder:"Enter last maintenance date",...S.getInputProps("lastMaintenanceDate")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(a.Y,{min:0,styles:{input:{backgroundColor:"white"}},label:"Floor Number",placeholder:"Enter floor number",...S.getInputProps("floorNumber")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(s.TextInput,{styles:{input:{backgroundColor:"white"}},label:"Wing",placeholder:"Enter wing",...S.getInputProps("wing")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(s.TextInput,{styles:{input:{backgroundColor:"white"}},label:"Room Type",placeholder:"Enter room type",...S.getInputProps("roomType")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(p.g,{styles:{input:{backgroundColor:"white"}},label:"Note",placeholder:"Enter note",...S.getInputProps("note")})}),(0,i.jsx)(d.Grid.Col,{span:1,children:(0,i.jsx)(p.g,{styles:{input:{backgroundColor:"white"}},label:"Bed Description",placeholder:"Enter bed description",...S.getInputProps("bedDescription")})})]}),(0,i.jsx)(h.u,{label:o?"Click to Save":"Please Select a SubCategory",children:(0,i.jsx)(b.Button,{disabled:!o,type:"submit",mt:"md",fullWidth:!0,children:"Submit"})})]})})}},99878:function(e,t,o){"use strict";o.d(t,{Ok:function(){return n},Sy:function(){return d},TN:function(){return s},wo:function(){return r}});let i=o(78101).g.injectEndpoints({endpoints:e=>({getBedCategories:e.query({query:e=>{let{from:t,to:o}=e,i=new URLSearchParams;return t&&i.append("from",t.toISOString()),o&&i.append("to",o.toISOString()),{url:"/bed/bedCategory?".concat(i.toString())}},keepUnusedDataFor:86400,transformResponse:e=>(Array.isArray(null==e?void 0:e.data)&&e.data.sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),e)}),createBedCategory:e.mutation({query:e=>({url:"/bed/bedCategory",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:o,queryFulfilled:r}=t,l=Date.now().toString(36),n=o(i.util.updateQueryData("getBedCategories",{from:void 0,to:void 0},t=>{t.data.push({...e,id:l,loading:!0})}));try{let{data:e}=await r;o(i.util.updateQueryData("getBedCategories",{from:void 0,to:void 0},t=>{let o=t.data.findIndex(e=>e.id===l);o>=0&&(t.data[o]=e.data)}))}catch(e){n.undo()}}}),updateBedCategory:e.mutation({query:e=>{let{id:t,...o}=e;return{url:"/bed/bedCategory/".concat(t),method:"PATCH",body:o}},async onQueryStarted(e,t){let{id:o,...r}=e,{dispatch:l,queryFulfilled:n}=t,d=l(i.util.updateQueryData("getBedCategories",{from:void 0,to:void 0},e=>{let t=e.data.findIndex(e=>e.id===o);t>=0&&(e.data[t]={...e.data[t],...r})}));try{let{data:e}=await n;l(i.util.updateQueryData("getBedCategories",{from:void 0,to:void 0},t=>{let i=t.data.findIndex(e=>e.id===o);i>=0&&(t.data[i]=e.data)}))}catch(e){d.undo()}}}),deleteBedCategory:e.mutation({query:e=>({url:"/bed/bedCategory/".concat(e),method:"DELETE"}),async onQueryStarted(e,t){let{dispatch:o,queryFulfilled:r}=t,l=o(i.util.updateQueryData("getBedCategories",{from:void 0,to:void 0},t=>{let o=t.data.find(t=>t.id===e);o&&(o.loading=!0)}));try{await r,o(i.util.updateQueryData("getBedCategories",{from:void 0,to:void 0},t=>{let o=t.data.findIndex(t=>t.id===e);o>=0&&t.data.splice(o,1)}))}catch(e){l.undo()}}}),getSingleBedCategory:e.query({query:e=>({url:"/bed/bedCategory/".concat(e)})})})}),{useCreateBedCategoryMutation:r,useGetSingleBedCategoryQuery:l,useGetBedCategoriesQuery:n,useUpdateBedCategoryMutation:d,useDeleteBedCategoryMutation:s}=i},80827:function(e){e.exports={container:"styles_container__Vl6Hp"}}}]);