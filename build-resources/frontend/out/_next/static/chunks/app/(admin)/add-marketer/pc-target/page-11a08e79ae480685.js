(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{45616:function(e,t,r){Promise.resolve().then(r.bind(r,92673))},92673:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return P}});var a=r(68328),n=r(45913),i=r(25499),s=r(41224),l=r(48604),d=r(22614),o=r(68242),u=r(22041),c=r(31204),h=r(87967),g=r(14587),m=r(54632),p=r(11114),T=r(76029),x=r(3741),f=r(22975),y=r(29259),v=r(77052),j=r(47720),k=r(26546),b=r(9654),D=r(45437),w=r(12697),C=r(4505),S=r(90660),E=r.n(S);let M=[{value:"DAILY",label:"Daily"},{value:"WEEKLY",label:"Weekly"},{value:"MONTHLY",label:"Monthly"}];var I=e=>{var t;let{isAdmin:r=!0}=e,[S,I]=(0,C.useState)(!1),[P,q]=(0,C.useState)(null),[A,B]=(0,C.useState)(null),L=(0,i.C)(e=>e.diagnostic.marketer),{data:V,isLoading:z,refetch:O}=(0,n.dF)({marketerId:A||void 0,page:1,limit:50}),[G,{isLoading:N}]=(0,n._6)(),[_,{isLoading:Y}]=(0,n.ns)(),[H]=(0,n.zq)(),U=(0,j.c)({initialValues:{marketerId:"",targetType:"MONTHLY",targetValue:0,startDate:null,endDate:null},validate:{marketerId:e=>e?null:"Please select a marketer",targetValue:e=>e<=0?"Target value must be a positive number":null,startDate:e=>e?null:"Start date is required",endDate:(e,t)=>e?t.startDate&&e<t.startDate?"End date must be after start date":null:"End date is required"}}),F=e=>{e?(q(e),U.setValues({marketerId:e.marketerId,targetType:e.targetType,targetValue:e.targetValue,startDate:new Date(e.startDate),endDate:new Date(e.endDate)})):(q(null),U.reset()),I(!0)},Z=()=>{I(!1),q(null),U.reset()},R=async e=>{try{let t={marketerId:e.marketerId,targetType:e.targetType,targetValue:e.targetValue,startDate:e.startDate.toISOString(),endDate:e.endDate.toISOString()};P?(await _({id:P.id,data:{targetType:t.targetType,targetValue:t.targetValue,startDate:t.startDate,endDate:t.endDate}}).unwrap(),E().fire({position:"center",icon:"success",title:"Target Updated Successfully",showConfirmButton:!1,timer:1300})):(await G(t).unwrap(),E().fire({position:"center",icon:"success",title:"Target Created Successfully",showConfirmButton:!1,timer:1300})),Z(),O()}catch(e){var t;E().fire("Error",(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Something went wrong","error")}},W=async e=>{if((await E().fire({title:"Are you sure?",text:"This will delete the PC target permanently.",icon:"warning",position:"center",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await H(e).unwrap(),E().fire("Deleted!","The target has been deleted.","success"),O()}catch(e){var t;E().fire("Error",(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to delete","error")}},K=e=>{switch(e){case"DAILY":return"blue";case"WEEKLY":return"orange";case"MONTHLY":return"green";default:return"gray"}},Q=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),J=L.map(e=>({value:e.id,label:e.email+(e.name?" (".concat(e.name,")"):"")}));return(0,a.jsxs)(s.Stack,{gap:"md",children:[(0,a.jsxs)(l.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[(0,a.jsxs)(d.Group,{justify:"space-between",mb:"md",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Title,{order:3,mb:"xs",children:(0,a.jsxs)(d.Group,{gap:"xs",children:[(0,a.jsx)(k.Z,{size:24}),"Marketer Targets"]})}),(0,a.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Set and manage PC visit targets for marketers"})]}),r&&(0,a.jsx)(c.Button,{leftSection:(0,a.jsx)(b.Z,{size:16}),color:"green",onClick:()=>F(),children:"Set New Target"})]}),(0,a.jsx)(d.Group,{mb:"md",children:(0,a.jsx)(h.P,{placeholder:"Filter by Marketer",data:[{value:"",label:"All Marketers"},...J],value:A||"",onChange:e=>B(e||null),clearable:!0,style:{width:300}})}),z?(0,a.jsx)(d.Group,{justify:"center",py:"xl",children:(0,a.jsx)(g.Loader,{})}):(null==V?void 0:null===(t=V.data)||void 0===t?void 0:t.length)?(0,a.jsxs)(m.i,{striped:!0,highlightOnHover:!0,withTableBorder:!0,children:[(0,a.jsx)(m.i.Thead,{children:(0,a.jsxs)(m.i.Tr,{children:[(0,a.jsx)(m.i.Th,{children:"#"}),(0,a.jsx)(m.i.Th,{children:"Marketer"}),(0,a.jsx)(m.i.Th,{children:"Target Type"}),(0,a.jsx)(m.i.Th,{children:"Target Value"}),(0,a.jsx)(m.i.Th,{children:"Start Date"}),(0,a.jsx)(m.i.Th,{children:"End Date"}),r&&(0,a.jsx)(m.i.Th,{children:"Actions"})]})}),(0,a.jsx)(m.i.Tbody,{children:V.data.map((e,t)=>{var n,i;return(0,a.jsxs)(m.i.Tr,{children:[(0,a.jsx)(m.i.Td,{children:t+1}),(0,a.jsxs)(m.i.Td,{children:[(0,a.jsx)(u.Text,{size:"sm",children:(null===(n=e.marketer)||void 0===n?void 0:n.email)||e.marketerId}),(null===(i=e.marketer)||void 0===i?void 0:i.name)&&(0,a.jsx)(u.Text,{size:"xs",c:"dimmed",children:e.marketer.name})]}),(0,a.jsx)(m.i.Td,{children:(0,a.jsx)(p.C,{color:K(e.targetType),variant:"light",children:e.targetType})}),(0,a.jsx)(m.i.Td,{children:(0,a.jsx)(u.Text,{fw:600,children:e.targetValue})}),(0,a.jsx)(m.i.Td,{children:Q(e.startDate)}),(0,a.jsx)(m.i.Td,{children:Q(e.endDate)}),r&&(0,a.jsx)(m.i.Td,{children:(0,a.jsxs)(d.Group,{gap:"xs",children:[(0,a.jsx)(T.u,{label:"Edit Target",children:(0,a.jsx)(x.A,{variant:"light",color:"blue",onClick:()=>F(e),children:(0,a.jsx)(D.Z,{size:18})})}),(0,a.jsx)(T.u,{label:"Delete Target",children:(0,a.jsx)(x.A,{variant:"light",color:"red",onClick:()=>W(e.id),children:(0,a.jsx)(w.Z,{size:18})})})]})})]},e.id)})})]}):(0,a.jsx)(u.Text,{c:"dimmed",ta:"center",py:"xl",children:"No PC targets found. Create one to get started."})]}),(0,a.jsx)(f.u,{opened:S,onClose:Z,title:(0,a.jsxs)(d.Group,{gap:"xs",children:[(0,a.jsx)(k.Z,{size:20}),(0,a.jsx)(u.Text,{fw:600,children:P?"Edit PC Target":"Set New PC Target"})]}),size:"md",children:(0,a.jsx)("form",{onSubmit:U.onSubmit(R),children:(0,a.jsxs)(s.Stack,{gap:"md",children:[(0,a.jsx)(h.P,{label:"Marketer",placeholder:"Select a marketer",data:J,required:!0,disabled:!!P,...U.getInputProps("marketerId")}),(0,a.jsx)(h.P,{label:"Target Type",placeholder:"Select target type",data:M,required:!0,...U.getInputProps("targetType")}),(0,a.jsx)(y.Y,{label:"Target Value",placeholder:"Enter target value (e.g., number of PC visits)",min:1,required:!0,...U.getInputProps("targetValue")}),(0,a.jsx)(v.DatePickerInput,{label:"Start Date",placeholder:"Select start date",required:!0,...U.getInputProps("startDate")}),(0,a.jsx)(v.DatePickerInput,{label:"End Date",placeholder:"Select end date",required:!0,minDate:U.values.startDate||void 0,...U.getInputProps("endDate")}),(0,a.jsxs)(d.Group,{justify:"flex-end",mt:"md",children:[(0,a.jsx)(c.Button,{variant:"default",onClick:Z,children:"Cancel"}),(0,a.jsx)(c.Button,{type:"submit",color:"green",loading:N||Y,children:P?"Update Target":"Create Target"})]})]})})})]})},P=()=>(0,a.jsxs)("div",{style:{padding:"30px",minHeight:"100vh"},children:[(0,a.jsx)(o.Title,{order:2,mb:"md",children:"Set Marketer Target"}),(0,a.jsx)(I,{isAdmin:!0})]})},72940:function(e,t,r){"use strict";r.d(t,{FD:function(){return n},Hn:function(){return a},y4:function(){return i}});let a={headers:{"Content-Type":"application/json"}},n={withCredentials:!0},i={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},45913:function(e,t,r){"use strict";r.d(t,{_6:function(){return i},_q:function(){return d},dF:function(){return a},ns:function(){return s},zq:function(){return l}});let{useGetMarketerTargetsQuery:a,useGetMarketerTargetByIdQuery:n,useCreateMarketerTargetMutation:i,useUpdateMarketerTargetMutation:s,useDeleteMarketerTargetMutation:l,useGetMyMarketerTargetQuery:d}=r(78101).g.injectEndpoints({endpoints:e=>({getMarketerTargets:e.query({query:e=>({url:"/marketerTarget",method:"GET",params:e}),providesTags:["MarketerTarget"]}),getMarketerTargetById:e.query({query:e=>({url:"/marketerTarget/".concat(e),method:"GET"}),providesTags:["MarketerTarget"]}),createMarketerTarget:e.mutation({query:e=>({url:"/marketerTarget",method:"POST",body:e}),invalidatesTags:["MarketerTarget"]}),updateMarketerTarget:e.mutation({query:e=>{let{id:t,data:r}=e;return{url:"/marketerTarget/".concat(t),method:"PATCH",body:r}},invalidatesTags:["MarketerTarget"]}),deleteMarketerTarget:e.mutation({query:e=>({url:"/marketerTarget/".concat(e),method:"DELETE"}),invalidatesTags:["MarketerTarget"]}),getMyMarketerTarget:e.query({query:e=>({url:"/marketerTarget/my",method:"GET",params:e||void 0}),providesTags:["MarketerTarget"]})})})},78101:function(e,t,r){"use strict";r.d(t,{g:function(){return l}});var a=r(49854),n=r(68240),i=r(94183),s=r(28317);let l=(0,n.LC)({baseQuery:(0,i.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,t)=>fetch(e,t).then(async r=>{let n="string"==typeof e?e:e.url;return n.includes("?")||(null==t?void 0:t.body)||"string"!=typeof e&&e.body||await (0,s.t8)(n,await r.clone().json().catch(()=>null),(0,a.x)()),r}).catch(async r=>{if(r instanceof TypeError){let r="string"==typeof e?e:e.url;if(!r.includes("?")&&!(null==t?void 0:t.body)&&!("string"!=typeof e&&e.body)){let e=await (0,s.U2)(r,(0,a.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw r})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},25499:function(e,t,r){"use strict";r.d(t,{C:function(){return i},T:function(){return n}});var a=r(53502);let n=()=>(0,a.I0)(),i=a.v9},49854:function(e,t,r){"use strict";let a;r.d(t,{d:function(){return o},x:function(){return d}});var n=r(72940),i=r(6780),s=r(67732),l=r(28317);function d(){return a||(a=(0,l.MT)("cached-responses-store","cached-responses")),a}async function o(e,t){try{let r=await i.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...n.FD});return await (0,l.t8)(e,r.data,d()),r.data}catch(t){if(t instanceof s.d7&&[s.d7.ERR_NETWORK,s.d7.ETIMEDOUT].includes(t.code)){let t=await (0,l.U2)(e,d());if(t)return t}throw t instanceof s.d7&&t.response&&401===t.response.status||console.error(t),t}}}},function(e){e.O(0,[1601,2975,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,1166,7967,6029,6306,7186,9669,9645,206,9175,7402,1744],function(){return e(e.s=45616)}),_N_E=e.O()}]);