(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3097],{48447:function(e,t,n){Promise.resolve().then(n.bind(n,82042))},51930:function(e,t,n){"use strict";n.d(t,{H:function(){return i}});let i={OUTDOOR_SUMMARY:"Outdoor Summary",INDOOR_SUMMARY:"Indoor Summary",LAB_REPORT:"Lab Report",RECEPTIONIST_SUMMARY:"Receptionist Summary",MONTHLY_SUMMARY:"Monthly Summary",OUTDOOR_TOTAL_BILL:"Outdoor Total Bill",OUTDOOR_BILL:"Outdoor Bill",INDOOR_BILL_SUMMARY:"Indoor Bill Summary",INDOOR_ADMISSION:"Indoor Admission",INDOOR_BILL_DETAILS:"Indoor Bill Details",TEST_SUMMARY:"Test Summary",OPD_SUMMARY:"OPD Summary",APPOINTMENT_SUMMARY:"Appointment Summary",APPOINTMENT_TICKET:"Appointment Ticket",INVENTORY_TRANSACTION_REPORT:"Inventory Transaction Report",TEST_CATEGORY_STATEMENT:"Test Category Statement",TEST_WISE_STATEMENT:"Test Wise Statement",BILL_BY_PC_STATEMENT:"Bill by PC Statement",BILL_BY_DOCTOR_STATEMENT:"Bill by Doctor Statement",PC_WISE_STATEMENT:"PC Wise Statement",DOCTOR_WISE_STATEMENT:"Doctor Wise Statement",PC_COMMISSION_CATEGORY_WISE_STATEMENT:"PC Commission Category Wise Statement",DOCTOR_COMMISSION_CATEGORY_WISE_STATEMENT:"Doctor Commission Category Wise Statement",PC_COMMISSION_TEST_WISE_STATEMENT:"PC Commission Test Wise Statement",DOCTOR_COMMISSION_TEST_WISE_STATEMENT:"Doctor Commission Test Wise Statement",DAILY_EXTRA_INCOME_STATEMENT:"Daily Extra Income Statement",DAILY_EXPENSE_STATEMENT:"Daily Expense Statement"}},54133:function(e,t,n){"use strict";function i(e){return(function(e){let t=new DOMParser;return e.replace(/{{2,}([\s\S]*?)}{2,}/gm,e=>t.parseFromString(e,"text/html").body.textContent||"")})(e).replace(/[“”]/g,'"')}function r(e,t){return t?e?"object"==typeof e&&"object"==typeof t?{customFields:t,...e}:{}:t||{}:e||{}}n.d(t,{M7:function(){return o},SX:function(){return s},ar:function(){return l},b3:function(){return r},jY:function(){return i},l1:function(){return c},o4:function(){return d}});let o=[{key:"A4",width:210,height:297},{key:"A5",width:148,height:210}],a=e=>{if(null==e)return null;if("number"==typeof e)return e;let t=e.trim();if(!t)return null;let n=parseFloat(t.replace("mm",""));return Number.isNaN(n)?null:n};function s(e,t){var n;let i=a(e),r=a(t);return i&&r&&null!==(n=o.find(e=>e.width===i&&e.height===r))&&void 0!==n?n:null}function l(e){let t=o.find(t=>t.key===e);return t?{pageWidth:t.width,pageHeight:t.height}:{pageWidth:210,pageHeight:297}}function c(e){return"".concat(e.key," (").concat(e.width," x ").concat(e.height,"mm)")}function d(e){let t=[],n=null,i=null,r=!1,o=[],a=[],s=e=>e.map((e,t)=>"string"==typeof e&&e.startsWith("[")?".".concat(e):0===t?e:".".concat(e)).join(""),l=(e,t)=>{t&&(e.setAttribute("data-path",t),e.style.cursor="pointer")},c=e=>{if(e.nodeType===Node.ELEMENT_NODE){var d,u;let m=null!==(u=null===(d=e.textContent)||void 0===d?void 0:d.trim())&&void 0!==u?u:"";if(e.classList.contains("hljs-punctuation")){if("{"===m){if(null!==n)t.push(n),i&&(l(i,s(t)),i=null),n=null;else if(r){let e=o[o.length-1];t.push("[".concat(e,"]")),o[o.length-1]++}a.push("object")}else if("}"===m)"object"===a[a.length-1]&&(a.pop(),t.length>0&&t.pop());else if("["===m){if(null!==n)t.push(n),i&&(l(i,s(t)),i=null),n=null;else if(r){let e=o[o.length-1];t.push("[".concat(e,"]")),o[o.length-1]++}a.push("array"),o.push(0),r=!0}else"]"===m&&"array"===a[a.length-1]&&(a.pop(),o.pop(),r=o.length>0,t.length>0&&t.pop())}else if(e.classList.contains("hljs-attr"))n=m.replace(/^"|"$/g,""),i=e;else if(e.classList.contains("hljs-string")||e.classList.contains("hljs-number")||e.classList.contains("hljs-literal")){let a=[...t];if(null!==n)a.push(n),n=null;else if(r){let e=o[o.length-1];a.push("[".concat(e,"]")),o[o.length-1]++}let c=s(a);l(e,c),i&&(l(i,c),i=null)}for(let t of Array.from(e.childNodes))c(t)}};c(e)}},82042:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var i=n(68328),r=n(34473),o=n(32451),a=n(68242),s=n(22041),l=n(41224),c=n(70103),d=n(89043),u=n(22614),m=n(25621),p=n(16391);function h(e){let{templateCount:t=3}=e;return(0,i.jsxs)(d.X,{shadow:"xs",radius:"md",p:"md",withBorder:!0,style:{minHeight:"350px"},children:[(0,i.jsxs)(u.Group,{gap:"sm",children:[(0,i.jsx)(m.O,{width:18,height:18,radius:"sm"}),(0,i.jsx)(m.O,{width:22,height:22,radius:"sm"}),(0,i.jsx)(m.O,{width:150,height:24,radius:"sm"})]}),(0,i.jsxs)(p.k,{wrap:"wrap",gap:"lg",p:"sm",mt:"md",children:[Array.from({length:t}).map((e,t)=>(0,i.jsx)(m.O,{width:180,height:255,radius:4},t)),(0,i.jsx)(m.O,{width:180,height:255,radius:4})]})]})}var f=n(3741),T=n(39467),g=n(46557),y=n(49238),x=n(25091),S=n(22975),j=n(55911),E=n(31204),v=n(47720),b=n(9654),A=n(86481),C=n(44314),O=n(51930),_=n(31151),w=n(12450),I=n(4505),M=n(54133);function R(e){let{category:t}=e,n=(0,w.useRouter)(),[r,{open:a,close:l}]=(0,g.q)(),[m,h]=(0,I.useState)(void 0),[f,{isLoading:T}]=(0,c.ZM)(),y=(0,v.c)({initialValues:{name:""},validate:{name:e=>e.trim()?e.trim().length<2?"Name must be at least 2 characters":null:"Template name is required"}});async function x(e){try{var n;let{pageWidth:i,pageHeight:r}=(0,M.ar)("A4"),o=await f({name:e,html:'<style>\n  * {\n    box-sizing: border-box;\n  }\n  section {\n    box-sizing: border-box;\n    display: flex;\n    flex-flow: column nowrap;\n    position: relative;\n    font-family: Arial, sans-serif;\n    padding: 14pt;\n  }\n  section > article {\n    margin-bottom: auto;\n    z-index: 1;\n  }\n  section > footer {\n    z-index: 1;\n  }\n  h1 {\n    color: #333;\n    border-bottom: 2pt solid #333;\n    padding-bottom: 8pt;\n    margin: 0 0 12pt 0;\n  }\n</style>\n\n<section style="width: 210mm; height: 297mm;">\n  <article>\n    <p>Start editing your template here...</p>\n  </article>\n  \n  <footer>\n    <p style="text-align: center; color: #666; font-size: 9pt;">Page 1</p>\n  </footer>\n</section>',category:t,pageWidth:i,pageHeight:r}).unwrap(),a=null===(n=o.data)||void 0===n?void 0:n.id;a?h(a):_.toast.error("Failed to create template: No ID returned")}catch(e){_.toast.error("Failed to create template"),console.error("Create template error:",e)}}function R(){y.reset(),h(void 0),console.log("closed"),l()}return(0,i.jsxs)(d.X,{shadow:"none",radius:"md",withBorder:!0,onClick:a,role:"button",style:{width:"180px",aspectRatio:"210 / 297",cursor:"pointer",borderStyle:"dashed",borderWidth:2,borderColor:"var(--mantine-color-gray-4)",background:"transparent"},styles:{root:{"&:hover":{borderColor:"var(--mantine-color-blue-5)",background:"var(--mantine-color-blue-0)"}}},children:[(0,i.jsxs)(p.k,{direction:"column",align:"center",justify:"center",gap:"sm",style:{width:"100%",height:"100%"},children:[(0,i.jsx)(o.Box,{style:{width:48,height:48,borderRadius:"50%",background:"var(--mantine-color-gray-1)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(b.Z,{size:24,color:"var(--mantine-color-gray-6)"})}),(0,i.jsx)(s.Text,{size:"sm",c:"dimmed",fw:500,children:"Add Template"})]}),(0,i.jsx)(S.u,{opened:r,onClose:R,title:"Add Template to ".concat(O.H[t]),centered:!0,size:"sm",styles:{title:{fontWeight:600,fontSize:"1.1rem"}},children:(0,i.jsxs)("form",{onSubmit:y.onSubmit(function(e){x(e.name.trim())}),children:[(0,i.jsx)(j.TextInput,{readOnly:!!m,label:"Template Name",placeholder:"Enter template name...",leftSection:(0,i.jsx)(A.Z,{size:16}),...y.getInputProps("name"),"data-autofocus":!0}),(0,i.jsxs)(u.Group,{justify:"flex-end",mt:"lg",children:[(0,i.jsx)(E.Button,{type:"button",variant:"subtle",color:"gray",onClick:R,children:"Cancel"}),m&&(0,i.jsx)(E.Button,{color:"violet",onClick:function(){n.push("/templates/edit?template-id=".concat(m))},rightSection:(0,i.jsx)(C.Z,{size:16}),children:"Edit"}),!m&&(0,i.jsx)(E.Button,{type:"submit",loading:T,children:"Add Template"})]})]})})]})}var N=n(75865),D=n(76029),P=n(77255),k=n(86994),B=n(45437),L=n(12697),z=n(25299),W=n(84228);function q(e){let{template:t}=e,n=(0,w.useRouter)();function r(){n.push("/templates/edit?&template-id=".concat(t.id))}let[a]=(0,c.rg)(),[l]=(0,c.JT)(),{hovered:u,ref:m}=(0,W.X)();return(0,i.jsxs)(d.X,{ref:m,shadow:"sm",radius:"none",withBorder:!0,onClick:r,style:{width:"180px",aspectRatio:"210 / 297",position:"relative",cursor:"pointer",borderRadius:"4px",overflow:"hidden",border:t.isDefault?"2px solid var(--mantine-color-blue-5)":void 0},children:[(0,i.jsx)(o.Box,{style:{position:"absolute",top:8,right:8,zIndex:10},children:(0,i.jsxs)(N.v,{shadow:"md",width:140,position:"bottom-end",children:[(0,i.jsx)(N.v.Target,{children:(0,i.jsx)(f.A,{variant:"white",color:"dark",size:"sm",style:{boxShadow:"var(--mantine-shadow-xs)"},onClick:e=>e.stopPropagation(),children:(0,i.jsx)(P.Z,{size:16})})}),(0,i.jsxs)(N.v.Dropdown,{children:[(0,i.jsx)(N.v.Item,{leftSection:(0,i.jsx)(k.Z,{size:14,fill:t.isDefault?"orange":"transparent",color:t.isDefault?"orange":void 0}),disabled:t.isDefault,onClick:e=>{t.isDefault||(e.stopPropagation(),l(t.id))},children:"Default"}),(0,i.jsx)(N.v.Item,{leftSection:(0,i.jsx)(B.Z,{size:14}),onClick:e=>{e.stopPropagation(),r()},children:"Edit"}),(0,i.jsx)(N.v.Item,{leftSection:(0,i.jsx)(L.Z,{size:14}),color:"red",onClick:e=>{e.stopPropagation(),z.qk.openConfirmModal({title:"Delete Template",centered:!0,children:(0,i.jsxs)(s.Text,{size:"sm",children:["Are you sure you want to delete ",(0,i.jsx)("strong",{children:t.name}),"? This action cannot be undone."]}),labels:{confirm:"Delete",cancel:"Cancel"},confirmProps:{color:"red"},onConfirm:()=>{a(t.id)}})},children:"Delete"})]})]})}),t.previewImage&&(0,i.jsx)("img",{src:t.previewImage,alt:t.name,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"center top"}}),(0,i.jsx)(D.u,{label:t.name,position:"bottom",children:(0,i.jsx)(o.Box,{style:{position:"absolute",opacity:u?1:0,transition:"opacity 0.2s ease-in-out",bottom:0,left:0,right:0,padding:"12px",background:"linear-gradient(transparent, rgba(255, 255, 255, 1))"},children:(0,i.jsx)(s.Text,{size:"sm",fw:500,ta:"center",lineClamp:1,children:t.name})})})]})}function Y(e){let{category:t}=e,[n,{toggle:r}]=(0,g.q)(!0);return(0,i.jsxs)(d.X,{shadow:"xs",radius:"md",p:"md",withBorder:!0,children:[(0,i.jsx)(u.Group,{gap:"sm",justify:"space-between",children:(0,i.jsxs)(u.Group,{gap:"sm",onClick:r,style:{cursor:"pointer"},children:[(0,i.jsx)(f.A,{variant:"subtle",color:"gray",size:"sm",children:n?(0,i.jsx)(y.Z,{size:18}):(0,i.jsx)(x.Z,{size:18})}),(0,i.jsx)(a.Title,{order:4,style:{margin:0},children:O.H[t.name]})]})}),(0,i.jsx)(T.U,{in:n,children:(0,i.jsxs)(p.k,{wrap:"wrap",gap:"lg",p:"sm",mt:"md",children:[t.diagnosticTemplates.map(e=>(0,i.jsx)(q,{template:e,category:t.name},e.id)),(0,i.jsx)(R,{category:t.name})]})})]})}function U(){var e;let{data:t,isLoading:n}=(0,c.JF)(),d=null!==(e=null==t?void 0:t.data)&&void 0!==e?e:[];return(0,i.jsxs)(r.Container,{py:"xl",mt:16,px:"md",size:"lg",children:[(0,i.jsxs)(o.Box,{mb:"xl",children:[(0,i.jsx)(a.Title,{order:2,children:"Templates"}),(0,i.jsx)(s.Text,{c:"dimmed",children:"Easily Manage print templates"})]}),n&&(0,i.jsx)(l.Stack,{gap:"xl",children:Array.from({length:5}).map((e,t)=>(0,i.jsx)(h,{templateCount:2},t))}),!n&&(0,i.jsx)(l.Stack,{gap:"xl",children:d.map(e=>(0,i.jsx)(Y,{category:e},e.id))})]})}},72940:function(e,t,n){"use strict";n.d(t,{FD:function(){return r},Hn:function(){return i},y4:function(){return o}});let i={headers:{"Content-Type":"application/json"}},r={withCredentials:!0},o={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},70103:function(e,t,n){"use strict";n.d(t,{$Q:function(){return u},A9:function(){return a},JF:function(){return r},JT:function(){return d},ZM:function(){return i},pi:function(){return m},rg:function(){return c},wD:function(){return s}});let{useCreateAdminTemplateMutation:i,useGetAdminTemplatesQuery:r,useGetAvailableTemplatesQuery:o,useGetAdminTemplateQuery:a,useUpdateAdminTemplateMutation:s,useAssignTemplateMutation:l,useUnassignTemplateMutation:c,useSetDefaultTemplateMutation:d,useGetTemplatesByCategoryQuery:u,useUpdateCategoryMutation:m}=n(78101).g.injectEndpoints({overrideExisting:!0,endpoints:e=>({createAdminTemplate:e.mutation({query:e=>({url:"/template/admin",method:"POST",body:e}),invalidatesTags:["template"]}),getAdminTemplates:e.query({query:e=>({url:"/template/admin",method:"GET",params:e||void 0}),providesTags:["template"],transformResponse:e=>({data:e.data})}),getAvailableTemplates:e.query({query:e=>({url:"/template/admin/available",method:"GET",params:e||void 0}),providesTags:["template"],transformResponse:e=>({data:e.data})}),getAdminTemplate:e.query({query:e=>({url:"/template/admin/".concat(e),method:"GET"}),providesTags:(e,t,n)=>[{type:"template",id:n}],transformResponse:e=>({data:e.data})}),updateAdminTemplate:e.mutation({query:e=>{let{id:t,...n}=e;return{url:"/template/admin/".concat(t),method:"PATCH",body:n}},invalidatesTags:(e,t,n)=>{let{id:i}=n;return["template",{type:"template",id:i}]}}),assignTemplate:e.mutation({query:e=>({url:"/template/admin/assign",method:"POST",body:e}),invalidatesTags:["template"]}),unassignTemplate:e.mutation({query:e=>({url:"/template/admin/".concat(e),method:"DELETE"}),invalidatesTags:(e,t,n)=>["template",{type:"template",id:n}]}),setDefaultTemplate:e.mutation({query:e=>({url:"/template/admin/".concat(e,"/default"),method:"PATCH"}),invalidatesTags:["template"]}),getTemplatesByCategory:e.query({query:e=>({url:"/template/category/".concat(e),method:"GET"}),providesTags:(e,t,n)=>[{type:"template",id:"category-".concat(n)}],transformResponse:e=>({data:e.data})}),updateCategory:e.mutation({query:e=>{let{ctgId:t,...n}=e;return{url:"/template/category/".concat(t),method:"PATCH",body:n}},invalidatesTags:(e,t,n)=>{let{ctgId:i}=n;return["template",{type:"template",id:"category-".concat(i)}]}})})})},78101:function(e,t,n){"use strict";n.d(t,{g:function(){return s}});var i=n(49854),r=n(68240),o=n(94183),a=n(28317);let s=(0,r.LC)({baseQuery:(0,o.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,t)=>fetch(e,t).then(async n=>{let r="string"==typeof e?e:e.url;return r.includes("?")||(null==t?void 0:t.body)||"string"!=typeof e&&e.body||await (0,a.t8)(r,await n.clone().json().catch(()=>null),(0,i.x)()),n}).catch(async n=>{if(n instanceof TypeError){let n="string"==typeof e?e:e.url;if(!n.includes("?")&&!(null==t?void 0:t.body)&&!("string"!=typeof e&&e.body)){let e=await (0,a.U2)(n,(0,i.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw n})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},49854:function(e,t,n){"use strict";let i;n.d(t,{d:function(){return c},x:function(){return l}});var r=n(72940),o=n(6780),a=n(67732),s=n(28317);function l(){return i||(i=(0,s.MT)("cached-responses-store","cached-responses")),i}async function c(e,t){try{let n=await o.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...r.FD});return await (0,s.t8)(e,n.data,l()),n.data}catch(t){if(t instanceof a.d7&&[a.d7.ERR_NETWORK,a.d7.ETIMEDOUT].includes(t.code)){let t=await (0,s.U2)(e,l());if(t)return t}throw t instanceof a.d7&&t.response&&401===t.response.status||console.error(t),t}}}},function(e){e.O(0,[1601,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,6029,7125,9645,5865,2460,9175,7402,1744],function(){return e(e.s=48447)}),_N_E=e.O()}]);