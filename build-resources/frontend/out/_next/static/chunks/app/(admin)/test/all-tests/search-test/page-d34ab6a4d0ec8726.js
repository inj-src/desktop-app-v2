(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{34671:function(e,t,n){Promise.resolve().then(n.bind(n,79756))},76594:function(e,t,n){"use strict";var s=n(42752);n.o(s,"debounce")&&n.d(t,{debounce:function(){return s.debounce}})},79756:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return H}});var s=n(68328),a=n(32730),i=n(70772),r=n(50002),l=n(86127),o=n(22614),d=n(55911),c=n(31204),u=n(86083),m=n(4505);let h=(0,m.memo)(e=>{let{searchTerm:t,onSearchChange:n}=e;return(0,s.jsx)(o.Group,{w:"100%",justify:"space-between",align:"flex-end",children:(0,s.jsx)(d.TextInput,{placeholder:"Search tests by name, code or price...",value:t,onChange:e=>n(e.currentTarget.value),style:{flex:1},leftSection:(0,s.jsx)(u.Z,{size:16}),rightSection:t&&(0,s.jsx)(c.Button,{variant:"subtle",size:"xs",onClick:()=>n(""),children:"Clear"})})})});h.displayName="SearchInput";var p=n(83501),f=n(38707),v=n(51248),g=n(74559),C=n(25499),x=n(25626),b=n(48604),y=n(36409),j=n(41224),w=n(14587),T=n(22041),S=n(68242),A=n(76029),k=n(10779),Z=n(25299),F=n(22115),I=n(51973),L=n(84553),N=n(60711),M=n(44019),z=n(12697),D=n(91247),P=n(76594),E=n(42116),R=n(12450),q=n(90660),_=n.n(q);let O=(0,E.default)(()=>Promise.all([n.e(4927),n.e(9698),n.e(3191)]).then(n.bind(n,48154)),{loadableGenerated:{webpack:()=>[48154]},loading:()=>(0,s.jsx)(b.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,s.jsx)(y.M,{style:{minHeight:500},children:(0,s.jsxs)(j.Stack,{align:"center",gap:"md",children:[(0,s.jsx)(w.Loader,{size:"lg",color:"blue"}),(0,s.jsx)(T.Text,{size:"sm",c:"dimmed",children:"Filtering tests..."})]})})})});var H=()=>{let[e,t]=(0,m.useState)(""),[n,d]=(0,m.useState)(""),[c,u]=(0,m.useState)([]),[E,q]=(0,m.useState)(!1),H=(0,C.C)(g.nC),B=(0,R.useRouter)(),G=(0,C.C)(e=>{var t,n;return(null===(t=e.auth.diagnostic)||void 0===t?void 0:t.isLabManagement)||(null===(n=e.auth.user)||void 0===n?void 0:n.role)==="labAssistant"}),U=(0,m.useCallback)((0,P.debounce)(e=>{d(e.toLowerCase())},300),[]),K=(0,C.T)(),V=(0,C.C)(e=>e.tests);(0,m.useEffect)(()=>{(async()=>{let{success:e,data:t}=await (0,p.Y)();e?K((0,x.Z2)(t)):_().fire("Failed","Failed to load tests","error")})()},[K]);let W=(0,m.useMemo)(()=>{var e;return(null==V?void 0:null===(e=V.adminCategories)||void 0===e?void 0:e.flatMap(e=>e.tests))||[]},[null==V?void 0:V.adminCategories]),Y=(0,m.useMemo)(()=>{if(!n)return W;q(!0);let e=n.split(" ").filter(e=>e.length>0);if(0===e.length)return;let t=W.filter(t=>{var n,s,a;let i=(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())||"",r=(null===(s=t.code)||void 0===s?void 0:s.toLowerCase())||"",l=(null===(a=t.price)||void 0===a?void 0:a.toString())||"";return e.every(e=>i.includes(e)||r.includes(e)||l.includes(e))});return q(!1),t},[W,n]),J=async e=>{let{success:t,data:n}=await (0,f.e)(e);t&&_().fire({title:"Test Deleted",icon:"success"})};if(E)return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,s.jsx)(y.M,{style:{minHeight:500},children:(0,s.jsxs)(j.Stack,{align:"center",gap:"md",children:[(0,s.jsx)(w.Loader,{size:"lg",color:"blue"}),(0,s.jsx)(T.Text,{size:"sm",c:"dimmed",children:"Filtering tests..."})]})})}),";"]});let Q=async(e,t)=>{let n=await (0,v.p)(e,{showOnLab:t});return!!n.success&&(K((0,x.Zw)([n.data])),F.N9.show({title:"Success",message:"Request has been processed successfully",color:"green"}),!0)};return(0,s.jsxs)("div",{className:"p-4 border-black",children:[(0,s.jsx)(S.Title,{children:"Search Test"}),(0,s.jsx)(b.Z,{shadow:"sm",padding:"lg",withBorder:!0,my:"md",children:(0,s.jsx)(o.Group,{w:"100%",justify:"space-between",align:"flex-end",children:(0,s.jsx)(h,{searchTerm:e,onSearchChange:e=>{t(e),console.log(e,"hhere"),U(e)}})})}),Y?(0,s.jsx)(O,{setSelectedArray:u,selectedArray:c,isSelectTable:!0,containSerialNo:!0,headers:"labAssistant"===H?["Sl","","Test Name","Sub Cat","Price","Sample","Reference Value","In Lab","Actions"]:["Sl","","Test Name","Sub Cat","Price","Discount","Sample","Reference Value","In Lab","Actions"],data:null!=Y?Y:[],dataKeys:["name","subcat","price","labAssistant"!==H?"discount":"","sample","reference","lab","actions"],customComponentKeyName:["discount","subcat","actions","sample","reference","lab"],customComponentObject:{discount:e=>(0,s.jsx)(i.s,{test:e}),sample:e=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(r.Z,{item:e})}),lab:e=>(0,s.jsxs)(s.Fragment,{children:[" ",e.showOnLab?(0,s.jsx)(A.u,{label:"Click to hide this test from lab",children:(0,s.jsx)(N.Z,{onClick:()=>Q(e.id,!1)})}):(0,s.jsx)(A.u,{label:"Click to make this test visible in lab",children:(0,s.jsx)(I.Z,{onClick:()=>Q(e.id,!0)})})]}),reference:e=>(0,s.jsx)(a.Z,{item:e}),actions:e=>{var t,n,a,i;return(0,s.jsxs)(o.Group,{gap:4,children:["labAssistant"!==H&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.p,{item:e}),(0,s.jsx)(A.u,{label:"Edit",children:(0,s.jsx)(M.Z,{onClick:()=>B.push("/test/edit?testId=".concat(e.id))})}),(0,s.jsx)(A.u,{label:"Delete",children:(0,s.jsx)(z.Z,{className:"cursor",onClick:()=>{Z.qk.openConfirmModal({title:"Delete",centered:!0,children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("span",{className:"d-block h4",children:"Are you sure?"})}),labels:{confirm:"Delete",cancel:"Cancel"},onConfirm:async()=>{J(e.id),K((0,x.se)({id:e.id}))},onCancel:()=>{}})},color:"red"})})]}),G&&(0,s.jsx)(A.u,{label:"Template Lists",children:(0,s.jsxs)(k.z,{color:(null==e?void 0:null===(t=e.testTemplates)||void 0===t?void 0:t.length)?"green":"red",label:null==e?void 0:null===(n=e.testTemplates)||void 0===n?void 0:n.length,size:16,children:[(0,s.jsx)(D.Z,{onClick:()=>B.push("/test/templates?testId=".concat(e.id,"&testName=").concat(e.name))}),","]})}),"superadmin"===H&&(0,s.jsx)(A.u,{label:"Template Lists",children:(0,s.jsx)(L.Z,{href:"/test/templates?testId=".concat(e.id,"&testName=").concat(e.name),children:(0,s.jsxs)(k.z,{color:(null==e?void 0:null===(a=e.testTemplates)||void 0===a?void 0:a.length)?"green":"red",label:null==e?void 0:null===(i=e.testTemplates)||void 0===i?void 0:i.length,size:16,children:[(0,s.jsx)(D.Z,{}),","]})})})]})},subcat:e=>{var t;return(0,s.jsx)(s.Fragment,{children:null==e?void 0:null===(t=e.subTestCategory)||void 0===t?void 0:t.name})}}}):(0,s.jsx)(s.Fragment,{})]})}},72940:function(e,t,n){"use strict";n.d(t,{FD:function(){return a},Hn:function(){return s},y4:function(){return i}});let s={headers:{"Content-Type":"application/json"}},a={withCredentials:!0},i={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},83501:function(e,t,n){"use strict";n.d(t,{Y:function(){return i}});var s=n(49854),a=n(67732);let i=async()=>{try{let e=await (0,s.d)("testCategory/admin");return{success:!0,data:e.data}}catch(t){if(t instanceof a.d7){var e;return{success:!1,data:null===(e=t.response)||void 0===e?void 0:e.data.message}}return{success:!1,data:"An error occurred"}}}},38707:function(e,t,n){"use strict";n.d(t,{e:function(){return r}});var s=n(72940),a=n(6780),i=n(67732);let r=async e=>{try{let t=await a.default.delete("".concat("http://sasthotech.local:5000/api/v1","/test/").concat(e),s.FD);return{success:!0,data:t.data.data}}catch(e){if(e instanceof i.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}}},74559:function(e,t,n){"use strict";n.d(t,{Im:function(){return r},av:function(){return i},nC:function(){return a}});let s=(0,n(79258).createSlice)({name:"auth",initialState:{isAuth:null,user:null,isProfileIncomplete:!1,diagnostic:null},reducers:{setUser:(e,t)=>{var n;e.user=t.payload,e.isAuth=!!t.payload,(null===(n=t.payload)||void 0===n?void 0:n.name)?localStorage.setItem("name",t.payload.name):localStorage.removeItem("name")},setDiagnostic:(e,t)=>{let n=t.payload;"hospital.sasthotech.com"===window.location.hostname?n.activeLogo=n.logo:n.activeLogo=n.offlineLogo,e.diagnostic=n},setProfileIncomplete:(e,t)=>{e.isProfileIncomplete=t.payload}}}),a=e=>{var t;return null===(t=e.auth.user)||void 0===t?void 0:t.role},{setUser:i,setDiagnostic:r}=s.actions;t.ZP=s.reducer},25499:function(e,t,n){"use strict";n.d(t,{C:function(){return i},T:function(){return a}});var s=n(53502);let a=()=>(0,s.I0)(),i=s.v9},25626:function(e,t,n){"use strict";let s;n.d(t,{H3:function(){return c},Z2:function(){return m},Zw:function(){return C},_W:function(){return d},gu:function(){return p},lF:function(){return f},mC:function(){return g},s9:function(){return h},se:function(){return v}});var a=n(79258),i=n(69192),r=n(28317);function l(){return s||(s=(0,r.MT)("test-frequency-store","test-frequency")),s}let o=new Intl.Collator,d=(0,a.createAsyncThunk)("tests/setAdminTests",async e=>{let t=await (0,r.qh)().catch(()=>[]);return t.length?(await (0,r.vw)(t,l()),(0,r.ZH)()):t=await (0,r.qh)(l()).catch(()=>[]),[e,t]}),c=(0,a.createAsyncThunk)("tests/increaseTestFrequencies",async e=>(await Promise.all(e.map(e=>(0,r.Vx)(e.id,e=>(e||0)+1),l())).catch(),await (0,r.qh)(l()).catch(()=>[]))),u=(0,a.createSlice)({name:"tests",initialState:{adminCategories:[],adminTests:null,superAdminCategories:[]},reducers:{setAdminCategories:(e,t)=>{e.adminCategories=t.payload},removeAdminCategories:(e,t)=>{var n;e.adminCategories=null===(n=e.adminCategories)||void 0===n?void 0:n.filter(e=>e.id!==t.payload.id)},updateTestsInAdminCategories:(e,t)=>{var n;let s=t.payload;console.log(s),e.adminCategories=null===(n=e.adminCategories)||void 0===n?void 0:n.map(e=>({...e,tests:e.tests.map(e=>s.find(t=>t.id===e.id)||e)}))},removeTestFromAdminCategories:(e,t)=>{var n;e.adminCategories=null===(n=e.adminCategories)||void 0===n?void 0:n.map(e=>({...e,tests:e.tests.filter(e=>e.id!==t.payload.id)}))},removeTestFromSuperAdminCategories:(e,t)=>{var n;e.superAdminCategories=null===(n=e.superAdminCategories)||void 0===n?void 0:n.map(e=>({...e,tests:e.tests.filter(e=>e.id!==t.payload.id)}))},setSuperAdminCategories:(e,t)=>{e.superAdminCategories=t.payload},removeSuperAdminCategories:(e,t)=>{var n;e.superAdminCategories=null===(n=e.superAdminCategories)||void 0===n?void 0:n.filter(e=>e.id!==t.payload.id)}},extraReducers:e=>{e.addCase(d.fulfilled,(e,t)=>{let n=t.payload[0],s=new Map(t.payload[1]);if(Array.isArray(n))e.adminTests=[...n];else{if(e.adminTests){let t=e.adminTests.findIndex(e=>e.id===n.id);t>=0?e.adminTests[t]=n:e.adminTests.push(n)}else e.adminTests=[n];if(e.adminCategories){for(let t=0;t<e.adminCategories.length;t++)for(let s=0;s<e.adminCategories[t].tests.length;s++)if(n.id===e.adminCategories[t].tests[s].id){e.adminCategories[t].tests[s]=n;break}}}e.adminTests.sort((e,t)=>{var n,a;return(null!==(n=s.get(t.id))&&void 0!==n?n:0)-(null!==(a=s.get(e.id))&&void 0!==a?a:0)||o.compare(e.name,t.name)})}),e.addCase(c.fulfilled,(e,t)=>{var n;let s=new Map(t.payload);null===(n=e.adminTests)||void 0===n||n.sort((e,t)=>{var n,a;return(null!==(n=s.get(t.id))&&void 0!==n?n:0)-(null!==(a=s.get(e.id))&&void 0!==a?a:0)||o.compare(e.name,t.name)})})}});(0,i.createSelector)([e=>e.tests.adminCategories],e=>new Map(null==e?void 0:e.map(e=>[+e.id,e])));let{setAdminCategories:m,removeAdminCategories:h,setSuperAdminCategories:p,removeSuperAdminCategories:f,removeTestFromAdminCategories:v,removeTestFromSuperAdminCategories:g,updateTestsInAdminCategories:C}=u.actions;t.ZP=u.reducer},49854:function(e,t,n){"use strict";let s;n.d(t,{d:function(){return d},x:function(){return o}});var a=n(72940),i=n(6780),r=n(67732),l=n(28317);function o(){return s||(s=(0,l.MT)("cached-responses-store","cached-responses")),s}async function d(e,t){try{let n=await i.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...a.FD});return await (0,l.t8)(e,n.data,o()),n.data}catch(t){if(t instanceof r.d7&&[r.d7.ERR_NETWORK,r.d7.ETIMEDOUT].includes(t.code)){let t=await (0,l.U2)(e,o());if(t)return t}throw t instanceof r.d7&&t.response&&401===t.response.status||console.error(t),t}}}},function(e){e.O(0,[1601,2975,7852,3069,6945,3852,1656,9722,4670,9258,9533,12,7538,1166,7967,6029,6306,3583,6889,3229,443,5189,9175,7402,1744],function(){return e(e.s=34671)}),_N_E=e.O()}]);