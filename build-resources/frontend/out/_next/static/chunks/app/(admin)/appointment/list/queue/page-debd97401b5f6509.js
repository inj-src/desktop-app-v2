(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1198],{93332:function(e,t,n){Promise.resolve().then(n.bind(n,97238))},33908:function(e){var t,n,i,s,r,o,a,d,l,u,c,h,f,p,v,m,x,g,j,y,S,w;e.exports=(t="millisecond",n="second",i="minute",s="hour",r="week",o="month",a="quarter",d="year",l="date",u="Invalid Date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},(v={})[p="en"]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||"th")+"]"}},m="$isDayjsObject",x=function(e){return e instanceof S||!(!e||!e[m])},g=function e(t,n,i){var s;if(!t)return p;if("string"==typeof t){var r=t.toLowerCase();v[r]&&(s=r),n&&(v[r]=n,s=r);var o=t.split("-");if(!s&&o.length>1)return e(o[0])}else{var a=t.name;v[a]=t,s=a}return!i&&s&&(p=s),s||!i&&p},j=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new S(n)},(y={s:f,z:function(e){var t=-e.utcOffset(),n=Math.abs(t);return(t<=0?"+":"-")+f(Math.floor(n/60),2,"0")+":"+f(n%60,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),s=t.clone().add(i,o),r=n-s<0,a=t.clone().add(i+(r?-1:1),o);return+(-(i+(n-s)/(r?s-a:a-s))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return({M:o,y:d,w:r,d:"day",D:l,h:s,m:i,s:n,ms:t,Q:a})[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}}).l=g,y.i=x,y.w=function(e,t){return j(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})},w=(S=function(){function e(e){this.$L=g(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[m]=!0}var f=e.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(y.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(c);if(i){var s=i[2]-1||0,r=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)):new Date(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)}}return new Date(t)}(e),this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return y},f.isValid=function(){return this.$d.toString()!==u},f.isSame=function(e,t){var n=j(e);return this.startOf(t)<=n&&n<=this.endOf(t)},f.isAfter=function(e,t){return j(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<j(e)},f.$g=function(e,t,n){return y.u(e)?this[t]:this.set(n,e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,t){var a=this,u=!!y.u(t)||t,c=y.p(e),h=function(e,t){var n=y.w(a.$u?Date.UTC(a.$y,t,e):new Date(a.$y,t,e),a);return u?n:n.endOf("day")},f=function(e,t){return y.w(a.toDate()[e].apply(a.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(t)),a)},p=this.$W,v=this.$M,m=this.$D,x="set"+(this.$u?"UTC":"");switch(c){case d:return u?h(1,0):h(31,11);case o:return u?h(1,v):h(0,v+1);case r:var g=this.$locale().weekStart||0,j=(p<g?p+7:p)-g;return h(u?m-j:m+(6-j),v);case"day":case l:return f(x+"Hours",0);case s:return f(x+"Minutes",1);case i:return f(x+"Seconds",2);case n:return f(x+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(e,r){var a,u=y.p(e),c="set"+(this.$u?"UTC":""),h=((a={}).day=c+"Date",a[l]=c+"Date",a[o]=c+"Month",a[d]=c+"FullYear",a[s]=c+"Hours",a[i]=c+"Minutes",a[n]=c+"Seconds",a[t]=c+"Milliseconds",a)[u],f="day"===u?this.$D+(r-this.$W):r;if(u===o||u===d){var p=this.clone().set(l,1);p.$d[h](f),p.init(),this.$d=p.set(l,Math.min(this.$D,p.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[y.p(e)]()},f.add=function(e,t){var a,l=this;e=Number(e);var u=y.p(t),c=function(t){var n=j(l);return y.w(n.date(n.date()+Math.round(t*e)),l)};if(u===o)return this.set(o,this.$M+e);if(u===d)return this.set(d,this.$y+e);if("day"===u)return c(1);if(u===r)return c(7);var h=((a={})[i]=6e4,a[s]=36e5,a[n]=1e3,a)[u]||1,f=this.$d.getTime()+e*h;return y.w(f,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||u;var i=e||"YYYY-MM-DDTHH:mm:ssZ",s=y.z(this),r=this.$H,o=this.$m,a=this.$M,d=n.weekdays,l=n.months,c=n.meridiem,f=function(e,n,s,r){return e&&(e[n]||e(t,i))||s[n].slice(0,r)},p=function(e){return y.s(r%12||12,e,"0")},v=c||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i};return i.replace(h,function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return y.s(t.$y,4,"0");case"M":return a+1;case"MM":return y.s(a+1,2,"0");case"MMM":return f(n.monthsShort,a,l,3);case"MMMM":return f(l,a);case"D":return t.$D;case"DD":return y.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return f(n.weekdaysMin,t.$W,d,2);case"ddd":return f(n.weekdaysShort,t.$W,d,3);case"dddd":return d[t.$W];case"H":return String(r);case"HH":return y.s(r,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return v(r,o,!0);case"A":return v(r,o,!1);case"m":return String(o);case"mm":return y.s(o,2,"0");case"s":return String(t.$s);case"ss":return y.s(t.$s,2,"0");case"SSS":return y.s(t.$ms,3,"0");case"Z":return s}return null}(e)||s.replace(":","")})},f.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},f.diff=function(e,t,l){var u,c=this,h=y.p(t),f=j(e),p=(f.utcOffset()-this.utcOffset())*6e4,v=this-f,m=function(){return y.m(c,f)};switch(h){case d:u=m()/12;break;case o:u=m();break;case a:u=m()/3;break;case r:u=(v-p)/6048e5;break;case"day":u=(v-p)/864e5;break;case s:u=v/36e5;break;case i:u=v/6e4;break;case n:u=v/1e3;break;default:u=v}return l?u:y.a(u)},f.daysInMonth=function(){return this.endOf(o).$D},f.$locale=function(){return v[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=g(e,t,!0);return i&&(n.$L=i),n},f.clone=function(){return y.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},e}()).prototype,j.prototype=w,[["$ms",t],["$s",n],["$m",i],["$H",s],["$W","day"],["$M",o],["$y",d],["$D",l]].forEach(function(e){w[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),j.extend=function(e,t){return e.$i||(e(t,S,j),e.$i=!0),j},j.locale=g,j.isDayjs=x,j.unix=function(e){return j(1e3*e)},j.en=v[p],j.Ls=v,j.p={},j)},26490:function(e,t,n){"use strict";n.d(t,{Hz:function(){return s},cs:function(){return r},pi:function(){return u},vE:function(){return l},zG:function(){return c}});var i=n(4505);n(68328);let s=["xxl","xl","lg","md","sm","xs"],r="xs",o=i.createContext({prefixes:{},breakpoints:s,minBreakpoint:r}),{Consumer:a,Provider:d}=o;function l(e,t){let{prefixes:n}=(0,i.useContext)(o);return e||n[t]||t}function u(){let{breakpoints:e}=(0,i.useContext)(o);return e}function c(){let{minBreakpoint:e}=(0,i.useContext)(o);return e}},5171:function(e,t,n){"use strict";n.d(t,{$:function(){return u}});var i=n(68328),s=n(32451),r=n(31204),o=n(31662),a=n(24811),d=n(4505),l=n(77410);function u(){var e;let[t,n]=(0,d.useState)(!1),u=(0,l.L)();return(0,i.jsxs)(s.Box,{children:[(0,i.jsx)(r.Button,{variant:"outline",color:"orange",size:"xs",rightSection:(0,i.jsx)(o.Z,{size:14}),onClick:()=>n(!0),children:"Notice"}),(0,i.jsx)(a.P,{opened:t,onClose:()=>n(!1),doctorSessionId:(null===(e=u.data.session)||void 0===e?void 0:e.id)||""})]})}},93978:function(e,t,n){"use strict";n.d(t,{Z:function(){return B}});var i=n(68328),s=n(31204),r=n(22975),o=n(22614),a=n(46557),d=n(79894),l=n(73427),u=n(90660),c=n.n(u),h=n(36409),f=n(48604),p=n(41224),v=n(58812),m=n(68242),x=n(22041),g=n(11114),j=n(4505),y=n(77230),S=n(38156),w=n(31662),b=n(93636),$=n(14587),C=n(16391),M=n(77410),k=n(17443),D=n(99238),z=n(24590),T=n(26543),I=n(91622),O=n(21864),N=n(24811),Z=n(74114);function A(){var e,t,n,s,r;let{data:o}=(0,M.L)(),{toggle:a}=(0,d.O)(),l=(0,I.N)({sessionId:(null===(e=o.session)||void 0===e?void 0:e.id)||"",slotId:(null===(t=o.session)||void 0===t?void 0:t.slotId)||"",diagnosticId:(null===(n=o.session)||void 0===n?void 0:n.diagnosticId)||"",doctorChamberId:(null===(s=o.session)||void 0===s?void 0:s.doctorChamberId)||""}),{settings:u,setSettings:c}=(0,O.q)(),{width:A}=(0,Z.n)(),[_,q]=(0,j.useState)(!1),[B,G]=(0,j.useState)(!1),[E,L]=(0,j.useState)(!0);if((0,j.useEffect)(()=>{(null==l?void 0:l.queue.notices.length)&&L(!0)},[null==l?void 0:l.queue.notices.length]),null===l)return(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,i.jsx)($.Loader,{})});let F=null==l?void 0:l.queue.appointments.filter(e=>"ON_GOING"===e.status),P=null==l?void 0:l.queue.appointments.filter(e=>["CONFIRMED","WAITING","BOOKED"].includes(e.status)),H=P.length;u.enablePatientsDisplay&&(P=P.slice(0,u.patientsDisplay));let Y=u.automaticGrouping?F.length:u.patientGroup;return A<1e3?(0,i.jsx)(h.M,{style:{height:"100vh",backgroundColor:"#f8f9fa"},p:"xl",children:(0,i.jsx)(f.Z,{shadow:"lg",padding:"xl",radius:"md",withBorder:!0,style:{maxWidth:500,textAlign:"center"},children:(0,i.jsxs)(p.Stack,{align:"center",gap:"lg",children:[(0,i.jsx)(v.k,{size:80,radius:"xl",variant:"light",color:"grape",children:(0,i.jsx)(y.Z,{size:40})}),(0,i.jsxs)(p.Stack,{gap:"sm",children:[(0,i.jsx)(m.Title,{order:2,children:"Screen Size Too Small"}),(0,i.jsx)(x.Text,{c:"dimmed",size:"sm",children:"This page requires a minimum screen width of 1000px for optimal viewing experience."}),(0,i.jsxs)(x.Text,{c:"dimmed",size:"sm",fw:500,children:["Current width: ",A,"px"]})]}),(0,i.jsx)(g.C,{size:"lg",color:"grape",variant:"light",children:"Open on a larger screen"})]})})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{position:"relative",height:"100vh",overflow:"hidden"},children:[(0,i.jsxs)(C.k,{style:{position:"fixed",bottom:20,right:20,gap:12,zIndex:10,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:6,padding:8,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",border:"1px solid rgba(0, 0, 0, 0.05)"},children:[(0,i.jsx)(S.Z,{style:{cursor:"pointer",color:"#666"},onClick:()=>q(!0),size:20}),(0,i.jsx)(w.Z,{style:{cursor:"pointer",color:"#666"},onClick:()=>G(!0),size:20}),(0,i.jsx)(b.Z,{style:{cursor:"pointer",color:"#666"},onClick:a,size:20})]}),(0,i.jsx)(k.Z,{fontSizeMultiplier:u.fontSizeMultiplier,showSerialNo:u.showSerialNo,notices:l.queue.notices||[],showNotices:E,setShowNotices:()=>L(e=>!e),leftContent:(0,i.jsx)(z.Z,{fontSizeMultiplier:u.fontSizeMultiplier,patientGroup:Y,showSerialNo:u.showSerialNo,upcoming:P}),rightContent:(0,i.jsx)(T.Z,{fontSizeMultiplier:u.fontSizeMultiplier,onGoingFullLength:H,ongoing:F,upcoming:P,patientGroup:u.patientGroup,automaticGrouping:u.automaticGrouping,showSerialNo:u.showSerialNo,showSerialTime:u.showSerialTime})})]}),(0,i.jsx)(D.Z,{opened:_,onClose:()=>q(!1),initialSettings:u,onSave:e=>c(e)}),(0,i.jsx)(N.P,{doctorSessionId:(null===(r=o.session)||void 0===r?void 0:r.id)||"",opened:B,onClose:()=>G(!1),setShowNotices:()=>L(!0)})]})}var _=n(25922),q=n(14803);function B(e){let{doctorChamberId:t,slotId:n,date:u,actualStartTime:h,refetch:f}=e,{opened:p,open:v,close:m}=(0,q.Q)("liveQueueModal"+n),[x,{open:g,close:j}]=(0,a.q)(!1),{toggle:y,fullscreen:S}=(0,d.O)(),[w,{isLoading:b}]=(0,_.U6)(),$=async()=>{try{await w({date:u,slotId:n,actualStartTime:h,doctorChamberId:t}).unwrap(),j(),f(),c().fire({icon:"success",title:"Live Queue Started Successfully",text:"The queue is now active and ready to use.",showCancelButton:!0,confirmButtonText:"Open Live Queue",cancelButtonText:"Close"}).then(e=>{e.isConfirmed&&(v(),S||y())})}catch(t){var e;console.error("Failed to start queue:",t),c().fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,icon:"error",title:"Failed to start queue",text:(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"An unexpected error occurred"})}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.Button,{variant:"outline",color:"grape",size:"xs",rightSection:(0,i.jsx)(l.Z,{size:14}),onClick:function(){e.isSessionActive?(v(),S||y()):g()},children:"Live Queue"}),(0,i.jsxs)(r.u,{opened:x,onClose:j,title:"Confirmation",centered:!0,children:[(0,i.jsx)("p",{children:"Are you sure you want to start the live queue?"}),(0,i.jsxs)(o.Group,{justify:"flex-end",mt:"md",children:[(0,i.jsx)(s.Button,{variant:"default",onClick:j,children:"Cancel"}),(0,i.jsx)(s.Button,{loading:b,onClick:$,children:"Confirm"})]})]}),(0,i.jsx)(r.u,{opened:p,onClose:m,withCloseButton:!1,padding:0,radius:0,fullScreen:S,size:S?void 0:"100%",children:(0,i.jsx)(A,{})})]})}},97238:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eu}});var i=n(68328),s=n(34473),r=n(22614),o=n(22041),a=n(32451),d=n(76029),l=n(29663),u=n(48604),c=n(68242),h=n(75865),f=n(31204),p=n(3741),v=n(77303),m=n(58812),x=n(49238),g=n(50430),j=n(30446);let y=(0,n(52165).Z)("outline","user-x","UserX",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h3.5",key:"svg-1"}],["path",{d:"M22 22l-5 -5",key:"svg-2"}],["path",{d:"M17 22l5 -5",key:"svg-3"}]]);var S=n(82371),w=n(4505),b=n(41224),$=n(89043),C=n(36409);function M(){var e;let[t,n]=(0,w.useState)(!1);(0,w.useEffect)(()=>{let e=setTimeout(()=>n(!0),10);return()=>clearTimeout(e)},[]);let{setNodeRef:s,isOver:r,active:a}=(0,S.Zj)({id:"MISSED"});return(null==a?void 0:null===(e=a.data.current)||void 0===e?void 0:e.status)=="MISSED"?null:(0,i.jsx)("div",{ref:s,style:{transform:t?"translateY(0)":"translateY(-50px)",opacity:t?1:0,transition:"transform 220ms cubic-bezier(.2,.9,.3,1), opacity 180ms ease-in"},children:(0,i.jsx)($.X,{shadow:"sm",p:"md",radius:"md",withBorder:!0,style:{borderStyle:"dashed",borderColor:r?"#fa5252":"#228be6",backgroundColor:r?"#fff5f5":"#f8f9ff",transition:"border-color 150ms ease, background-color 150ms ease"},children:(0,i.jsx)(C.M,{children:(0,i.jsxs)(b.Stack,{gap:"xs",align:"center",children:[(0,i.jsx)(m.k,{size:48,radius:"md",color:r?"red":"blue",variant:"light",children:(0,i.jsx)(y,{size:28})}),(0,i.jsx)(o.Text,{fw:700,size:"sm",children:"Drop here to mark as missed"}),(0,i.jsx)(o.Text,{size:"xs",c:"dimmed",ta:"center",children:"Drag a patient card here to mark the appointment as missed."})]})})})})}var k=n(82e3),D=n(11114),z=n(7965),T=n(96426),I=n(33908),O=n.n(I),N=n(61683),Z=n(72940),A=n(6780),_=n(67732);let q=async e=>{try{let t=await A.default.patch("".concat("http://sasthotech.local:5000/api/v1","/appointment/status-only/").concat(e.id),{status:e.status},{...Z.FD,...Z.Hn});return{success:!0,data:t.data.data}}catch(e){if(e instanceof _.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}},B=async e=>{try{let t=await A.default.post("".concat("http://sasthotech.local:5000/api/v1","/appointment/swap-serial"),e,{...Z.FD,...Z.Hn});return{success:!0,data:t.data.data}}catch(e){if(e instanceof _.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}};var G=n(31151);async function E(e,t,n){var i,s,r,o,a;let{active:d,over:l}=e;if((null==l?void 0:l.id)=="MISSED")L({id:null===(i=d.data.current)||void 0===i?void 0:i.id,status:"MISSED"},n);else if(l){let e=G.toast.loading("Updating Queue Status...");(await B({doctorChamberId:null===(s=t.session)||void 0===s?void 0:s.doctorChamberId,fromTime:null===(r=d.data.current)||void 0===r?void 0:r.timeOf,toTime:null==l?void 0:null===(o=l.data.current)||void 0===o?void 0:o.timeOf,slotId:null===(a=t.session)||void 0===a?void 0:a.slotId})).success?n():G.toast.error("Failed to Update Queue",{id:e})}}async function L(e,t){let n=G.toast.loading("Updating Queue Status...");(await q(e)).success?t():G.toast.error("Failed to Update Queue",{id:n})}function F(e){let{queueItem:t,refetch:n}=e,s="ON_GOING"===t.status,a="MISSED"===t.status,{attributes:d,listeners:l,setNodeRef:c,transform:h,isDragging:f}=(0,S.O1)({id:t.id,data:t}),p=O()(t.timeOf).format("hh:mmA"),v={transform:T.ux.Translate.toString(h),zIndex:f?2e3:void 0,touchAction:"none"};return(0,i.jsx)("div",{ref:c,style:v,...l,...d,children:(0,i.jsxs)(u.Z,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,style:{borderColor:s?"#228be6":a?"#fa5252":void 0,borderWidth:s?2:1},children:[(0,i.jsxs)(r.Group,{justify:"space-between",mb:"xs",children:[(0,i.jsx)(r.Group,{gap:"sm",children:(0,i.jsxs)(r.Group,{gap:"xs",children:[(0,i.jsx)(D.C,{color:a?"red":"blue",children:t.serialNo}),(0,i.jsx)(o.Text,{fw:600,size:"sm",children:"•"}),(0,i.jsx)(o.Text,{fw:600,size:"sm",children:p})]})}),a?(0,i.jsx)(D.C,{color:"red",variant:"filled",size:"xs",children:"Missed"}):n&&(0,i.jsx)(N.Z,{status:t.status,disableMissed:!1,handleStatusChange:e=>{e&&L({id:t.id,status:e},n)}})]}),(0,i.jsx)(b.Stack,{gap:"xs",children:(0,i.jsxs)(r.Group,{gap:"xs",children:[(0,i.jsx)(z.Z,{size:14,color:"#495057"}),(0,i.jsxs)(o.Text,{size:"sm",fw:500,style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:[t.patient.name," ",(0,i.jsxs)(o.Text,{c:"dimmed",children:["(",t.patient.phone,")"]})]})]})})]})})}function P(e){let{queue:t,showDropzone:n}=e;return(0,i.jsxs)(b.Stack,{gap:"md",children:[t.length>0?t.map(e=>(0,i.jsx)(F,{queueItem:e},e.id)):!n&&(0,i.jsx)($.X,{p:"xl",radius:"md",bg:"gray.0",children:(0,i.jsx)(C.M,{children:(0,i.jsxs)(b.Stack,{align:"center",gap:"xs",children:[(0,i.jsx)(m.k,{variant:"light",color:"gray",size:"xl",children:(0,i.jsx)(k.Z,{size:24})}),(0,i.jsx)(o.Text,{size:"sm",c:"dimmed",ta:"center",children:"No missed appointments today"})]})})}),n&&(0,i.jsx)(M,{})]})}var H=n(22975),Y=n(9654),U=n(46557),Q=n(25922),W=n(90660),V=n.n(W),R=n(22392),J=n(96657),X=n(71149),K=n(69804);function ee(e){var t,n,s,a,d,l,u;let{queueItem:c,data:h,refetch:f}=e,{setNodeRef:v}=(0,S.Zj)({id:c.id,data:c}),[m,{open:x,close:g}]=(0,U.q)(),[j,{open:y,close:C}]=(0,U.q)(),[M,k]=(0,w.useState)(null),[z]=(0,Q.tP)(),T="VACANT"===c.status,I=O()(c.timeOf).format("hh:mmA"),{data:N}=(0,Q.ei)((null===(t=h.session)||void 0===t?void 0:t.doctorChamberId)||""),Z=(0,X.dB)(),A=T?"#f9fff8ff":"#f8f9ff",_=T?"#66bb6a":"#228be6";async function q(e,t){try{var n,i,s;let r=await z({slotId:null===(n=h.session)||void 0===n?void 0:n.slotId,date:O()(null===(i=h.session)||void 0===i?void 0:i.date).toISOString(),selectedTime:c.timeOf,name:e.fullName,phone:String(e.phoneNumber),ageYear:Number(e.age),gender:e.gender,paidAmount:e.paidAmount,label:e.appointmentLabel,doctorChamberId:null===(s=h.session)||void 0===s?void 0:s.doctorChamberId,type:e.appointmentType}).unwrap();if(r&&r.data.id){let e=(await (0,R._)(r.data.id)).data;t(),V().fire({title:"Appointment Booked Successfully!",text:"Print the serial token.",icon:"success",confirmButtonText:"Print",showCancelButton:!0,cancelButtonText:"Cancel",preDeny(){g()},preConfirm(){k(e),y()}})}}catch(e){V().fire({title:"Error",text:"Failed to book appointment.",icon:"error"})}}return(0,i.jsxs)("div",{ref:v,children:[(0,i.jsxs)($.X,{shadow:"sm",p:"lg",radius:"md",withBorder:!0,style:{borderStyle:"dashed",borderColor:_,backgroundColor:A,position:"relative"},children:[T&&(0,i.jsx)(D.C,{fw:600,color:"lime",style:{position:"absolute",top:14,left:14},children:c.serialNo}),(0,i.jsxs)(r.Group,{gap:"xs",justify:"center",children:[(0,i.jsx)(p.A,{size:40,radius:"sm",variant:"light",color:T?"green":"blue",style:{cursor:"pointer",display:T?"none":"block"},onClick:x,children:(0,i.jsx)(Y.Z,{size:20})}),(0,i.jsxs)(b.Stack,{style:{gap:"1px"},align:T?"center":"flex-start",children:[(0,i.jsx)(o.Text,{size:"sm",fw:500,c:T?"green":"blue",children:I}),T&&(0,i.jsx)(o.Text,{size:"xs",c:"dimmed",children:"(Drop Patient here)"}),(0,i.jsxs)(o.Text,{size:"xs",c:"dimmed",children:[T?"Vacant":"Reserved"," Slot"]})]})]})]}),(0,i.jsx)(J.Z,{queuePosition:null==c?void 0:null===(n=c.queuePosition)||void 0===n?void 0:n.toString(),handleSubmit:q,opened:m,payableAmount:{FIRST_VISIT:(null==N?void 0:null===(s=N.data)||void 0===s?void 0:s.newPatientFee)||0,OLD_VISIT:(null==N?void 0:null===(a=N.data)||void 0===a?void 0:a.oldPatientFee)||0},onClose:()=>{f(),g()},doctorName:(null===(d=h.doctor)||void 0===d?void 0:d.name)||"Unknown Doctor",sessionName:h.sessionName||"Unknown Session",date:(null===(l=h.session)||void 0===l?void 0:l.date)||"Unknown Date",slotTime:I,doctorChamberId:null===(u=h.session)||void 0===u?void 0:u.doctorChamberId}),(0,i.jsx)(H.u,{opened:j,onClose:()=>{C(),g(),f()},size:"80%",radius:0,transitionProps:{transition:"fade",duration:200},title:"Appointment Token PDF",children:M&&(()=>{var e,t,n,s,r;let o=null===(e=K.m.find(e=>e.id===Z))||void 0===e?void 0:e.Component;return o?(0,i.jsx)(o,{doctor:{id:"",name:null!==(s=null==h?void 0:null===(t=h.doctor)||void 0===t?void 0:t.name)&&void 0!==s?s:"",designation:null!==(r=null==h?void 0:null===(n=h.doctor)||void 0===n?void 0:n.designation)&&void 0!==r?r:""},appointment:M}):null})()})]})}function et(e){let{queue:t,refetch:n,data:s}=e;return(0,i.jsx)(b.Stack,{gap:"md",children:t.map(e=>"RESERVED"==e.status||"VACANT"==e.status?(0,i.jsx)(ee,{queueItem:e,data:s,refetch:n},e.id):(0,i.jsx)(F,{queueItem:e,refetch:n},e.id))})}var en=n(77410),ei=n(93978),es=n(65567),er=n.n(es),eo=n(26490);let ea=w.forwardRef((e,t)=>{let{as:n="div",bsPrefix:s,className:r,direction:o,gap:a,...d}=e;s=(0,eo.vE)(s,"horizontal"===o?"hstack":"vstack");let l=(0,eo.pi)(),u=(0,eo.zG)();return(0,i.jsx)(n,{...d,ref:t,className:er()(r,s,...function(e,t=eo.Hz,n=eo.cs){let i=[];return Object.entries(e).forEach(([e,s])=>{null!=s&&("object"==typeof s?t.forEach(t=>{let r=s[t];if(null!=r){let s=t!==n?`-${t}`:"";i.push(`${e}${s}-${r}`)}}):i.push(`${e}-${s}`))}),i}({gap:a},l,u))})});ea.displayName="Stack";var ed=n(5171);let el={activationConstraint:{distance:10}};function eu(){var e,t,n,b,$,C,M;let{data:k,refetch:D,isError:z}=(0,en.L)(),[T,I]=(0,w.useState)(!1),O=(0,S.VT)(S.we,el),N=(0,S.VT)(S.LO,el),Z=(0,S.Dy)(O,N);if(z)return(0,i.jsx)("div",{children:"Error fetching queue data"});if(!k)return(0,i.jsx)("div",{children:"loading queue..."});let A=k.queue.filter(e=>"MISSED"===e.status),_=k.queue.filter(e=>"MISSED"!==e.status);return(0,i.jsxs)(s.Container,{p:"md",style:{overflow:"hidden",minHeight:"100dvh"},children:[(0,i.jsxs)(r.Group,{justify:"space-between",mb:"lg",children:[(0,i.jsxs)(ea,{children:[(0,i.jsx)(c.Title,{order:2,mb:"xs",children:"Queue Management"}),(0,i.jsxs)(o.Text,{size:"sm",c:"dimmed",children:["Doctor: ",null===(e=k.doctor)||void 0===e?void 0:e.name]}),(0,i.jsxs)(r.Group,{children:[(0,i.jsxs)(o.Text,{size:"sm",c:"dimmed",mt:4,children:[k.sessionName," Session •"," ",(null===(t=k.session)||void 0===t?void 0:t.date)?new Date(null===(n=k.session)||void 0===n?void 0:n.date).toLocaleDateString():""]}),(0,i.jsxs)(h.v,{shadow:"sm",withinPortal:!0,position:"bottom-end",offset:6,children:[(0,i.jsx)(h.v.Target,{children:(0,i.jsx)(f.Button,{variant:"subtle",size:"xs",rightSection:(0,i.jsx)(x.Z,{size:12}),children:"Stats"})}),(0,i.jsx)(h.v.Dropdown,{children:k.stats&&Object.keys(k.stats).length>0?Object.entries(k.stats).map(e=>{let[t,n]=e;return(0,i.jsxs)(h.v.Item,{styles:{item:{fontSize:12}},children:[(0,i.jsx)(o.Text,{component:"span",c:"dimmed",size:"xs",style:{marginRight:8,textTransform:"capitalize"},children:t.replace(/_/g," ")}),(0,i.jsx)(o.Text,{component:"span",size:"xs",fw:600,children:String(n)})]},t)}):(0,i.jsx)(h.v.Item,{styles:{item:{fontSize:12}},children:(0,i.jsx)(o.Text,{size:"xs",c:"dimmed",children:"No stats available"})})})]})]})]}),(0,i.jsx)(a.Box,{children:(0,i.jsxs)(r.Group,{gap:"xs",children:[(null===(b=k.session)||void 0===b?void 0:b.status)=="ACTIVE"&&(0,i.jsx)(ed.$,{}),(0,i.jsx)(ei.Z,{doctorChamberId:(null===($=k.session)||void 0===$?void 0:$.doctorChamberId)||"",slotId:(null===(C=k.session)||void 0===C?void 0:C.slotId)||"",date:(null===(M=k.session)||void 0===M?void 0:M.date)||"",refetch:D}),(0,i.jsx)(d.u,{label:"Refresh queue",children:(0,i.jsx)(p.A,{variant:"outline",color:"blue",size:"md",onClick:D,children:(0,i.jsx)(g.Z,{size:14})})})]})})]}),(0,i.jsx)(v.Divider,{mb:"lg"}),(0,i.jsx)(S.LB,{sensors:Z,onDragEnd:e=>{I(!1),E(e,k,D)},collisionDetection:S.j2,onDragStart:()=>I(!0),children:(0,i.jsxs)(l.Grid,{children:[(0,i.jsx)(l.Grid.Col,{span:{base:12,md:6},children:(0,i.jsxs)(u.Z,{padding:"lg",radius:"md",withBorder:!0,style:{overflow:"initial"},children:[(0,i.jsxs)(r.Group,{mb:"md",children:[(0,i.jsx)(m.k,{variant:"light",color:"green",size:"lg",children:(0,i.jsx)(j.Z,{size:20})}),(0,i.jsxs)(a.Box,{children:[(0,i.jsx)(o.Text,{fw:600,size:"lg",children:"Active Queue"}),(0,i.jsx)(o.Text,{size:"sm",c:"dimmed",children:"Current appointments & available slots"})]})]}),(0,i.jsx)(et,{queue:_,refetch:D,data:k})]})}),(0,i.jsx)(l.Grid.Col,{span:{base:12,md:6},children:(0,i.jsxs)(u.Z,{padding:"lg",radius:"md",withBorder:!0,style:{overflow:"initial"},children:[(0,i.jsxs)(r.Group,{mb:"md",children:[(0,i.jsx)(m.k,{variant:"light",color:"red",size:"lg",children:(0,i.jsx)(y,{size:20})}),(0,i.jsxs)(a.Box,{children:[(0,i.jsx)(o.Text,{fw:600,size:"lg",children:"Missed Queue"}),(0,i.jsx)(o.Text,{size:"sm",c:"dimmed",children:"Patients who missed their appointments"})]})]}),(0,i.jsx)(P,{queue:A,showDropzone:T})]})})]})})]})}},77410:function(e,t,n){"use strict";n.d(t,{L:function(){return o}});var i=n(3287),s=n(12450),r=n(4505);function o(){var e,t,n,o;let a=(0,s.useSearchParams)(),d=null!==(e=null==a?void 0:a.get("doctorChamberId"))&&void 0!==e?e:void 0,l=null!==(t=null==a?void 0:a.get("slotId"))&&void 0!==t?t:void 0,u=null!==(n=null==a?void 0:a.get("date"))&&void 0!==n?n:void 0,c=null!==(o=null==a?void 0:a.get("session"))&&void 0!==o?o:void 0,[h,f]=(0,r.useState)(null),[p,v]=(0,r.useState)(!1);async function m(){try{if(d&&l&&u){let e=await (0,i.Z)(d,l,u);f(e.data||null)}}catch(e){console.log(e),v(!0)}}return(0,r.useEffect)(()=>{m()},[]),{isError:p,refetch:m,data:{sessionName:c||"",queue:(null==h?void 0:h.queue)||[],session:(null==h?void 0:h.session)||null,doctor:(null==h?void 0:h.doctor)||null,stats:(null==h?void 0:h.stats)||[]}}}},22392:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var i=n(72940),s=n(6780),r=n(67732);let o=async e=>{try{let t=await s.default.get("".concat("http://sasthotech.local:5000/api/v1","/appointment/").concat(e),i.FD);return{success:!0,data:t.data.data}}catch(e){if(e instanceof r.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}}},3287:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(72940),s=n(6780),r=n(67732);let o=async function(e,t,n){var o,a;let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;try{let r=(o="http://sasthotech.local:5000/api/v1",void 0===o)?void 0:o.replace("/api/v1","/api/v"+d),a=await s.default.get("".concat(r,"/appointment/queue?doctorChamberId=").concat(e,"&slotId=").concat(t,"&date=").concat(n),i.FD);return{success:!0,data:a.data.data}}catch(e){if(e instanceof r.d7)return{success:!1,data:null===(a=e.response)||void 0===a?void 0:a.data.message};return{success:!1,data:"An error occurred"}}}},65567:function(e,t){var n;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var i={}.hasOwnProperty;function s(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=r(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return s.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)i.call(e,n)&&e[n]&&(t=r(t,n));return t}(n)))}return e}function r(e,t){return t?e?e+" "+t:e+t:e}e.exports?(s.default=s,e.exports=s):void 0!==(n=(function(){return s}).apply(t,[]))&&(e.exports=n)}()},9654:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});let i=(0,n(52165).Z)("outline","plus","Plus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]])},82e3:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});let i=(0,n(52165).Z)("outline","user-check","UserCheck",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4",key:"svg-1"}],["path",{d:"M15 19l2 2l4 -4",key:"svg-2"}]])}},function(e){e.O(0,[1601,2975,3313,9826,4404,3439,7281,7852,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,1166,7967,6029,6306,7698,3583,4193,4890,7125,6625,6004,3231,5980,4572,8624,7135,1321,2893,5320,9175,7402,1744],function(){return e(e.s=93332)}),_N_E=e.O()}]);