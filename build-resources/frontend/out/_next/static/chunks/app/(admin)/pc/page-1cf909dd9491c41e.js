(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4840],{16321:function(e,t,i){Promise.resolve().then(i.bind(i,66311))},60595:function(e,t,i){"use strict";var n=i(42752);i.o(n,"isArray")&&i.d(t,{isArray:function(){return n.isArray}})},66311:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return ec}});var n=i(68328),r=i(7203),s=i(17135),l=i(4505),o=i(75540),a=i(89043),c=i(13822),d=i(46373),u=i(68242),h=i(87967),m=i(55911),x=i(29259),p=i(22041),j=i(22614),g=i(31204),f=i(13916),C=i(76283),v=i(90660),b=i.n(v);let y=()=>{let{data:e,isLoading:t,isError:i}=(0,o.s)(),[r,{isLoading:s}]=(0,o.Nr)(),[v,y]=(0,l.useState)({pcCodeFormat:"numeric",pcCodePrefix:"",pcCodeLength:4,pcCodeStartFrom:1});(0,l.useEffect)(()=>{(null==e?void 0:e.data)&&y({pcCodeFormat:e.data.pcCodeFormat,pcCodePrefix:e.data.pcCodePrefix,pcCodeLength:e.data.pcCodeLength,pcCodeStartFrom:e.data.pcCodeStartFrom})},[e]);let w=async e=>{e.preventDefault();try{await r(v).unwrap(),b().fire("Success","PC code settings updated successfully!","success")}catch(e){var t;console.error(e),b().fire("Error",(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to update settings","error")}};return t?(0,n.jsx)(a.X,{p:"lg",radius:"md",shadow:"md",pos:"relative",children:(0,n.jsx)(c.f,{visible:!0})}):i?(0,n.jsx)(d.b,{color:"red",title:"Error",icon:(0,n.jsx)(f.Z,{}),children:"Failed to load PC code settings. Please try again."}):(0,n.jsxs)(a.X,{p:"lg",radius:"md",shadow:"md",pos:"relative",children:[(0,n.jsx)(c.f,{visible:s}),(0,n.jsx)(u.Title,{order:3,mb:"md",children:"PC Code Settings"}),(0,n.jsxs)("form",{onSubmit:w,children:[(0,n.jsx)(h.P,{label:"Code Format",placeholder:"Select format",value:v.pcCodeFormat,onChange:e=>y({...v,pcCodeFormat:e}),data:[{value:"numeric",label:"Numeric (0001, 0002, 0003)"},{value:"alphabetic",label:"Alphabetic (A, B, C, ...)"},{value:"mixed",label:"Mixed (PC001, PC002)"},{value:"custom",label:"Custom"}],withAsterisk:!0,mb:"md"}),(0,n.jsx)(m.TextInput,{label:"Prefix (Optional)",placeholder:"e.g., PC-, REF-, or leave empty",value:v.pcCodePrefix,onChange:e=>y({...v,pcCodePrefix:e.target.value}),description:"Text to prepend to each code",mb:"md"}),"alphabetic"!==v.pcCodeFormat&&(0,n.jsx)(x.Y,{label:"Code Length",placeholder:"Enter length",value:v.pcCodeLength,onChange:e=>y({...v,pcCodeLength:Number(e)||4}),min:1,max:10,description:"Number of digits for padding (1-10)",withAsterisk:!0,mb:"md"}),(0,n.jsx)(x.Y,{label:"Start From",placeholder:"Enter starting number",value:v.pcCodeStartFrom,onChange:e=>y({...v,pcCodeStartFrom:Number(e)||1}),min:1,description:"Starting number for the sequence",withAsterisk:!0,mb:"md"}),(0,n.jsxs)(d.b,{icon:(0,n.jsx)(f.Z,{}),color:"blue",mb:"md",children:[(0,n.jsx)(p.Text,{size:"sm",fw:500,mb:4,children:"Preview:"}),(0,n.jsx)(p.Text,{size:"sm",c:"dimmed",children:(()=>{let{pcCodeFormat:e,pcCodePrefix:t,pcCodeLength:i,pcCodeStartFrom:n}=v;switch(e){case"numeric":let r=n.toString().padStart(i,"0"),s=(n+1).toString().padStart(i,"0"),l=(n+2).toString().padStart(i,"0");return"".concat(t).concat(r,", ").concat(t).concat(s,", ").concat(t).concat(l);case"alphabetic":let o=e=>{let t="";for(;e>0;)t=String.fromCharCode(65+(e-1)%26)+t,e=Math.floor((e-1)/26);return t};return"".concat(t).concat(o(n),", ").concat(t).concat(o(n+1),", ").concat(t).concat(o(n+2));case"mixed":case"custom":let a=n.toString().padStart(i,"0"),c=(n+1).toString().padStart(i,"0");return"".concat(t).concat(a,", ").concat(t).concat(c);default:return""}})()})]}),(0,n.jsx)(j.Group,{justify:"flex-end",children:(0,n.jsx)(g.Button,{type:"submit",leftSection:(0,n.jsx)(C.Z,{}),loading:s,children:"Save Settings"})})]})]})};var w=i(69019),T=i(16391),S=i(81209),P=i(32451),A=i(54632),B=i(3741),E=i(12697),k=i(9654),N=i(6180),F=i(23583),Z=i(10713),z=i(25499);let I=e=>{var t;let{onSuccess:i}=e,[r,{isLoading:s}]=(0,o.pL)(),c=(0,z.C)(e=>e.auth.user),d=(null==c?void 0:c.role)==="marketer",{data:h,isSuccess:m}=(0,w.B)({});(0,l.useEffect)(()=>{m&&(console.log("BulkCreate - Groups loaded:",h),console.log("Is Marketer:",d,"User ID:",null==c?void 0:c.id))},[m,h,d,null==c?void 0:c.id]);let x=(null==h?void 0:null===(t=h.data)||void 0===t?void 0:t.items)||(Array.isArray(null==h?void 0:h.data)?h.data:[])||[],[p,f]=(0,l.useState)(!0),v=async e=>{if(e.pcs.filter(e=>!e.name.trim()).length>0){b().fire("Validation Error","All PCs must have a name","error");return}let t={pcs:e.pcs.map(e=>{var t,i;return{...e,pcCode:(null===(t=e.pcCode)||void 0===t?void 0:t.trim())||void 0,mobile:(null===(i=e.mobile)||void 0===i?void 0:i.trim())||void 0,percentage:e.percentage||void 0}}),pcGroupId:e.pcGroupId,autoGenerateCodes:p};try{let e=await r(t).unwrap();b().fire("Success","Successfully created ".concat(e.data.length," PCs!"),"success"),i&&i()}catch(t){var n;console.error(t);let e=(null==t?void 0:null===(n=t.data)||void 0===n?void 0:n.message)||"Failed to create PCs. Please try again.";b().fire("Error",e,"error")}};return(0,n.jsxs)(a.X,{p:"lg",radius:"md",shadow:"md",children:[(0,n.jsx)(u.Title,{order:3,mb:"md",children:"Bulk Create PCs"}),(0,n.jsx)(F.J9,{enableReinitialize:!0,initialValues:{pcs:[{name:"",pcCode:"",mobile:"",percentage:void 0}],pcGroupId:1===x.length?x[0].id:"",pcGroupName:1===x.length?x[0].name:""},onSubmit:v,children:e=>{let{values:t}=e;return(0,n.jsxs)(F.l0,{children:[(0,n.jsxs)(T.k,{justify:"space-between",align:"center",mb:"md",gap:"md",children:[(0,n.jsx)(S.r,{label:"Auto-generate PC codes",checked:p,onChange:e=>f(e.currentTarget.checked)}),(0,n.jsx)(P.Box,{style:{flex:1,maxWidth:300},children:(0,n.jsx)(N.Z,{label:!1,pcGroups:x})})]}),(0,n.jsx)(P.Box,{style:{overflowX:"auto"},children:(0,n.jsx)(F.F2,{name:"pcs",children:e=>{let{push:i,remove:r}=e;return(0,n.jsxs)(A.i,{verticalSpacing:"sm",children:[(0,n.jsx)(A.i.Thead,{children:(0,n.jsxs)(A.i.Tr,{children:[(0,n.jsx)(A.i.Th,{children:"Name *"}),(0,n.jsx)(A.i.Th,{children:"PC Code"}),(0,n.jsx)(A.i.Th,{children:"Mobile"}),(0,n.jsx)(A.i.Th,{children:"Commission %"}),(0,n.jsx)(A.i.Th,{style:{width:50},children:"Actions"})]})}),(0,n.jsx)(A.i.Tbody,{children:t.pcs.map((e,i)=>(0,n.jsxs)(A.i.Tr,{children:[(0,n.jsx)(A.i.Td,{children:(0,n.jsx)(Z.Z,{name:"pcs.".concat(i,".name"),placeholder:"Enter PC name",mt:0,withAsterisk:!0})}),(0,n.jsx)(A.i.Td,{children:(0,n.jsx)(Z.Z,{name:"pcs.".concat(i,".pcCode"),placeholder:p?"Auto-generate":"Enter code",mt:0,disabled:p})}),(0,n.jsx)(A.i.Td,{children:(0,n.jsx)(Z.Z,{name:"pcs.".concat(i,".mobile"),placeholder:"01XXXXXXXXX",mt:0})}),(0,n.jsx)(A.i.Td,{children:(0,n.jsx)(Z.Z,{name:"pcs.".concat(i,".percentage"),placeholder:"10.5",type:"number",mt:0,min:0,max:100,step:"0.01"})}),(0,n.jsx)(A.i.Td,{children:(0,n.jsx)(B.A,{color:"red",variant:"light",size:"lg",onClick:()=>{t.pcs.length>1?r(i):b().fire("Warning","At least one PC is required","warning")},children:(0,n.jsx)(E.Z,{size:18})})})]},i))})]})}})}),(0,n.jsxs)(j.Group,{justify:"space-between",mt:"md",children:[(0,n.jsx)(F.F2,{name:"pcs",children:e=>{let{push:t}=e;return(0,n.jsx)(g.Button,{variant:"light",leftSection:(0,n.jsx)(k.Z,{size:18}),onClick:()=>t({name:"",pcCode:"",mobile:"",percentage:void 0}),type:"button",children:"Add Row"})}}),(0,n.jsx)(g.Button,{type:"submit",leftSection:(0,n.jsx)(C.Z,{size:18}),loading:s,children:"Create All PCs"})]})]})}})]})};var L=i(70748);let G=e=>{let{onSuccess:t}=e,[i,{isLoading:r}]=(0,o.hC)(),s=async()=>{if((await b().fire({title:"Assign Codes to PCs?",text:"This will assign codes to all PCs without codes. Continue?",icon:"question",showCancelButton:!0,confirmButtonColor:"#228be6",confirmButtonText:"Yes, assign codes",focusCancel:!0})).isConfirmed)try{let e=await i().unwrap();e.data.assigned>0?(b().fire("Success","Successfully assigned codes to ".concat(e.data.assigned," PCs!"),"success"),t&&t(e.data.assigned)):b().fire("Info","All PCs already have codes.","info")}catch(t){var e;console.error(t),b().fire("Error",(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to assign codes. Please try again.","error")}};return(0,n.jsx)(g.Button,{variant:"light",leftSection:(0,n.jsx)(L.Z,{}),onClick:s,loading:r,children:"Bulk Assign PC Codes"})};var M=i(22975),R=i(11114),O=i(43495),X=i(50430),U=i(79629);let W=e=>{var t,i;let{onSuccess:r}=e,[s,a]=(0,l.useState)(!1),[u,{data:h,isLoading:m}]=(0,o.js)(),[x,{isLoading:f}]=(0,o.Vi)(),C=async()=>{try{await u().unwrap(),a(!0)}catch(t){var e;console.error(t),b().fire("Error",(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to load preview","error")}},v=async()=>{if((null==h?void 0:h.data)&&(await b().fire({title:"⚠️ CRITICAL WARNING",html:'\n        <div style="text-align: left;">\n          <p><strong>This will update '.concat(h.data.pcsToChange,' PC codes!</strong></p>\n          <p><strong>Consequences:</strong></p>\n          <ul style="margin-left: 20px;">\n            <li>Old codes in bills/reports will become outdated</li>\n            <li>This action CANNOT be automatically undone</li>\n            <li>Historical records will reference old codes</li>\n          </ul>\n          <p style="margin-top: 15px;"><strong>Have you backed up your data?</strong></p>\n          <p style="margin-top: 10px; color: #d9534f;">Type <strong>YES</strong> in the input below to confirm.</p>\n        </div>\n      '),icon:"warning",input:"text",inputPlaceholder:"Type YES to confirm",showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:"Sync Codes",cancelButtonText:"Cancel",preConfirm:e=>"YES"===e||(b().showValidationMessage("You must type YES exactly to confirm"),!1)})).isConfirmed)try{let e=await x().unwrap(),t=JSON.stringify(e.data.codeMapping,null,2),i=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(i),s=document.createElement("a");s.href=n,s.download="pc-code-mapping-".concat(Date.now(),".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n),b().fire({title:"Success",html:"\n          Successfully synced ".concat(e.data.synced," PC codes!<br/>\n          <small>Code mapping has been downloaded for your records.</small>\n        "),icon:"success"}),a(!1),r&&r(e.data.synced)}catch(t){var e;console.error(t),b().fire("Error",(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to sync codes","error")}},y=null==h?void 0:h.data;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.Button,{variant:"light",color:"orange",leftSection:(0,n.jsx)(X.Z,{}),onClick:C,loading:m,children:"Sync All Codes to New Format"}),(0,n.jsx)(M.u,{opened:s,onClose:()=>a(!1),title:"Sync PC Codes - Preview",size:"xl",children:(0,n.jsxs)(P.Box,{pos:"relative",children:[(0,n.jsx)(c.f,{visible:f}),y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.b,{icon:(0,n.jsx)(U.Z,{}),title:"Warning",color:"red",mb:"md",children:"This action will update ALL PC codes and cannot be automatically undone!"}),(0,n.jsxs)(P.Box,{mb:"md",children:[(0,n.jsx)(p.Text,{fw:700,mb:"xs",children:"Summary"}),(0,n.jsxs)(j.Group,{children:[(0,n.jsxs)(R.C,{size:"lg",color:"blue",children:["Total PCs: ",y.totalPCs]}),(0,n.jsxs)(R.C,{size:"lg",color:"orange",children:["Will change: ",y.pcsToChange]}),(0,n.jsxs)(R.C,{size:"lg",color:"gray",children:["Unchanged: ",y.pcsUnchanged]})]})]}),(0,n.jsxs)(P.Box,{mb:"md",children:[(0,n.jsx)(p.Text,{fw:700,mb:"xs",children:"Current Settings"}),(0,n.jsxs)(p.Text,{size:"sm",children:[(0,n.jsx)("strong",{children:"Format:"})," ",y.currentSettings.pcCodeFormat,(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Prefix:"})," ",y.currentSettings.pcCodePrefix||"(none)",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Length:"})," ",y.currentSettings.pcCodeLength]})]}),(0,n.jsxs)(P.Box,{mb:"md",children:[(0,n.jsx)(p.Text,{fw:700,mb:"xs",children:"Preview Changes (first 10)"}),(0,n.jsx)(P.Box,{style:{maxHeight:"300px",overflowY:"auto"},children:(0,n.jsxs)(A.i,{striped:!0,highlightOnHover:!0,children:[(0,n.jsx)(A.i.Thead,{children:(0,n.jsxs)(A.i.Tr,{children:[(0,n.jsx)(A.i.Th,{children:"PC Name"}),(0,n.jsx)(A.i.Th,{children:"Old Code"}),(0,n.jsx)(A.i.Th,{}),(0,n.jsx)(A.i.Th,{children:"New Code"})]})}),(0,n.jsx)(A.i.Tbody,{children:y.preview.slice(0,10).map(e=>(0,n.jsxs)(A.i.Tr,{bg:e.willChange?"orange.0":void 0,children:[(0,n.jsx)(A.i.Td,{children:e.name}),(0,n.jsx)(A.i.Td,{children:(0,n.jsx)(R.C,{color:"gray",children:e.oldCode})}),(0,n.jsx)(A.i.Td,{children:"→"}),(0,n.jsx)(A.i.Td,{children:(0,n.jsx)(R.C,{color:e.willChange?"orange":"gray",children:e.newCode})})]},e.id))})]})}),(null==y?void 0:null===(t=y.preview)||void 0===t?void 0:t.length)>10&&(0,n.jsxs)(p.Text,{size:"sm",c:"dimmed",mt:"xs",children:["... and ",y.preview.length-10," more PCs"]})]}),(0,n.jsxs)(d.b,{icon:(0,n.jsx)(U.Z,{}),color:"red",mb:"md",children:[(0,n.jsx)(p.Text,{fw:700,mb:"xs",children:"Before proceeding:"}),(0,n.jsx)(O.a,{size:"sm",children:null==y?void 0:null===(i=y.warnings)||void 0===i?void 0:i.map((e,t)=>(0,n.jsx)(O.a.Item,{children:e},t))})]}),(0,n.jsxs)(j.Group,{justify:"flex-end",children:[(0,n.jsx)(g.Button,{variant:"default",onClick:()=>a(!1),children:"Cancel"}),(0,n.jsxs)(g.Button,{color:"red",onClick:v,loading:f,disabled:0===y.pcsToChange,children:["Sync ",y.pcsToChange," Codes"]})]})]})]})})]})};var Y=i(13342),q=i(46557),H=i(44019),_=i(42204),D=i(25091),V=i(57315),J=i(34499),Q=i(94131),K=i(38156),$=i(86083),ee=i(72375),et=i(62471),ei=i(72875),en=i(92557),er=i(9722),es=i(7965),el=e=>{let{data:t,selected:i,setSelected:r}=e;return(0,n.jsx)(ei.Z.Item,{children:(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,n.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,n.jsx)("span",{className:"pe-2",children:(0,n.jsx)(es.Z,{})}),(0,n.jsx)(er.I,{placeholder:"PC Name",value:t.name,required:!0,error:""===t.name,onChange:e=>r([...i.map(i=>i.id===t.id?{...i,name:e.target.value}:i)]),style:{minWidth:"200px"}})]}),(0,n.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,n.jsx)(er.I,{placeholder:"PC Code",value:t.pcCode,onChange:e=>r([...i.map(i=>i.id===t.id?{...i,pcCode:e.target.value}:i)]),style:{minWidth:"120px"}}),(0,n.jsx)(er.I,{placeholder:"Mobile",value:t.mobile,onChange:e=>r([...i.map(i=>i.id===t.id?{...i,mobile:e.target.value}:i)]),style:{minWidth:"150px"}}),(0,n.jsx)(g.Button,{size:"xs",className:"mx-1",color:"red",onClick:()=>r([...i.filter(e=>e.id!==t.id)]),children:(0,n.jsx)(E.Z,{})})]})]})})},eo=i(9326),ea=e=>{var t;let{modals:i,onSuccess:r}=e,s=(0,l.useRef)(null),[a,c]=(0,l.useState)([]),[u,h]=(0,et.I)({key:"importPCs-autoGenerateCodes",defaultValue:!0}),[m,{isLoading:x}]=(0,o.pL)(),p=(0,z.C)(e=>e.auth.user),f=(null==p?void 0:p.role)==="marketer",{data:C,isSuccess:v}=(0,w.B)({});(0,l.useEffect)(()=>{v&&(console.log("Groups loaded:",C),console.log("Is Marketer:",f,"User ID:",null==p?void 0:p.id))},[v,C,f,null==p?void 0:p.id]);let y=(null==C?void 0:null===(t=C.data)||void 0===t?void 0:t.items)||(Array.isArray(null==C?void 0:C.data)?C.data:[])||[],T=async e=>{c([]),e.target.files[0]?(0,en.Z)(e.target.files[0]).then(e=>{if(0===e.length){b().fire({title:"Error",text:"Excel file is empty",icon:"error"});return}let t=e[0].map(e=>String(e||"").toLowerCase().trim()),i=["pc name","pc code","mobile"].some(e=>t.some(t=>t.includes(e))),n={},r=0;if(i?(t.forEach((e,t)=>{e.includes("name")?n.name=t:e.includes("code")?n.pcCode=t:(e.includes("mobile")||e.includes("phone"))&&(n.mobile=t)}),r=1):(n={name:0,pcCode:1,mobile:2},r=0),void 0===n.name){b().fire({title:"Error",text:"Could not find 'PC Name' column in Excel file",icon:"error"});return}let s=e.slice(r).map((e,t)=>({id:"".concat(t),name:e[n.name]?String(e[n.name]):"",pcCode:void 0!==n.pcCode&&e[n.pcCode]?String(e[n.pcCode]):"",mobile:void 0!==n.mobile&&e[n.mobile]?String(e[n.mobile]):""})).filter(e=>""!==e.name.trim());if(0===s.length){b().fire({title:"Error",text:"No valid data found in Excel file",icon:"error"});return}c(s)}).catch(e=>{console.error("Error reading Excel file:",e),b().fire({title:"Error",text:"Failed to read Excel file. Please check the file format.",icon:"error"})}):s.current.value=null},S=async e=>{if(a.filter(e=>!e.name.trim()).length>0){b().fire({title:"Error",text:"All PCs must have a name",icon:"error"});return}let t={pcs:a.map(e=>({name:e.name.trim(),pcCode:e.pcCode.trim()||void 0,mobile:e.mobile.trim()||void 0})),pcGroupId:e.pcGroupId||void 0,autoGenerateCodes:u};try{let e=await m(t).unwrap();i&&i.closeAll&&i.closeAll(),b().fire({title:"Import Completed",text:"Successfully created ".concat(e.data.length," PCs"),icon:"success"}),c([]),r&&r()}catch(e){var n;b().fire({title:"Error",text:(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.message)||"Failed to import PCs",icon:"error"})}};return(0,n.jsx)("div",{children:0===a.length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.b,{icon:(0,n.jsx)(eo.Z,{}),title:"Excel File Format",color:"blue",mb:"md",children:[(0,n.jsxs)("p",{children:["The file must be ",(0,n.jsx)("b",{children:".xlsx"})," format with the following column headers:"]}),(0,n.jsxs)("ol",{style:{marginBottom:0},children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"PC Name"})," or ",(0,n.jsx)("b",{children:"Name"})," (Required)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"PC Code"})," or ",(0,n.jsx)("b",{children:"Code"})," (Optional - will auto-generate if empty)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"Mobile"})," or ",(0,n.jsx)("b",{children:"Phone"})," (Optional)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"PC Group"})," (Optional)"]})]}),(0,n.jsxs)("p",{style:{marginTop:"8px",marginBottom:0,fontSize:"0.9em"},children:[(0,n.jsx)("b",{children:"Note:"})," Column headers are flexible and will be matched by name. Extra columns will be ignored."]})]}),(0,n.jsxs)("div",{className:"pt-4 d-flex justify-content-center",children:[(0,n.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>T(e),className:"d-none",ref:s}),(0,n.jsx)(g.Button,{onClick:()=>{var e;return null==s?void 0:null===(e=s.current)||void 0===e?void 0:e.click()},leftSection:(0,n.jsx)(V.Z,{}),size:"md",children:"Upload Excel File"})]})]}):(0,n.jsx)(F.J9,{enableReinitialize:!0,initialValues:{pcGroupId:1===y.length?y[0].id:"",pcGroupName:1===y.length?y[0].name:""},onSubmit:S,children:e=>{let{values:t}=e;return(0,n.jsxs)(F.l0,{children:[(0,n.jsxs)("div",{className:"py-4",children:[(0,n.jsxs)("span",{className:"d-block fs-5 mb-3",children:["PCs imported: ",(0,n.jsx)("b",{children:a.length})]}),(0,n.jsx)(ei.Z,{style:{maxHeight:"400px",overflowY:"auto"},children:a.map((e,t)=>(0,n.jsx)(el,{data:e,selected:a,setSelected:c},t))})]}),(0,n.jsxs)(j.Group,{mb:"md",justify:"space-between",align:"center",children:[(0,n.jsx)(P.Box,{style:{flex:1},children:(0,n.jsx)(ee.X,{checked:u,onChange:e=>h(e.currentTarget.checked),label:"Auto-generate PC codes",description:"If checked, empty codes will be auto-generated"})}),(0,n.jsx)(P.Box,{style:{flex:1,maxWidth:300},children:(0,n.jsx)(N.Z,{label:!1,pcGroups:y})})]}),(0,n.jsxs)("div",{className:"d-flex gap-2",children:[(0,n.jsx)(g.Button,{type:"submit",color:"blue",loading:x,children:"Import PCs"}),(0,n.jsx)(g.Button,{color:"red",onClick:()=>c([]),variant:"light",children:"Clear"})]})]})}})})};function ec(){var e,t,i;let c;let[h,{open:x,close:f}]=(0,q.q)(!1),[C,{open:v,close:w}]=(0,q.q)(!1),[T,{open:S,close:k}]=(0,q.q)(!1),[N,F]=(0,l.useState)(),[Z]=(0,o.db)(),L=(0,z.C)(e=>e.auth.user),O=(null==L?void 0:L.role)==="admin",[X,U]=(0,l.useState)(1),[ee]=(0,l.useState)(10),[et,ei]=(0,l.useState)(""),en=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,[i,n]=(0,l.useState)(e);return(0,l.useEffect)(()=>{let i=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(i)}},[e,t]),i}(et,500),{data:er,isLoading:es,isSuccess:el}=(0,o.JC)({page:X,limit:ee,search:en}),eo=e=>{ei(e),U(1)},ec=(null==er?void 0:null===(e=er.data)||void 0===e?void 0:e.items)||[],ed=(null==er?void 0:null===(t=er.data)||void 0===t?void 0:t.totalPage)||0,eu=(null==er?void 0:null===(i=er.data)||void 0===i?void 0:i.totalItems)||0;return c=es?(0,n.jsx)(r.Z,{}):el?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.i.ScrollContainer,{minWidth:767,children:(0,n.jsxs)(A.i,{layout:"fixed",children:[(0,n.jsx)(A.i.Thead,{children:(0,n.jsx)(A.i.Tr,{children:["PC Code","PC Name","Mobile","Total Commission","Total Paid","Actions"].map((e,t)=>(0,n.jsx)(A.i.Th,{children:e},"".concat(e).concat(t)))})}),(0,n.jsx)(A.i.Tbody,{children:0===ec.length?(0,n.jsx)(A.i.Tr,{children:(0,n.jsx)(A.i.Td,{colSpan:6,style:{textAlign:"center"},children:"No PCs found"})}):ec.map(e=>(0,n.jsxs)(A.i.Tr,{children:[(0,n.jsx)(A.i.Td,{children:e.pcCode?(0,n.jsx)(R.C,{variant:"light",color:"blue",children:e.pcCode}):(0,n.jsx)(R.C,{variant:"light",color:"gray",children:"N/A"})}),(0,n.jsx)(A.i.Td,{children:e.name}),(0,n.jsx)(A.i.Td,{children:e.mobile||"N/A"}),(0,n.jsx)(A.i.Td,{children:e.totalCommission}),(0,n.jsx)(A.i.Td,{children:e.totalPaid}),(0,n.jsx)(A.i.Td,{children:(0,n.jsxs)(j.Group,{children:[(0,n.jsx)(B.A,{variant:"transparent",onClick:()=>{console.log(e,"pc info"),F(e),x()},loading:e.loading,children:(0,n.jsx)(H.Z,{})}),(0,n.jsx)(B.A,{variant:"transparent",onClick:async()=>{if((await b().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#fa5252",confirmButtonText:"Yes, delete it!",focusCancel:!0})).isConfirmed)try{await Z(e.id).unwrap()}catch(e){console.error(e),b().fire("Error","Error","error")}},loading:e.loading,children:(0,n.jsx)(E.Z,{})})]})})]},e.id))})]})}),ed>1&&(0,n.jsxs)(j.Group,{justify:"center",mt:"md",gap:"xs",children:[(0,n.jsx)(g.Button,{variant:"default",size:"sm",leftSection:(0,n.jsx)(_.Z,{size:16}),onClick:()=>U(e=>Math.max(1,e-1)),disabled:1===X,children:"Previous"}),(0,n.jsx)(j.Group,{gap:"xs",children:Array.from({length:ed},(e,t)=>t+1).map(e=>{let t=1===e||e===ed||e>=X-1&&e<=X+1,i=e===X-2&&X>3,r=e===X+2&&X<ed-2;return t||i||r?i||r?(0,n.jsx)(p.Text,{c:"dimmed",size:"sm",children:"..."},e):(0,n.jsx)(g.Button,{variant:X===e?"filled":"default",size:"sm",onClick:()=>U(e),children:e},e):null})}),(0,n.jsx)(g.Button,{variant:"default",size:"sm",rightSection:(0,n.jsx)(D.Z,{size:16}),onClick:()=>U(e=>Math.min(ed,e+1)),disabled:X===ed,children:"Next"})]})]}):(0,n.jsx)(P.Box,{className:"p-3 bg-light p-md-5",ta:"center",children:"An error Occurred"}),(0,n.jsxs)(P.Box,{className:"p-3 bg-light p-md-5",children:[(0,n.jsxs)(j.Group,{mb:"md",children:[(0,n.jsx)(u.Title,{mr:"auto",children:"PC Management"}),O&&(0,n.jsx)(G,{onSuccess:()=>{b().fire("Success","Codes assigned successfully!","success")}}),(0,n.jsx)(g.Button,{variant:"light",leftSection:(0,n.jsx)(V.Z,{}),onClick:S,children:"Import from Excel"}),(0,n.jsx)(g.Button,{variant:"light",leftSection:(0,n.jsx)(J.Z,{}),onClick:v,children:"Bulk Create"}),(0,n.jsx)(g.Button,{size:"md",radius:"md",leftSection:(0,n.jsx)(Q.Z,{}),onClick:()=>{F(void 0),x()},children:"Add New PC"})]}),(0,n.jsxs)(Y.m,{defaultValue:"list",children:[(0,n.jsxs)(Y.m.List,{children:[(0,n.jsx)(Y.m.Tab,{value:"list",children:"PC List"}),O&&(0,n.jsx)(Y.m.Tab,{value:"settings",leftSection:(0,n.jsx)(K.Z,{size:16}),children:"Code Settings"})]}),(0,n.jsx)(Y.m.Panel,{value:"list",pt:"md",children:(0,n.jsxs)(a.X,{bg:"white",p:"lg",radius:"md",shadow:"md",children:[(0,n.jsxs)(j.Group,{mb:"md",justify:"space-between",children:[(0,n.jsx)(m.TextInput,{placeholder:"Search by name, code, or mobile...",leftSection:(0,n.jsx)($.Z,{size:16}),value:et,onChange:e=>eo(e.target.value),style:{flex:1,maxWidth:"400px"}}),(0,n.jsxs)(p.Text,{size:"sm",c:"dimmed",children:["Showing ",ec.length," of ",eu," PCs"]})]}),c]})}),O&&(0,n.jsxs)(Y.m.Panel,{value:"settings",pt:"md",children:[(0,n.jsx)(y,{}),(0,n.jsxs)(a.X,{bg:"white",p:"lg",radius:"md",shadow:"md",mt:"md",children:[(0,n.jsx)(u.Title,{order:4,mb:"md",children:"Sync Existing Codes"}),(0,n.jsx)(d.b,{color:"yellow",mb:"md",children:(0,n.jsxs)(p.Text,{size:"sm",children:[(0,n.jsx)("strong",{children:"Note:"})," Changing settings above only affects new PCs. Use this sync feature if you want to update all existing PC codes to match the new format."]})}),(0,n.jsx)(W,{onSuccess:e=>{console.log("Synced ".concat(e," codes"))}})]})]})]}),(0,n.jsx)(M.u,{opened:h,onClose:f,title:(N?"Edit":"Add New")+" PC",size:"70%",children:(0,n.jsx)(s._,{pc:N,onQueryStarted:f},null==N?void 0:N.id)}),(0,n.jsx)(M.u,{opened:C,onClose:w,title:"Bulk Create PCs",size:"xl",children:(0,n.jsx)(I,{onSuccess:()=>{w()}})}),(0,n.jsx)(M.u,{opened:T,onClose:k,title:"Import PCs from Excel",size:"xl",children:(0,n.jsx)(ea,{onSuccess:()=>{k()}})})]})}},7203:function(e,t,i){"use strict";var n=i(68328),r=i(14587);i(4505),t.Z=()=>(0,n.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:600},children:(0,n.jsx)(r.Loader,{color:"teal",variant:"dots"})})},72940:function(e,t,i){"use strict";i.d(t,{FD:function(){return r},Hn:function(){return n},y4:function(){return s}});let n={headers:{"Content-Type":"application/json"}},r={withCredentials:!0},s={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},78101:function(e,t,i){"use strict";i.d(t,{g:function(){return o}});var n=i(49854),r=i(68240),s=i(94183),l=i(28317);let o=(0,r.LC)({baseQuery:(0,s.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,t)=>fetch(e,t).then(async i=>{let r="string"==typeof e?e:e.url;return r.includes("?")||(null==t?void 0:t.body)||"string"!=typeof e&&e.body||await (0,l.t8)(r,await i.clone().json().catch(()=>null),(0,n.x)()),i}).catch(async i=>{if(i instanceof TypeError){let i="string"==typeof e?e:e.url;if(!i.includes("?")&&!(null==t?void 0:t.body)&&!("string"!=typeof e&&e.body)){let e=await (0,l.U2)(i,(0,n.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw i})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},25499:function(e,t,i){"use strict";i.d(t,{C:function(){return s},T:function(){return r}});var n=i(53502);let r=()=>(0,n.I0)(),s=n.v9},49854:function(e,t,i){"use strict";let n;i.d(t,{d:function(){return c},x:function(){return a}});var r=i(72940),s=i(6780),l=i(67732),o=i(28317);function a(){return n||(n=(0,o.MT)("cached-responses-store","cached-responses")),n}async function c(e,t){try{let i=await s.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...r.FD});return await (0,o.t8)(e,i.data,a()),i.data}catch(t){if(t instanceof l.d7&&[l.d7.ERR_NETWORK,l.d7.ETIMEDOUT].includes(t.code)){let t=await (0,o.U2)(e,a());if(t)return t}throw t instanceof l.d7&&t.response&&401===t.response.status||console.error(t),t}}}},function(e){e.O(0,[1601,2975,7852,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,1166,7967,6306,3583,4193,4927,1493,6129,3204,8954,7135,9175,7402,1744],function(){return e(e.s=16321)}),_N_E=e.O()}]);