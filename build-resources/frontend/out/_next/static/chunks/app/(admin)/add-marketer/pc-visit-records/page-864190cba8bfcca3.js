(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3706],{14473:function(e,t,s){Promise.resolve().then(s.bind(s,15048))},15048:function(e,t,s){"use strict";s.r(t);var i=s(68328),r=s(70150),n=s(68242);s(4505),t.default=()=>(0,i.jsxs)("div",{style:{padding:"30px",minHeight:"100vh"},children:[(0,i.jsx)(n.Title,{order:2,mb:"md",children:"PC Visit Records"}),(0,i.jsx)(r.Z,{isAdmin:!0})]})},70150:function(e,t,s){"use strict";var i=s(68328),r=s(4505),n=s(41224),a=s(48604),d=s(22614),l=s(68242),o=s(31204),c=s(29663),u=s(87967),x=s(14587),h=s(89043),p=s(22041),m=s(32451),g=s(77303),j=s(7140),y=s(22975),v=s(25621),f=s(23138),C=s(11114),T=s(77052),w=s(9286),b=s(37947),P=s(67781),S=s(86083),z=s(42484),k=s(34499),G=s(98073),M=s(29076),Z=s(71140),q=s(29013),D=s(92671),A=s(55168),E=s(75540),L=s(1860),B=s.n(L),N=s(25499);t.Z=e=>{var t,s,L,O;let{isAdmin:U=!1}=e,[I,F]=(0,r.useState)(null),[R,V]=(0,r.useState)(null),[Y,Q]=(0,r.useState)(""),[_,H]=(0,r.useState)(""),[K,X]=(0,r.useState)(1),[J]=(0,r.useState)(12),[W,$]=(0,r.useState)(null),[ee,et]=(0,r.useState)(!1),es=(0,N.C)(e=>e.diagnostic.marketer)||[],{data:ei,isLoading:er}=(0,E.K0)({limit:1e3}),en={startDate:null==I?void 0:I.toISOString(),endDate:null==R?void 0:R.toISOString(),pcId:Y||void 0,...U?{marketerId:_||void 0}:{},page:K,limit:J},ea=(0,A.C_)(en,{skip:!U}),ed=(0,A.H0)(en,{skip:U}),{data:el,isLoading:eo,isError:ec,refetch:eu}=U?ea:ed,ex=(null==el?void 0:el.data)||[],eh=(null==el?void 0:el.pagination)||{totalPages:1,total:0};console.log(ex);let{data:ep,isLoading:em}=(0,A.DM)(W,{skip:!W}),eg=null==ep?void 0:ep.data,ej=e=>{$(e),et(!0)};return(0,i.jsxs)(n.Stack,{gap:"lg",children:[(0,i.jsxs)(a.Z,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,children:[(0,i.jsxs)(d.Group,{justify:"space-between",mb:"xs",children:[(0,i.jsxs)(d.Group,{gap:"xs",children:[(0,i.jsx)(w.Z,{size:18}),(0,i.jsx)(l.Title,{order:4,children:"Filters"})]}),(0,i.jsx)(o.Button,{variant:"subtle",color:"red",size:"xs",leftSection:(0,i.jsx)(b.Z,{size:14}),onClick:()=>{F(null),V(null),Q(""),H(""),X(1)},children:"Clear Filters"})]}),(0,i.jsxs)(c.Grid,{align:"flex-end",children:[(0,i.jsx)(c.Grid.Col,{span:{base:12,sm:6,md:3},children:(0,i.jsx)(T.DatePickerInput,{label:"Start Date",placeholder:"Pick start date",value:I,onChange:e=>{F(e),X(1)},leftSection:(0,i.jsx)(P.Z,{size:18}),clearable:!0})}),(0,i.jsx)(c.Grid.Col,{span:{base:12,sm:6,md:3},children:(0,i.jsx)(T.DatePickerInput,{label:"End Date",placeholder:"Pick end date",value:R,onChange:e=>{V(e),X(1)},leftSection:(0,i.jsx)(P.Z,{size:18}),clearable:!0})}),U&&(0,i.jsx)(c.Grid.Col,{span:{base:12,sm:6,md:3},children:(0,i.jsx)(u.P,{label:"Marketer",placeholder:"Filter by marketer",data:es.map(e=>({value:e.id,label:e.name||e.email})),value:_,onChange:e=>{H(e||""),X(1)},clearable:!0,searchable:!0})}),(0,i.jsx)(c.Grid.Col,{span:{base:12,sm:6,md:3},children:(0,i.jsx)(u.P,{label:"PC",placeholder:"Filter by PC",data:((null==ei?void 0:ei.data)||[]).map(e=>({value:e.id,label:e.pcCode?"".concat(e.name," (").concat(e.pcCode,")"):e.name})),value:Y,onChange:e=>{Q(e||""),X(1)},clearable:!0,searchable:!0,leftSection:er?(0,i.jsx)(x.Loader,{size:"xs"}):(0,i.jsx)(S.Z,{size:18})})})]})]}),eo?(0,i.jsx)(d.Group,{justify:"center",py:"xl",children:(0,i.jsx)(x.Loader,{size:"xl"})}):ec?(0,i.jsxs)(h.X,{shadow:"sm",p:"xl",radius:"md",withBorder:!0,ta:"center",children:[(0,i.jsx)(p.Text,{c:"red",children:"Failed to load PC visits. Please try again."}),(0,i.jsx)(o.Button,{mt:"md",variant:"light",onClick:()=>eu(),children:"Retry"})]}):0===ex.length?(0,i.jsx)(h.X,{shadow:"sm",p:"xl",radius:"md",withBorder:!0,ta:"center",children:(0,i.jsxs)(n.Stack,{align:"center",gap:"xs",children:[(0,i.jsx)(z.Z,{size:48,color:"gray",opacity:.5}),(0,i.jsx)(p.Text,{c:"dimmed",children:"No PC visits found matching your filters."})]})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.Grid,{gutter:"md",children:ex.map(e=>{var t,s,r,o;return(0,i.jsx)(c.Grid.Col,{span:{base:12,sm:6,lg:4},children:(0,i.jsxs)(a.Z,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,style:{cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s"},onClick:()=>ej(e.id),onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=""},children:[(0,i.jsx)(a.Z.Section,{children:(0,i.jsx)(m.Box,{pos:"relative",children:(0,i.jsx)("img",{src:e.imageUrl,alt:"Visit",style:{height:180,width:"100%",objectFit:"cover"},onError:e=>{e.target.src="https://placehold.co/400x200?text=No+Image"}})})}),(0,i.jsxs)(n.Stack,{gap:"xs",mt:"md",children:[(0,i.jsxs)(d.Group,{justify:"space-between",align:"flex-start",children:[(0,i.jsx)(l.Title,{order:5,lineClamp:1,children:(null===(t=e.pc)||void 0===t?void 0:t.name)||"Unknown PC"}),(0,i.jsxs)(p.Text,{size:"xs",c:"green",fw:700,children:["#",null===(s=e.pc)||void 0===s?void 0:s.pcCode]})]}),U&&(0,i.jsxs)(d.Group,{gap:5,wrap:"nowrap",children:[(0,i.jsx)(k.Z,{size:14,color:"gray"}),(0,i.jsxs)(p.Text,{size:"xs",c:"dimmed",children:["Marketer:"," ",(0,i.jsx)("strong",{children:(null===(r=e.marketer)||void 0===r?void 0:r.name)||(null===(o=e.marketer)||void 0===o?void 0:o.email)||"N/A"})]})]}),(0,i.jsx)(g.Divider,{variant:"dashed"}),(0,i.jsxs)(d.Group,{gap:5,wrap:"nowrap",align:"flex-start",children:[(0,i.jsx)(G.Z,{size:16,color:"blue"}),(0,i.jsxs)(m.Box,{style:{flex:1},children:[(0,i.jsxs)(p.Text,{size:"xs",fw:500,lineClamp:1,children:["Location: ",e.userLocation]}),U&&(0,i.jsxs)(p.Text,{size:"xs",lineClamp:1,children:["Device: ",e.deviceLocation]})]})]}),(0,i.jsxs)(d.Group,{gap:5,children:[(0,i.jsx)(P.Z,{size:16,color:"orange"}),(0,i.jsx)(p.Text,{size:"xs",children:B()(e.visitedAt).format("MMM DD, YYYY hh:mm A")})]}),e.note&&"null"!==e.note&&(0,i.jsxs)(d.Group,{gap:5,wrap:"nowrap",align:"flex-start",children:[(0,i.jsx)(M.Z,{size:16,color:"gray"}),(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",lineClamp:2,children:e.note})]}),(0,i.jsx)(g.Divider,{variant:"dashed"}),(0,i.jsxs)(d.Group,{justify:"space-between",children:[(0,i.jsx)(p.Text,{size:"xs",c:"dimmed"}),(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",children:B()(e.createdAt).fromNow()})]})]})]})},e.id)})}),eh.totalPages>1&&(0,i.jsx)(d.Group,{justify:"center",mt:"xl",children:(0,i.jsx)(j.t,{total:eh.totalPages,value:K,onChange:X,color:"green"})})]}),(0,i.jsx)(y.u,{opened:ee,onClose:()=>{et(!1),$(null)},title:(0,i.jsxs)(d.Group,{gap:"xs",children:[(0,i.jsx)(z.Z,{size:20}),(0,i.jsx)(p.Text,{fw:600,children:"PC Visit Details"})]}),size:"lg",centered:!0,children:em?(0,i.jsxs)(n.Stack,{gap:"md",children:[(0,i.jsx)(v.O,{height:250,radius:"md"}),(0,i.jsx)(v.O,{height:20,width:"60%"}),(0,i.jsx)(v.O,{height:15,width:"40%"}),(0,i.jsx)(v.O,{height:100})]}):eg?(0,i.jsxs)(n.Stack,{gap:"md",children:[(0,i.jsx)(m.Box,{style:{borderRadius:"var(--mantine-radius-md)",overflow:"hidden"},children:(0,i.jsx)(f.E,{src:eg.imageUrl,alt:"Visit Image",height:280,fit:"cover",fallbackSrc:"https://placehold.co/600x300?text=No+Image"})}),(0,i.jsxs)(a.Z,{withBorder:!0,padding:"sm",radius:"md",bg:"gray.0",children:[(0,i.jsxs)(d.Group,{justify:"space-between",align:"flex-start",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)(d.Group,{gap:"xs",mb:4,children:[(0,i.jsx)(Z.Z,{size:18,color:"var(--mantine-color-blue-6)"}),(0,i.jsx)(l.Title,{order:4,children:(null===(t=eg.pc)||void 0===t?void 0:t.name)||"Unknown PC"})]}),(null===(s=eg.pc)||void 0===s?void 0:s.pcCode)&&(0,i.jsxs)(C.C,{color:"green",variant:"light",size:"sm",children:["Code: ",eg.pc.pcCode]})]}),(null===(L=eg.pc)||void 0===L?void 0:L.phone)&&(0,i.jsxs)(d.Group,{gap:4,children:[(0,i.jsx)(q.Z,{size:14}),(0,i.jsx)(p.Text,{size:"sm",children:eg.pc.phone})]})]}),(null===(O=eg.pc)||void 0===O?void 0:O.address)&&(0,i.jsxs)(p.Text,{size:"sm",c:"dimmed",mt:"xs",children:[(0,i.jsx)(G.Z,{size:14,style:{display:"inline",marginRight:4}}),eg.pc.address]})]}),eg.marketer&&(0,i.jsxs)(a.Z,{withBorder:!0,padding:"sm",radius:"md",children:[(0,i.jsxs)(d.Group,{gap:"xs",mb:"xs",children:[(0,i.jsx)(k.Z,{size:18,color:"var(--mantine-color-violet-6)"}),(0,i.jsx)(p.Text,{fw:600,children:"Marketer Information"})]}),(0,i.jsxs)(d.Group,{gap:"lg",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",children:"Name"}),(0,i.jsx)(p.Text,{size:"sm",fw:500,children:eg.marketer.name||"N/A"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",children:"Email"}),(0,i.jsx)(p.Text,{size:"sm",fw:500,children:eg.marketer.email})]})]})]}),U&&(0,i.jsxs)(a.Z,{withBorder:!0,padding:"sm",radius:"md",children:[(0,i.jsxs)(d.Group,{gap:"xs",mb:"xs",children:[(0,i.jsx)(G.Z,{size:18,color:"var(--mantine-color-teal-6)"}),(0,i.jsx)(p.Text,{fw:600,children:"Location Details"})]}),(0,i.jsxs)(n.Stack,{gap:"xs",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",children:"User Location"}),(0,i.jsx)(p.Text,{size:"sm",children:eg.userLocation||"Not available"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",children:"Device Location"}),(0,i.jsx)(p.Text,{size:"sm",children:eg.deviceLocation||"Not available"})]})]})]}),(0,i.jsxs)(a.Z,{withBorder:!0,padding:"sm",radius:"md",children:[(0,i.jsxs)(d.Group,{gap:"xs",mb:"xs",children:[(0,i.jsx)(D.Z,{size:18,color:"var(--mantine-color-orange-6)"}),(0,i.jsx)(p.Text,{fw:600,children:"Visit Information"})]}),(0,i.jsxs)(n.Stack,{gap:"xs",children:[(0,i.jsx)(d.Group,{gap:"lg",children:(0,i.jsxs)("div",{children:[(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",children:"Visited At"}),(0,i.jsx)(p.Text,{size:"sm",fw:500,children:B()(eg.visitedAt).format("MMMM DD, YYYY hh:mm A")})]})}),eg.note&&"null"!==eg.note&&(0,i.jsxs)("div",{children:[(0,i.jsxs)(d.Group,{gap:"xs",mb:4,children:[(0,i.jsx)(M.Z,{size:14}),(0,i.jsx)(p.Text,{size:"xs",c:"dimmed",children:"Note"})]}),(0,i.jsx)(p.Text,{size:"sm",style:{whiteSpace:"pre-wrap"},children:eg.note})]})]})]})]}):(0,i.jsx)(p.Text,{c:"dimmed",ta:"center",py:"xl",children:"No details available for this visit."})})]})}},72940:function(e,t,s){"use strict";s.d(t,{FD:function(){return r},Hn:function(){return i},y4:function(){return n}});let i={headers:{"Content-Type":"application/json"}},r={withCredentials:!0},n={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},55168:function(e,t,s){"use strict";s.d(t,{C_:function(){return n},DM:function(){return a},H0:function(){return i},to:function(){return r}});let{useGetPCMeetupQuery:i,useAddPCMeetupMutation:r,useGetPCMeetupAdminQuery:n,useGetPCMeetupByIdQuery:a}=s(78101).g.injectEndpoints({endpoints:e=>({getPCMeetup:e.query({query:e=>({url:"/pcVisit",method:"GET",params:e}),providesTags:["PCMeetup"]}),addPCMeetup:e.mutation({query:e=>({url:"/pcVisit",method:"POST",body:e}),invalidatesTags:["PCMeetup"]}),getPCMeetupAdmin:e.query({query:e=>({url:"/pcVisit/admin",method:"GET",params:e}),providesTags:["PCMeetup"]}),getPCMeetupById:e.query({query:e=>({url:"/pcVisit/".concat(e),method:"GET"}),providesTags:["PCMeetup"]})})})},78101:function(e,t,s){"use strict";s.d(t,{g:function(){return d}});var i=s(49854),r=s(68240),n=s(94183),a=s(28317);let d=(0,r.LC)({baseQuery:(0,n.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,t)=>fetch(e,t).then(async s=>{let r="string"==typeof e?e:e.url;return r.includes("?")||(null==t?void 0:t.body)||"string"!=typeof e&&e.body||await (0,a.t8)(r,await s.clone().json().catch(()=>null),(0,i.x)()),s}).catch(async s=>{if(s instanceof TypeError){let s="string"==typeof e?e:e.url;if(!s.includes("?")&&!(null==t?void 0:t.body)&&!("string"!=typeof e&&e.body)){let e=await (0,a.U2)(s,(0,i.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw s})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},25499:function(e,t,s){"use strict";s.d(t,{C:function(){return n},T:function(){return r}});var i=s(53502);let r=()=>(0,i.I0)(),n=i.v9},75540:function(e,t,s){"use strict";s.d(t,{JC:function(){return a},K0:function(){return n},Nr:function(){return h},Uc:function(){return c},Vi:function(){return y},db:function(){return o},ey:function(){return l},fR:function(){return d},h2:function(){return u},hC:function(){return m},js:function(){return j},pL:function(){return p},s:function(){return x}});var i=s(78101);let r=i.g.injectEndpoints({endpoints:e=>({getPCs:e.query({query:e=>{let{page:t=1,limit:s=10,search:i=""}=e||{},r=new URLSearchParams;return r.append("page",t.toString()),r.append("limit",s.toString()),i&&r.append("search",i),{url:"/pc?".concat(r.toString())}},keepUnusedDataFor:60}),getPCsPaginated:e.query({query:e=>{let{page:t=1,limit:s=10,search:i=""}=e||{},r=new URLSearchParams;return r.append("page",t.toString()),r.append("limit",s.toString()),i&&r.append("search",i),{url:"/pc/paginated?".concat(r.toString())}},keepUnusedDataFor:60}),createPC:e.mutation({query:e=>({url:"/pc",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:s,queryFulfilled:r}=t;try{await r,s(i.g.util.invalidateTags(["PC"]))}catch(e){}}}),updatePC:e.mutation({query:e=>{let{id:t,name:s,percentage:i,fathersName:r,mobile:n,thana:a,address:d,district:l}=e;return{url:"/pc/".concat(t),method:"PATCH",body:{name:s,percentage:i,fathersName:r,mobile:n,thana:a,address:d,district:l}}},async onQueryStarted(e,t){let{dispatch:s,queryFulfilled:r}=t;try{await r,s(i.g.util.invalidateTags(["PC"]))}catch(e){}}}),deletePC:e.mutation({query:e=>({url:"/pc/".concat(e),method:"DELETE"}),async onQueryStarted(e,t){let{dispatch:s,queryFulfilled:r}=t;try{await r,s(i.g.util.invalidateTags(["PC"]))}catch(e){}}}),getSinglePC:e.query({query:e=>({url:"/pc/".concat(e)})}),getSinglePCTests:e.query({query:e=>({url:"/pc/".concat(e,"/tests")})}),getPCCodeSettings:e.query({query:()=>({url:"/diagnostic/pc-code-settings"})}),updatePCCodeSettings:e.mutation({query:e=>({url:"/diagnostic/pc-code-settings",method:"PATCH",body:e}),async onQueryStarted(e,t){let{dispatch:s,queryFulfilled:i}=t;try{let{data:e}=await i;s(r.util.updateQueryData("getPCCodeSettings",void 0,t=>{Object.assign(t.data,e.data)}))}catch(e){}}}),bulkCreatePCs:e.mutation({query:e=>({url:"/pc/bulk-create",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:s,queryFulfilled:r}=t;try{await r,s(i.g.util.invalidateTags(["PC"]))}catch(e){}}}),bulkAssignCodes:e.mutation({query:()=>({url:"/pc/bulk-assign-codes",method:"POST"}),async onQueryStarted(e,t){let{dispatch:s,queryFulfilled:r}=t;try{await r,s(i.g.util.invalidateTags(["PC"]))}catch(e){}}}),previewSyncCodes:e.query({query:()=>({url:"/pc/sync-codes/preview"})}),syncCodes:e.mutation({query:()=>({url:"/pc/sync-codes",method:"POST"}),async onQueryStarted(e,t){let{dispatch:s,queryFulfilled:r}=t;try{await r,s(i.g.util.invalidateTags(["PC"]))}catch(e){}}})})}),{useGetPCsQuery:n,useGetPCsPaginatedQuery:a,useCreatePCMutation:d,useUpdatePCMutation:l,useDeletePCMutation:o,useGetSinglePCQuery:c,useGetSinglePCTestsQuery:u,useGetPCCodeSettingsQuery:x,useUpdatePCCodeSettingsMutation:h,useBulkCreatePCsMutation:p,useBulkAssignCodesMutation:m,usePreviewSyncCodesQuery:g,useLazyPreviewSyncCodesQuery:j,useSyncCodesMutation:y}=r},49854:function(e,t,s){"use strict";let i;s.d(t,{d:function(){return o},x:function(){return l}});var r=s(72940),n=s(6780),a=s(67732),d=s(28317);function l(){return i||(i=(0,d.MT)("cached-responses-store","cached-responses")),i}async function o(e,t){try{let s=await n.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...r.FD});return await (0,d.t8)(e,s.data,l()),s.data}catch(t){if(t instanceof a.d7&&[a.d7.ERR_NETWORK,a.d7.ETIMEDOUT].includes(t.code)){let t=await (0,d.U2)(e,l());if(t)return t}throw t instanceof a.d7&&t.response&&401===t.response.status||console.error(t),t}}}},function(e){e.O(0,[1601,748,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,1166,7967,7186,1493,9669,7140,4083,9175,7402,1744],function(){return e(e.s=14473)}),_N_E=e.O()}]);