(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1720],{73130:function(e,t,i){Promise.resolve().then(i.bind(i,10278))},71149:function(e,t,i){"use strict";i.d(t,{AN:function(){return c},HG:function(){return a},J7:function(){return s},UA:function(){return d},dB:function(){return m},ev:function(){return o},q:function(){return u},tK:function(){return r}});var l=i(62471),n=i(4505);let s=["A4 portrait","A5 portrait","A4 landscape"],o=[["outdoor-bill","A5 portrait",60],["indoor-bill","A4 portrait",60,void 0,120],["indoor-admission-form","A4 portrait",90,"isHospitalManagement",120],["outdoor-summary","A4 portrait",90],["indoor-summary","A4 portrait",90,"isHospitalManagement"],["receptionist-summary","A4 portrait",90],["pc-payment","A5 portrait",60]];function a(e){let t=(0,n.useMemo)(()=>o.find(t=>t[0]===e),[e]),[i]=(0,l.I)({key:"".concat(e,"-print-page-size"),defaultValue:null==t?void 0:t[1]}),[s]=(0,l.I)({key:"".concat(e,"-print-page-scale"),defaultValue:null==t?void 0:t[2]});return"\n    @page { size: ".concat(i,";margin:10px 0px; }\n    :root { --mantine-scale: ").concat(+s/100,"; }\n    .fs-1{font-size:calc(var(--mantine-scale) * calc(1.375rem + 1.5vw))!important}\n    .fs-2{font-size:calc(var(--mantine-scale) * calc(1.325rem + .9vw))!important}\n    .fs-3{font-size:calc(var(--mantine-scale) * calc(1.3rem + .6vw))!important}\n    .fs-4{font-size:calc(var(--mantine-scale) * calc(1.275rem + .3vw))!important}\n    .fs-5{font-size:calc(var(--mantine-scale) * 1.25rem)!important}\n    .fs-6{font-size:calc(var(--mantine-scale) * 1rem)!important}")}function r(e){var t,i,s;let a=(0,n.useMemo)(()=>o.find(t=>t[0]===e),[e]),[r]=(0,l.I)({key:"".concat(e,"-print-page-height"),defaultValue:null!==(i=null==a?void 0:null===(t=a[4])||void 0===t?void 0:t.toString())&&void 0!==i?i:""});return r?+r:null!==(s=null==a?void 0:a[4])&&void 0!==s?s:100}function d(){let[e]=(0,l.I)({key:"selected-admission-template-id",defaultValue:"1"});return e?+e:1}function c(){let[e]=(0,l.I)({key:"selected-bill-template-id",defaultValue:"1"});return e?+e:1}function u(){let[e]=(0,l.I)({key:"print-watermark-enabled",defaultValue:"true"});return"true"===e}function m(){let[e]=(0,l.I)({key:"selected-appointment-token-template-id",defaultValue:"2"});return e?+e:2}},10278:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return eW}});var l=i(68328),n=i(25499),s=i(41224),o=i(89043),a=i(22614),r=i(58812),d=i(68242),c=i(22041),u=i(31204),m=i(32451),v=i(11114),h=i(29593),p=i(8720),x=i(94131),g=i(25564),f=i(35288),y=i(4013),j=i(13520),C=i(4505),T=i(85872),b=i(70818),P=i(42062),w=i(72940),S=i(6780),I=i(67732);let A=async e=>{let{from:t,to:i,limit:l,page:n,isPaid:s,isCommissionPaid:o,isDoctorCommissionPaid:a,pCId:r,pCIds:d,marketerId:c}=e;try{let e="".concat("http://sasthotech.local:5000/api/v1","/bill/pc?");t&&i&&(e+="from=".concat(t.toISOString(),"&to=").concat(i.toISOString())),l&&n&&(e+="&limit=".concat(l,"&page=").concat(n)),void 0!==s&&(e+="&isPaid=".concat(s)),void 0!==o&&(e+="&isCommissionPaid=".concat(o)),void 0!==a&&(e+="&isDoctorCommissionPaid=".concat(a)),r&&(e+="&pCId=".concat(r)),d&&d.length>0&&d.forEach(t=>e+="&pCIds=".concat(t)),c&&(e+="&marketerId=".concat(c));let u=await S.default.get(e,w.FD);return{success:!0,data:u.data.data}}catch(e){if(e instanceof I.d7){var u;return{success:!1,data:null===(u=e.response)||void 0===u?void 0:u.data.message}}return{success:!1,data:"An error occurred"}}};var B=i(81943),D=i(12450);let k=(e,t,i)=>{let[l,s]=(0,C.useState)(!1),o=(0,D.useSearchParams)();(0,D.useRouter)();let a=(0,n.T)(),r=(0,n.C)(e=>!e.bills.allBills);return(0,C.useEffect)(()=>{(async()=>{s(!0);let i=o.get("from"),l=o.get("to"),n=new Date,r=new Date;r.setHours(0,0,0),n.setHours(23,59,59),(i&&l||e[0])&&(e[0]?((r=new Date(e[0])).setHours(0,0,0),e[1]?(n=new Date(e[1])).setHours(23,59,59):(n=new Date(e[0])).setHours(23,59,59)):i&&l&&(n=new Date(l),r=new Date(i)),e[0]),await z({firstDate:r,finalDate:n,searchParams:o,selectedObject:t,dispatch:a})&&s(!1)})()},[o,t,e,r]),l},z=async e=>{let{firstDate:t,finalDate:i,searchParams:l,selectedObject:n,dispatch:s}=e,o=l.get("pcPaymentStatus"),a=l.get("doctorCommissionFilter"),{success:r,data:d}=await A({from:t,to:new Date(i),limit:parseInt(l.get("limit"))||50,page:parseInt(l.get("page"))||1,isCommissionPaid:"paid"===o||"all"===o&&void 0,isDoctorCommissionPaid:"paid"===a||"unpaid"!==a&&void 0,pCId:null==n?void 0:n.id,pCIds:l.getAll("pCIds"),marketerId:l.get("marketerId")||void 0});return r&&s((0,B.Im)(d)),!0},N=async(e,t)=>{try{let i=await S.default.post("".concat("http://sasthotech.local:5000/api/v1","/commission/pc/").concat(e),t,{...w.FD,...w.Hn});return{success:!0,data:i.data.data}}catch(e){if(e instanceof I.d7){var i;return{success:!1,data:null===(i=e.response)||void 0===i?void 0:i.data.message}}return{success:!1,data:"An error occurred"}}};var M=i(75540),Z=i(58576),F=i(29259),_=i(81209),E=i(78259),R=i(76607),L=i(53502),G=i(90660),O=i.n(G),W=i(75326),V=i.n(W),U=i(7203),q=e=>{var t,i,o,r,d,v;let{selectedObject:p,isSubmitting:x,setIsSubmitting:g,printButtonRef:f,payCommissionBtnRef:y,setKeyCount:j,keyCount:T,dates:b}=e,P=(0,D.useSearchParams)(),w=P.get("pcPaymentStatus"),S=(0,L.v9)(e=>e.bills),I=(0,n.C)(e=>e.auth.diagnostic),A=(0,L.v9)(e=>e.auth),k=(0,n.C)(e=>e.pcCommissions.commissions);console.log(I);let[G,W]=(0,C.useState)([]),q=(0,n.T)(),{data:H,refetch:Q}=(0,M.Uc)(p.id);(0,C.useEffect)(()=>{var e;let t={};null==S||null===(e=S.selectedBills)||void 0===e||e.map(e=>{var i;null==e||null===(i=e.prices)||void 0===i||i.forEach(e=>{t[null==e?void 0:e.testCategoryId]||(t[null==e?void 0:e.testCategoryId]=0),t[null==e?void 0:e.testCategoryId]+=null==e?void 0:e.price})});let i=Object.entries(t).map(e=>{var t,i,l;let[n,s]=e,o=G.find(e=>e.testCategoryId===n),a=null==H?void 0:H.data.pcTestCategoryPercentages.find(e=>e.testCategoryId===n),r=null==S?void 0:null===(l=S.allBills)||void 0===l?void 0:null===(i=l.items)||void 0===i?void 0:null===(t=i.pcPayableCategory)||void 0===t?void 0:t.find((e,t)=>e.id===n);return console.log("gy",a,o,r),{testCategoryId:n,price:s,discount:(null==o?void 0:o.discount)||((null==I?void 0:I.isPCSamePayment)?null==r?void 0:r.pcAmount:null==a?void 0:a.discount)||0,discountType:((null==I?void 0:I.isPCSamePayment)?null==r?void 0:r.pcAmountType:null==a?void 0:a.discountType)||"percentage"}});console.log(i),q((0,Z.RB)(i)),W(i)},[H,null==S?void 0:S.selectedBills]);let K=()=>{let e=0;return null==G||G.forEach(t=>{e+="percentage"===t.discountType?t.price*t.discount/100:0!==t.price?t.discount:0}),Math.floor(e)},X=()=>{var e;let t=0;return null==S||null===(e=S.selectedBills)||void 0===e||e.forEach(e=>{t+=e.discount}),(null==I?void 0:I.includeDiscountInPcCommission)?Math.floor(t):0},Y=async e=>{if(e)console.log(f,"here is here"),f.current&&f.current.click();else{var t,i,l,n,s,o;g(!0);let a=null==S?void 0:null===(t=S.selectedBills)||void 0===t?void 0:t.map(e=>({id:e.id})),r=G.map(e=>({testCategoryId:e.testCategoryId,commission:null==e?void 0:e.discount,commissionType:(null==e?void 0:e.discountType)||"percentage"}));if(null==S||null===(l=S.allBills)||void 0===l||null===(i=l.items)||void 0===i||i.pcPayableCategory.map(e=>({testCategoryId:e.id,commission:null==e?void 0:e.pcAmount,commissionType:(null==e?void 0:e.pcAmountType)||"percentage"})),null==p?void 0:p.id){let{success:t,data:i}=await N(null==p?void 0:p.id,{bills:a,isPaid:e,commissions:r});t?(await z({firstDate:null!==(n=b[0])&&void 0!==n?n:(0,E.Z)(new Date),finalDate:null!==(o=b[1])&&void 0!==o?o:(0,R.Z)(null!==(s=b[0])&&void 0!==s?s:new Date),dispatch:q,selectedObject:p,searchParams:P}),O().fire("Success","Pc Commission Updated","success"),q((0,B.aT)([])),W([]),Q()):O().fire("Error",i||"Invalid Server Response","error")}else O().fire("Error","Select a pc from dropdown","error");g(!1),j((null==I?void 0:I.isPCSamePayment)?T+1:T)}},J=(e,t,i)=>i?Math.floor(t*e/100):t<e?Math.floor(t):0,$=e=>J((null==e?void 0:e.price)||0,(null==e?void 0:e.discount)||0,(null==e?void 0:e.discountType)==="percentage");return"paid"===w?null:!p.id||(null==H?void 0:H.data)?(0,l.jsxs)("div",{onWheel:function(e){0==e.deltaX&&(e.preventDefault(),e.currentTarget.scrollBy({left:e.deltaY>0?50:-50}))},className:V().bottom,children:[(0,l.jsx)("div",{className:V().upper,children:(0,l.jsxs)(s.Stack,{className:"rounded-3 p-2",bg:"#c3d5ed",children:[(0,l.jsxs)(a.Group,{justify:"space-between",children:[(0,l.jsx)(c.Text,{fw:600,children:"Payable"}),(0,l.jsx)(c.Text,{fw:600,children:(null==I||I.isPCSamePayment,K())})]}),(0,l.jsxs)(a.Group,{justify:"space-between",children:[(0,l.jsx)(c.Text,{fw:600,children:"Discount"}),(0,l.jsx)(c.Text,{fw:600,children:X()})]}),(0,l.jsx)("hr",{}),(0,l.jsxs)(a.Group,{justify:"space-between",children:[(0,l.jsx)(c.Text,{fw:600,children:"Total Commission"}),(0,l.jsx)(c.Text,{fw:600,children:K()-X()})]}),(0,l.jsx)(h.Space,{h:10}),(0,l.jsxs)(a.Group,{justify:"space-between",children:[(0,l.jsx)(u.Button,{onClick:()=>Y(!1),radius:"sm",disabled:x||K()-X()<=0,bg:"#FB9C48",children:"Save to Expense"}),((null==A?void 0:null===(t=A.user)||void 0===t?void 0:t.role)==="admin"||(null==A?void 0:null===(i=A.diagnostic)||void 0===i?void 0:i.isPCSetPermission)&&(null==A?void 0:null===(o=A.user)||void 0===o?void 0:o.role)==="receptionist")&&(0,l.jsxs)(u.Button,{ref:y,onClick:()=>f.current&&f.current.click(),radius:"sm",bg:"#1A72E9",disabled:x||K()-X()<=0,children:["Pay Commission",(0,l.jsx)("br",{}),"Now"," "]})]})]})}),(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column ms-0",children:[(0,l.jsx)(m.Box,{className:V().box,bg:"transparent",children:(0,l.jsx)(c.Text,{c:"",fw:700,children:"Category"})}),(0,l.jsx)(m.Box,{className:V().box,bg:"transparent",children:(0,l.jsx)(c.Text,{fw:700,children:" Total Amount"})}),(0,l.jsx)(m.Box,{className:V().box,bg:"transparent",children:(0,l.jsx)(c.Text,{fw:700,children:" Pc Commission"})}),(0,l.jsx)(m.Box,{className:V().box,bg:"transparent",children:(0,l.jsx)(c.Text,{fw:700,children:" Discount Type"})}),(0,l.jsx)(m.Box,{className:V().box,bg:"transparent",children:(0,l.jsx)(c.Text,{fw:700,children:" Pc Payment"})})]}),null==S?void 0:null===(v=S.allBills)||void 0===v?void 0:null===(d=v.items)||void 0===d?void 0:null===(r=d.pcPayableCategory)||void 0===r?void 0:r.map((e,t)=>{var i,n,s;let o=null==k?void 0:k.find(t=>t.testCategoryId===e.id),a=null==H?void 0:null===(i=H.data)||void 0===i?void 0:i.pcTestCategoryPercentages.find(t=>t.testCategoryId===e.id);return(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column",children:[(0,l.jsx)(m.Box,{className:V().box,bg:"transparent",children:(0,l.jsx)(c.Text,{truncate:"end",fw:700,children:e.name})}),(0,l.jsx)(m.Box,{className:V().box,bg:(null==o?void 0:o.price)?"#F0E675":"#DADADA",children:Math.floor((null==o?void 0:o.price)||0)||0}),(0,l.jsx)(F.Y,{rightSection:(0,l.jsx)(l.Fragment,{}),min:0,max:(null==o?void 0:o.discountType)==="percentage"?100:null==o?void 0:o.price,disabled:0===S.selectedBills.length||(null==A?void 0:null===(n=A.user)||void 0===n?void 0:n.role)==="receptionist"&&!(null==I?void 0:I.canReceptionistChangePcCommission),onChange:t=>{let i=G.map(i=>i.testCategoryId===e.id?{testCategoryId:i.testCategoryId,price:i.price,discount:isNaN(parseInt(t))?0:parseInt(t),discountType:i.discountType||"percentage"}:i);q((0,Z.RB)(i)),W(i)},defaultValue:(null==I?void 0:I.isPCSamePayment)?e.pcAmount:(null==a?void 0:a.discount)||0,radius:"md",size:"md"}),(0,l.jsx)(_.r,{styles:{track:{fontWeight:600,fontSize:14}},defaultChecked:(null==I?void 0:I.isPCSamePayment)?(null==e?void 0:e.pcAmountType)!=="amount":(null==a?void 0:a.discountType)!=="amount",disabled:0===S.selectedBills.length||(null==A?void 0:null===(s=A.user)||void 0===s?void 0:s.role)==="receptionist"&&!(I&&(null==I?void 0:I.canReceptionistChangePcCommission)),onChange:t=>{let i=G.map(i=>i.testCategoryId===e.id?{testCategoryId:i.testCategoryId,price:i.price,discount:i.discount,discountType:t.target.checked?"percentage":"amount"}:i);q((0,Z.RB)(i)),W(i)},onLabel:"Percentage",offLabel:"Amount",size:"xl"}),(0,l.jsx)(m.Box,{className:V().box,bg:"#D9e2ed",children:(null==I||I.isPCSamePayment,$(o))})]},e.id)})]}):(0,l.jsx)(U.Z,{})},H=i(87967),Q=i(7140),K=i(58185),X=i(71149),Y=i(88412),J=i(54632),$=i(72375),ee=i(76029),et=i(59406),ei=i(24901),el=e=>{var t,i,s,o,r;let{checkBoxRef:d}=e,[u,m]=(0,C.useState)([]),[h,x]=(0,C.useState)([]),g=(0,L.v9)(e=>e.bills),f=(0,n.T)(),y=(0,D.useSearchParams)(),T=y.get("pcPaymentStatus"),b=y.get("doctorPaymentStatus"),P=y.get("doctorCommissionType"),w=null!==b;(0,C.useEffect)(()=>{var e,t,i,l;let n=w?null==g?void 0:null===(t=g.allBills)||void 0===t?void 0:null===(e=t.items)||void 0===e?void 0:e.doctorPayableCategory:null==g?void 0:null===(l=g.allBills)||void 0===l?void 0:null===(i=l.items)||void 0===i?void 0:i.pcPayableCategory;m(["BillId","Patient Name","Sub Total","Discount",...(null==n?void 0:n.map(e=>(null==e?void 0:e.name)||"Unknown"))||[]])},[null==g?void 0:null===(i=g.allBills)||void 0===i?void 0:null===(t=i.items)||void 0===t?void 0:t.pcPayableCategory,null==g?void 0:null===(o=g.allBills)||void 0===o?void 0:null===(s=o.items)||void 0===s?void 0:s.doctorPayableCategory,w]),(0,C.useEffect)(()=>{var e;let{pcPayableCategory:t,doctorPayableCategory:i,bills:l}=(null==g?void 0:null===(e=g.allBills)||void 0===e?void 0:e.items)||{},n=[],s=w?i:t;null==l||l.map(e=>{let t=[];null==s||s.forEach(i=>{var l;let n=null==e?void 0:null===(l=e.testCategories)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.id)===(null==i?void 0:i.id));t.push({testCategoryId:(null==i?void 0:i.id)||"",price:(null==n?void 0:n.price)||0})});let i={id:(null==e?void 0:e.id)||"",billId:(null==e?void 0:e.billId)||"",name:(null==e?void 0:e.name)||"N/A",subTotal:Math.floor((null==e?void 0:e.totalAmountWithDiscount)||0),discount:Math.floor(((null==e?void 0:e.totalAmout)||0)-((null==e?void 0:e.totalAmountWithDiscount)||0)),prices:t,isCommissionPaid:w?"perTest"===P?null==e?void 0:e.isCommissionPaid:null==e?void 0:e.isDoctorCommissionPaid:null==e?void 0:e.isCommissionPaid,isPaid:(null==e?void 0:e.isPaid)||!1,isDoctorCommissionPaid:(null==e?void 0:e.isDoctorCommissionPaid)||!1};n.push(i)}),x(n)},[null==g?void 0:null===(r=g.allBills)||void 0===r?void 0:r.items,w,P]);let S=w?b:T;return(0,l.jsx)("div",{className:"bg-white rounded-4",children:(0,l.jsx)(J.i.ScrollContainer,{minWidth:1500,children:(0,l.jsxs)(J.i,{styles:{th:{wordWrap:"normal",backgroundColor:"#f8f9fa"},td:{wordWrap:"normal"}},striped:!0,withRowBorders:!0,verticalSpacing:"md",highlightOnHover:!0,children:[(0,l.jsx)(J.i.Thead,{children:(0,l.jsxs)(J.i.Tr,{children:[(0,l.jsx)(J.i.Th,{children:(0,l.jsx)($.X,{ref:d,"aria-label":"Select all bills",onChange:e=>{let t=(null==h?void 0:h.filter(e=>(!(null==e?void 0:e.isCommissionPaid)||"paid"===S)&&(null==e?void 0:e.isPaid)))||[];e.currentTarget.checked?f((0,B.aE)(t)):f((0,B.aT)(h))}})}),null==u?void 0:u.map((e,t)=>(0,l.jsx)(J.i.Th,{className:"text-center",children:(0,l.jsx)(c.Text,{ta:"center",size:"md",fw:700,children:e})},"".concat(e,"-").concat(t)))]})}),(0,l.jsx)(J.i.Tbody,{children:h&&h.length>0?h.map(e=>{var t,i,n,s;let o=null==g?void 0:null===(t=g.selectedBills)||void 0===t?void 0:t.find(t=>(null==t?void 0:t.billId)===(null==e?void 0:e.billId)),r=null==e?void 0:e.isCommissionPaid,d=null==e?void 0:e.isPaid;return(0,l.jsxs)(J.i.Tr,{bg:d?r?"var(--mantine-color-green-light)":o?"var(--mantine-color-blue-light)":void 0:"var(--mantine-color-yellow-light)",style:{transition:"background-color 0.2s ease"},children:[(0,l.jsx)(J.i.Td,{children:r&&"paid"!==S?(0,l.jsxs)(a.Group,{gap:4,justify:"center",children:[(0,l.jsx)(et.Z,{size:20,color:"green"}),(0,l.jsx)(v.C,{size:"xs",color:"green",variant:"light",children:"Paid"})]}):d||"paid"===S?(0,l.jsx)($.X,{"aria-label":"Select bill ".concat(null==e?void 0:e.billId),checked:!!o,onChange:t=>{t.currentTarget.checked?f((0,B.aE)(e)):f((0,B.aT)(null==e?void 0:e.billId))}}):(0,l.jsxs)(a.Group,{gap:4,justify:"center",children:[(0,l.jsx)(ei.Z,{size:20,color:"orange"}),(0,l.jsx)(v.C,{size:"xs",color:"orange",variant:"light",children:"Unpaid"})]})}),(0,l.jsx)(J.i.Td,{className:"text-center",children:(0,l.jsxs)(a.Group,{gap:8,justify:"center",children:[(0,l.jsx)(j.default,{href:"/billing/details?billingId=".concat(null==e?void 0:e.billId,"&view=true"),style:{color:"#228be6",textDecoration:"none",fontWeight:600},children:(null==e?void 0:e.billId)||"N/A"}),!w&&(null==e?void 0:e.isDoctorCommissionPaid)&&(0,l.jsx)(ee.u,{label:"Doctor commission paid",withArrow:!0,children:(0,l.jsx)(v.C,{size:"sm",color:"violet",variant:"light",leftSection:(0,l.jsx)(p.Z,{size:14}),children:"Dr"})})]})}),(0,l.jsx)(J.i.Td,{className:"text-center",children:(0,l.jsx)(c.Text,{size:"sm",fw:500,children:(null==e?void 0:e.name)||"N/A"})}),(0,l.jsx)(J.i.Td,{className:"text-center",children:(0,l.jsxs)(c.Text,{size:"sm",fw:600,c:"green",children:["৳ ",(null==e?void 0:null===(i=e.subTotal)||void 0===i?void 0:i.toLocaleString())||"0"]})}),(0,l.jsx)(J.i.Td,{className:"text-center",children:(0,l.jsxs)(c.Text,{size:"sm",fw:600,c:"orange",children:["৳ ",(null==e?void 0:null===(n=e.discount)||void 0===n?void 0:n.toLocaleString())||"0"]})}),null==e?void 0:null===(s=e.prices)||void 0===s?void 0:s.map((t,i)=>{var n;return(0,l.jsx)(J.i.Td,{className:"text-center",children:(0,l.jsx)(c.Text,{size:"sm",c:(null==t?void 0:t.price)>0?"blue":"dimmed",children:(null==t?void 0:t.price)>0?"৳ ".concat(null==t?void 0:null===(n=t.price)||void 0===n?void 0:n.toFixed(2)):"-"})},"price-".concat(i,"-").concat(null==e?void 0:e.billId))})]},(null==e?void 0:e.billId)||Math.random())}):(0,l.jsx)(J.i.Tr,{children:(0,l.jsx)(J.i.Td,{colSpan:(null==u?void 0:u.length)+1||5,children:(0,l.jsx)(c.Text,{ta:"center",size:"lg",c:"dimmed",py:"xl",children:"No bills found. Try adjusting your filters."})})})})]})})})},en=i(71256),es=i(72752);let eo=async e=>{try{let t=await S.default.get("".concat("http://sasthotech.local:5000/api/v1","/pc/").concat(e),w.FD);return{success:!0,data:t.data.data}}catch(e){if(e instanceof I.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}};var ea=e=>{var t,i,s,o,r,d,u,m,v;let{selectedObject:h}=e,p=(0,D.useSearchParams)(),x=(0,n.C)(e=>e.auth.diagnostic),g=(0,n.C)(e=>e.pcCommissions.commissions),{data:f,refetch:y}=(0,M.Uc)((null==h?void 0:h.id)||""),[j,T]=(0,C.useState)(p.get("pcPaymentStatus")),[b,P]=(0,C.useState)([]),[w,S]=(0,C.useState)([]),[I,A]=(0,C.useState)(null),B=(0,n.C)(e=>e.bills),[k,z]=(0,C.useState)(null);(0,D.useRouter)(),(0,C.useMemo)(async()=>{if(null==h?void 0:h.id){let{success:e,data:t}=await eo(null==h?void 0:h.id);if(e)return z(t),t}return null},[null==h?void 0:h.id]);let N=()=>{var e,t;let i=0;return"paid"===p.get("pcPaymentStatus")?null==f||null===(t=f.data)||void 0===t||null===(e=t.pcTestCategoryPercentages)||void 0===e||e.forEach(e=>{e&&(i+=F((null==I?void 0:I[e.testCategoryId])||0,(null==e?void 0:e.discount)||0,"percentage"===e.discountType))}):null==g||g.forEach(e=>{i+="percentage"===e.discountType?e.price*e.discount/100:0!==e.price?e.discount:0}),Math.floor(i)},Z=()=>{var e;let t=0;return null==B||null===(e=B.selectedBills)||void 0===e||e.forEach(e=>{t+=e.discount}),(null==x?void 0:x.includeDiscountInPcCommission)?Math.floor(t):0};(0,C.useEffect)(()=>{var e,t,i;P(["Bill Id","Name",...(null==B?void 0:null===(i=B.allBills)||void 0===i?void 0:null===(t=i.items)||void 0===t?void 0:null===(e=t.pcPayableCategory)||void 0===e?void 0:e.map(e=>e.name))||[]])},[null==B?void 0:null===(i=B.allBills)||void 0===i?void 0:null===(t=i.items)||void 0===t?void 0:t.pcPayableCategory]),(0,C.useEffect)(()=>{var e;let{pcPayableCategory:t,bills:i}=(null==B?void 0:null===(e=B.allBills)||void 0===e?void 0:e.items)||{},l=[];null==i||i.map(e=>{let i=[];null==t||t.reduce((t,l)=>{var n;let s=null==e?void 0:null===(n=e.testCategories)||void 0===n?void 0:n.find(e=>e.id===l.id);s?i.push({testCategoryId:l.id,price:s.price}):i.push({testCategoryId:l.id,price:0})},[]);let n={id:e.id,billId:e.billId,name:e.name,time:e.createdAt,subTotal:Math.floor(e.totalAmountWithDiscount),discount:Math.floor(e.totalAmout-e.totalAmountWithDiscount),prices:i,isCommissionPaid:e.isCommissionPaid};l.push(n)}),S(l)},[null==B?void 0:null===(s=B.allBills)||void 0===s?void 0:s.items]),(0,C.useEffect)(()=>{var e;let t={};null==B||null===(e=B.selectedBills)||void 0===e||e.forEach(e=>{var i;null==e||null===(i=e.prices)||void 0===i||i.forEach(e=>{let i=e.testCategoryId;t[i]=(t[i]||0)+e.price})}),A(t)},[null==B?void 0:B.selectedBills]);let F=(e,t,i)=>i?Math.floor(t*e/100):Math.floor(t);return(0,l.jsxs)("div",{className:"print-total-bill px-3 ",children:[(0,l.jsxs)("style",{type:"text/css",media:"print",children:["@page { size: A5 portrait; }","* { font-weight: 700 !important; }"]}),(0,l.jsx)(en.Z,{small:!0,diagnostic:x}),(0,l.jsx)(es.Z,{small:!0}),(0,l.jsxs)(a.Group,{children:[(0,l.jsx)(c.Text,{children:"Pc Name: "}),(0,l.jsx)(c.Text,{children:null==h?void 0:h.name})]}),(0,l.jsxs)("div",{className:"bg-white rounded-4",children:[(0,l.jsxs)(J.i,{borderColor:"#000000",className:V().table,verticalSpacing:0,layout:"fixed",children:[(0,l.jsx)(J.i.Thead,{children:(0,l.jsxs)(J.i.Tr,{className:V().table,children:[null==b?void 0:b.map(e=>(0,l.jsx)(J.i.Th,{className:"text-center",children:(0,l.jsx)(c.Text,{styles:{root:{fontSize:"Bill Id"===e?"10px":"auto",wordBreak:"break-word"}},ta:"center",size:"xs",fw:700,children:e})},e)),(0,l.jsx)(J.i.Th,{className:"text-center",children:(0,l.jsx)(c.Text,{style:{wordBreak:"break-word"},ta:"center",size:"xs",fw:700,children:"Discount"})})]})}),(0,l.jsxs)(J.i.Tbody,{children:[null==w?void 0:w.map(e=>{if(B.selectedBills.find(t=>t.billId===e.billId))return(0,l.jsxs)(J.i.Tr,{className:V().table,bg:e.isCommissionPaid?"var(--mantine-color-green-light)":B.selectedBills.find(t=>t.billId===e.billId)?"var(--mantine-color-blue-light)":void 0,children:[(0,l.jsx)(J.i.Td,{className:"text-center",children:(0,l.jsx)(c.Text,{style:{fontSize:10,wordBreak:"break-word"},size:"xs",children:e.billId})}),(0,l.jsx)(J.i.Td,{style:{wordBreak:"break-word"},className:"text-center",children:(0,l.jsx)(c.Text,{style:{wordBreak:"break-word"},size:"xs",children:e.name})}),e.prices.map((e,t)=>(0,l.jsx)(J.i.Td,{style:{wordBreak:"break-word"},className:"text-center",children:(0,l.jsxs)(c.Text,{ta:"center",size:"sm",children:[" ",Math.floor((null==e?void 0:e.price)||0)]})},t)),(0,l.jsx)(J.i.Td,{className:"text-center",children:(0,l.jsx)(c.Text,{size:"sm",children:e.discount})})]},e.billId)}),(0,l.jsxs)(J.i.Tr,{className:V().table,styles:{tr:{borderTop:"1px solid black"}},children:[(0,l.jsxs)(J.i.Td,{children:["  "," "]}),(0,l.jsxs)(J.i.Td,{children:[" ",(0,l.jsx)(c.Text,{ta:"center",size:"xs",children:"Total"})," "]}),null==B?void 0:null===(d=B.allBills)||void 0===d?void 0:null===(r=d.items)||void 0===r?void 0:null===(o=r.pcPayableCategory)||void 0===o?void 0:o.map((e,t)=>(0,l.jsxs)(J.i.Td,{children:[(0,l.jsx)(c.Text,{style:{wordBreak:"break-word"},ta:"center",size:"sm",children:Math.floor((null==I?void 0:I[e.id])||0)||0})," "]},null==e?void 0:e.id)),(0,l.jsxs)(J.i.Td,{children:[(0,l.jsx)(c.Text,{style:{wordBreak:"break-word"},ta:"center",size:"sm",children:Z()})," "]})]}),(0,l.jsxs)(J.i.Tr,{className:V().table,children:[(0,l.jsxs)(J.i.Td,{children:["  "," "]}),(0,l.jsxs)(J.i.Td,{children:[" ",(0,l.jsx)(c.Text,{ta:"center",style:{fontSize:10,wordBreak:"break-word"},children:"Comm."})," "]}),null==B?void 0:null===(v=B.allBills)||void 0===v?void 0:null===(m=v.items)||void 0===m?void 0:null===(u=m.pcPayableCategory)||void 0===u?void 0:u.map((e,t)=>{var i;let n;if(n="paid"===p.get("pcPaymentStatus")?null==f?void 0:null===(i=f.data.pcTestCategoryPercentages)||void 0===i?void 0:i.find(t=>t.testCategoryId===e.id):null==g?void 0:g.find(t=>t.testCategoryId===e.id))return(0,l.jsxs)(J.i.Td,{children:[(0,l.jsx)(c.Text,{style:{wordBreak:"break-word"},size:"sm",ta:"center",children:(null==n?void 0:n.discountType)==="percentage"?Math.floor(((null==n?void 0:n.discount)||0)*((null==I?void 0:I[e.id])||0)/100):(null==n?void 0:n.discount)!==0&&(null==I?void 0:I[e.id])!==0?Math.floor((null==n?void 0:n.discount)||0):0})," "]},null==n?void 0:n.testCategoryId)}),(0,l.jsx)(J.i.Td,{children:(0,l.jsxs)(c.Text,{ta:"center",size:"xs",children:["  ","--"]})})]})]})]}),(0,l.jsx)(J.i,{mt:"md",ml:"auto",w:"auto",withRowBorders:!1,verticalSpacing:0,children:(0,l.jsxs)(J.i.Tbody,{children:[(0,l.jsxs)(J.i.Tr,{children:[(0,l.jsx)(J.i.Th,{children:"Payable"}),(0,l.jsx)(J.i.Td,{style:{wordBreak:"break-word"},children:N()})]}),(0,l.jsxs)(J.i.Tr,{children:[(0,l.jsx)(J.i.Th,{children:"Less"}),(0,l.jsx)(J.i.Td,{style:{wordBreak:"break-word"},children:Z()})]}),(0,l.jsxs)(J.i.Tr,{children:[(0,l.jsx)(J.i.Th,{children:"Paid"}),(0,l.jsx)(J.i.Td,{style:{wordBreak:"break-word"},children:N()-Z()})]})]})})]})]})},er=i(10975),ed=i(48604),ec=i(49905),eu=i(85033),em=i(14587),ev=i(77379),eh=i(3741),ep=i(9286),ex=i(58291),eg=i(86083),ef=i(67781),ey=i(77052),ej=i(16201),eC=i(64687),eT=i(4646),eb=i(14685),eP=i(26250),ew=i(12725),eS=i(33089),eI=i(3674),eA=i(83394),eB=i(57974),eD=i.n(eB);let ek=[{label:"Today",value:"today"},{label:"Last 2 months",value:"month2"},{label:"Last 3 months",value:"month3"},{label:"Last 6 months",value:"month6"},{label:"Last 9 months",value:"month9"},{label:"Last 12 months",value:"month12"},{label:"This week",value:"week"},{label:"This month",value:"month"},{label:"This year",value:"year"}],ez={today:()=>[(0,eT.Z)(),(0,eb.Z)()],month2:()=>[(0,eP.Z)((0,ew.Z)(new Date),1),(0,eb.Z)()],month3:()=>[(0,eP.Z)((0,ew.Z)(new Date),2),(0,eb.Z)()],month6:()=>[(0,eP.Z)((0,ew.Z)(new Date),5),(0,eb.Z)()],month9:()=>[(0,eP.Z)((0,ew.Z)(new Date),8),(0,eb.Z)()],month12:()=>[(0,eP.Z)((0,ew.Z)(new Date),11),(0,eb.Z)()],week:()=>[(0,eS.Z)(new Date),(0,eb.Z)()],month:()=>[(0,ew.Z)(new Date),(0,eb.Z)()],year:()=>[(0,eI.Z)(new Date),(0,eb.Z)()]};var eN=e=>{var t,i,o,d,u;let{dates:h,setDates:p,selectedObject:x,setSelectedObject:g,setPcCommissionVisible:f,pcPaymentStatus:y,setPcPaymentStatus:j,doctorCommissionFilter:T,setDoctorCommissionFilter:b,checkBoxRef:P,onRefresh:w}=e,S=(0,D.useSearchParams)(),I=(0,D.useRouter)(),A=(0,n.T)(),[k,z]=(0,C.useState)(!1),N=(0,C.useMemo)(()=>S.getAll("pCIds"),[S]);console.log(N,"selectedPcIds");let Z=e=>{let t=new URLSearchParams(S.toString());t.delete("pCIds"),e.forEach(e=>t.append("pCIds",e)),e.length>0&&t.delete("pCId"),I.push("?"+t.toString()),A((0,B.aT)([]))};(0,C.useEffect)(()=>{let e=localStorage.getItem("showMarketerFilter");e&&z("true"===e)},[]);let{data:F,isLoading:E}=(0,M.K0)(),R=(0,C.useMemo)(()=>(null==F?void 0:F.data)||[],[F]);console.log(R,"pcData");let L=(0,n.C)(e=>e.diagnostic.marketer),G=(0,n.C)(e=>{var t;return null==e?void 0:null===(t=e.bills)||void 0===t?void 0:t.selectedBills});(0,C.useEffect)(()=>{(async()=>{if((null==L?void 0:L.length)===0){let{success:e,data:t}=await (0,eC.u)();e&&A((0,ej.ZR)(null==t?void 0:t.items))}})()},[A,null==L?void 0:L.length]);let O=(e,t)=>{let i=new URLSearchParams(S.toString());t?i.set(e,t):i.delete(e),I.push("?"+i.toString()),A((0,B.aT)([]))};return(0,l.jsx)(ed.Z,{shadow:"sm",padding:"lg",radius:"md",className:eD().filterSection,children:(0,l.jsxs)(s.Stack,{gap:"md",children:[(0,l.jsx)(a.Group,{justify:"space-between",align:"center",children:(0,l.jsxs)(a.Group,{gap:"xs",children:[(0,l.jsx)(r.k,{size:"md",radius:"md",variant:"light",color:"indigo",children:(0,l.jsx)(ep.Z,{size:18})}),(0,l.jsx)(c.Text,{size:"md",fw:600,children:"Filters & Selection"})]})}),(0,l.jsxs)(ec.M,{cols:{base:1,sm:2,lg:3},spacing:"md",children:[(0,l.jsxs)(m.Box,{className:eD().filterItem,children:[k&&(0,l.jsx)(H.P,{placeholder:"\uD83D\uDC64 Select Marketer",data:null!==(t=null==L?void 0:L.map(e=>({label:e.name||e.email,value:e.id})))&&void 0!==t?t:[],value:null!==(i=S.get("marketerId"))&&void 0!==i?i:null,onChange:e=>O("marketerId",e),searchable:!0,clearable:!0,size:"md",leftSection:(0,l.jsx)(ex.Z,{size:18}),styles:{input:{fontWeight:500}},mb:"xs"}),(0,l.jsx)(_.r,{label:"Show Marketer",checked:k,onChange:e=>{let t=e.currentTarget.checked;z(t),localStorage.setItem("showMarketerFilter",String(t)),t?g(null):Z([])}})]}),(0,l.jsx)(m.Box,{className:eD().filterItem,children:k?(0,l.jsx)(eu.N,{placeholder:"\uD83C\uDFE5 Select PCs",data:null!==(o=null==R?void 0:R.map(e=>({label:e.pcCode?"".concat(e.name," (").concat(e.pcCode,")"):e.name,value:e.id})))&&void 0!==o?o:[],value:N,onChange:e=>{Z(e),1===e.length?g((null==R?void 0:R.find(t=>t.id===e[0]))||null):g(null)},searchable:!0,clearable:!0,nothingFoundMessage:"No PC Found",size:"md",leftSection:E?(0,l.jsx)(em.Loader,{size:"xs"}):(0,l.jsx)(eg.Z,{size:18}),styles:{input:{fontWeight:500}}}):(0,l.jsx)(H.P,{placeholder:"\uD83C\uDFE5 Select PC",data:null!==(d=null==R?void 0:R.map(e=>({label:e.pcCode?"".concat(e.name," (").concat(e.pcCode,")"):e.name,value:e.id})))&&void 0!==d?d:[],value:null!==(u=null==x?void 0:x.id)&&void 0!==u?u:null,onChange:e=>{if(P.current&&(P.current.checked=!1),e){let t=null==R?void 0:R.find(t=>t.id===e);t&&g(t)}else g(null),f(!1)},searchable:!0,clearable:!0,nothingFoundMessage:"No PC Found",size:"md",leftSection:E?(0,l.jsx)(em.Loader,{size:"xs"}):(0,l.jsx)(eg.Z,{size:18}),styles:{input:{fontWeight:500}}})}),(0,l.jsx)(m.Box,{className:eD().filterItem,children:(0,l.jsxs)(a.Group,{gap:0,wrap:"nowrap",className:eD().dateGroup,children:[(0,l.jsx)(ey.DatePickerInput,{type:"range",placeholder:"\uD83D\uDCC5 Select date range",value:h,onChange:p,size:"md",leftSection:(0,l.jsx)(ef.Z,{size:18}),styles:{input:{fontWeight:500,border:"none",borderRadius:"var(--mantine-radius-md) 0 0 var(--mantine-radius-md)",fontSize:"min(14px, 3.5vw)"}},style:{flex:1}}),(0,l.jsx)(H.P,{placeholder:"Preset",data:ek,value:function(e){let[t,i]=e;if(i&&!(0,eA.Z)(i,new Date)||!t)return null;for(let e of ek){let i=ez[e.value]()[0];if((0,eA.Z)(t,i))return e.value}return null}(h),onChange:e=>{e&&p(ez[e]())},size:"md",w:{base:100,xs:130},styles:{input:{fontWeight:500,border:"none",borderRadius:"0 var(--mantine-radius-md) var(--mantine-radius-md) 0",borderLeft:"1px solid #e9ecef"}},checkIconPosition:"right"})]})})]}),(0,l.jsxs)(ec.M,{cols:{base:1,sm:2},spacing:"md",children:[(0,l.jsxs)(m.Box,{children:[(0,l.jsx)(c.Text,{size:"sm",fw:500,mb:8,c:"dimmed",children:"PC Payment Status"}),(0,l.jsx)(ev.s,{value:null!=y?y:"unpaid",onChange:e=>{O("pcPaymentStatus",null!=e?e:"unpaid"),j(null!=e?e:"unpaid")},fullWidth:!0,size:"md",data:[{label:"\uD83D\uDCCB Unpaid",value:"unpaid"},{label:"✅ Paid",value:"paid"},{label:"\uD83D\uDCCA All",value:"all"}],styles:{root:{background:"#f1f3f5"}}})]}),(0,l.jsxs)(m.Box,{children:[(0,l.jsx)(c.Text,{size:"sm",fw:500,mb:8,c:"dimmed",children:"Doctor Commission Status"}),(0,l.jsx)(ev.s,{value:null!=T?T:"all",onChange:e=>{O("doctorCommissionFilter",null!=e?e:"all"),b(null!=e?e:"all")},fullWidth:!0,size:"md",data:[{label:"\uD83D\uDCCA All",value:"all"},{label:"✅ Dr Paid",value:"paid"},{label:"\uD83D\uDCCB Dr Unpaid",value:"unpaid"}],styles:{root:{background:"#f1f3f5"}}})]})]}),G&&G.length>0&&(0,l.jsxs)(a.Group,{justify:"space-between",p:"md",style:{background:"#e7f5ff",borderRadius:8},children:[(0,l.jsxs)(a.Group,{gap:"xs",children:[(0,l.jsxs)(v.C,{size:"lg",variant:"filled",color:"blue",children:[G.length," Bills Selected"]}),(0,l.jsx)(c.Text,{size:"sm",c:"dimmed",children:"Ready for commission processing"})]}),(0,l.jsx)(eh.A,{variant:"light",color:"red",size:"sm",onClick:()=>A((0,B.aT)([])),children:"\xd7"})]})]})})},eM=e=>{var t,i;let{setSelectedObject:s,setKeyCount:o,keyCount:r,selectedObject:d,setPcCommissionVisible:v,printButtonRef:p,isSubmitting:x,setIsSubmitting:g,dates:f,setDates:y}=e,j=(0,D.useSearchParams)(),T=(0,D.useRouter)(),b=(0,n.C)(e=>{var t;return null==e?void 0:null===(t=e.bills)||void 0===t?void 0:t.allBills}),P=(0,n.C)(e=>{var t;return null==e?void 0:null===(t=e.auth)||void 0===t?void 0:t.diagnostic}),w=(0,n.T)(),S=(0,n.C)(e=>{var t;return null==e?void 0:null===(t=e.bills)||void 0===t?void 0:t.selectedBills}),I=(0,n.C)(e=>e.pcCommissions.commissions),{data:A,refetch:F}=(0,M.Uc)((null==d?void 0:d.id)||""),[_,L]=(0,C.useState)(j.get("pcPaymentStatus")),[G,W]=(0,C.useState)(j.get("doctorCommissionFilter")),q=k(f,d),J=(0,C.useRef)(null),$=(0,C.useRef)(null),ee=(0,Y.useReactToPrint)({content:()=>J.current,documentTitle:" Pc Commission Lists",onAfterPrint(){w((0,Z.RB)([])),w((0,B.aT)([])),w((0,Z.RB)([])),F(),ei()}}),et=(0,X.HG)("pc-payment"),ei=async()=>{var e,t,i;await z({firstDate:null!==(e=f[0])&&void 0!==e?e:(0,E.Z)(new Date),finalDate:null!==(i=f[1])&&void 0!==i?i:(0,R.Z)(null!==(t=f[0])&&void 0!==t?t:new Date),dispatch:w,selectedObject:d,searchParams:j})&&(g(!1),o((null==P?void 0:P.isPCSamePayment)?r+1:r))},en=async e=>{var t,i,l,n;g(!0),j.getAll("pCIds");let s=null==S?void 0:S.map(e=>({id:e.id})),a=null==I?void 0:I.map(e=>({testCategoryId:e.testCategoryId,commission:null==e?void 0:e.discount,commissionType:(null==e?void 0:e.discountType)||"percentage"}));if(null==b||null===(t=b.items)||void 0===t||t.pcPayableCategory.map(e=>({testCategoryId:e.id,commission:null==e?void 0:e.pcAmount,commissionType:(null==e?void 0:e.pcAmountType)||"percentage"})),null==d?void 0:d.id){let{success:t,data:c}=await N((null==d?void 0:d.id)||"",{bills:s,isPaid:e,commissions:a,pCIds:void 0});if(t){let e=await O().fire({confirmButtonText:"Print",showCancelButton:!0,title:"Success",html:"Pc Commission Saved .</br> Do you want to print?",icon:"success"});e.isConfirmed?(ee(),console.log(e,"print")):(await z({firstDate:null!==(i=f[0])&&void 0!==i?i:(0,E.Z)(new Date),finalDate:null!==(n=f[1])&&void 0!==n?n:(0,R.Z)(null!==(l=f[0])&&void 0!==l?l:new Date),dispatch:w,selectedObject:d,searchParams:j}),w((0,B.aT)([])),w((0,Z.RB)([])),F(),g(!1),o(r+1))}else O().fire("Error",c||"Invalid Server Response","error")}else O().fire("Error","Select a pc from dropdown","error")};return(0,C.useEffect)(()=>{w((0,B.aT)([])),console.log("comes here")},[w,d]),(0,l.jsx)(l.Fragment,{children:q?(0,l.jsx)(U.Z,{}):(0,l.jsxs)("div",{className:"rounded-3 bg-white",children:[(0,l.jsx)(a.Group,{px:"md",py:"lg",justify:"space-between",wrap:"wrap",gap:"md",children:(0,l.jsxs)(u.Button,{ref:p,onClick:()=>en(!0),size:"md",radius:"md",className:"d-none",children:[(0,l.jsx)(K.Z,{})," Print"]})}),(0,l.jsx)(m.Box,{px:"md",pb:"md",children:(0,l.jsx)(eN,{dates:f,setDates:y,selectedObject:d,setSelectedObject:s,setPcCommissionVisible:v,pcPaymentStatus:_,setPcPaymentStatus:L,doctorCommissionFilter:G,setDoctorCommissionFilter:W,checkBoxRef:$})}),(0,l.jsx)(el,{checkBoxRef:$}),(0,l.jsxs)("div",{ref:J,children:[(0,l.jsx)("style",{type:"text/css",media:"print",children:et}),(null==P?void 0:P.isPCPaymentPerTest)?(0,l.jsx)(er.V,{pcId:(null==d?void 0:d.id)||""}):(0,l.jsx)(ea,{selectedObject:d})," "]}),(null==b?void 0:null===(i=b.items)||void 0===i?void 0:null===(t=i.bills)||void 0===t?void 0:t.length)!==0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.Box,{px:"md",py:"lg",children:(0,l.jsxs)(a.Group,{justify:"space-between",align:"center",wrap:"wrap",gap:"md",children:[(0,l.jsx)(H.P,{label:"Select Limit",data:["10","25","50","75","100","96"],value:j.get("limit")||"50",onChange:e=>T.push("?limit=".concat(e,"&page=").concat(j.get("page")||1)),size:"sm",w:{base:"100%",sm:150}}),(0,l.jsx)(Q.t,{value:parseInt(j.get("page")||"1"),onChange:e=>T.push("?limit=".concat(j.get("limit")||50,"&page=").concat(e)),total:null==b?void 0:b.totalPage,size:"sm"})]})}),(0,l.jsx)(m.Box,{className:"d-flex pay-pc-btn justify-content-center",pb:"xl",px:"md",children:"paid"===_?(0,l.jsx)(u.Button,{onClick:()=>{(null==d?void 0:d.id)?ee():O().fire("Error","Select a pc from dropdown","error")},size:"md",radius:"md",className:V().responsiveButton,leftSection:(0,l.jsx)(K.Z,{size:18}),children:"Print"}):(0,l.jsx)(u.Button,{onClick:()=>{(null==d?void 0:d.id)?v(!0):O().fire("Error","Select a pc from dropdown","error")},size:"md",radius:"md",className:V().responsiveButton,tt:"uppercase",children:"Pay Pc"})})]}):(0,l.jsx)(c.Text,{ta:"center",c:"red",size:"xl",fw:600,children:"No Bill Found in this period"}),(0,l.jsx)(h.Space,{h:5})]})})};let eZ=async(e,t)=>{try{let i=await S.default.post("".concat("http://sasthotech.local:5000/api/v1","/commission/pc-per-test/").concat(e),t,{...w.FD,...w.Hn});return{success:!0,data:i.data.data}}catch(e){if(e instanceof I.d7){var i;return{success:!1,data:null===(i=e.response)||void 0===i?void 0:i.data.message}}return{success:!1,data:"An error occurred"}}};var eF=i(47720),e_=i(82132);function eE(e){var t,i,o;let{pcId:r}=e,{data:d,isLoading:c,isError:v,refetch:h}=(0,M.h2)(r,{refetchOnMountOrArgChange:!0}),p=(0,n.C)(e=>e.bills.selectedBills),x=(0,n.C)(e=>e.auth),[g,f]=(0,C.useState)(0),[y]=(0,C.useState)(3333),j=(0,C.useRef)(null),[T]=(0,e_.f)({content:()=>j.current,documentTitle:" Pc Commission Lists",onBeforeGetContent(){},onAfterPrint(){N((0,B.aT)([])),N((0,B.Im)(null))}}),{selectedBills:b,tests:P,totals:w,totalDiscount:S,lastPaidCommissions:I,initialCommissions:A}=(0,C.useMemo)(()=>{var e,t,i,l,n,s,o,a;if(!d)return{};let r=new Set(null==p?void 0:p.map(e=>e.billId)),c=null==d?void 0:null===(t=d.data)||void 0===t?void 0:null===(e=t.bills)||void 0===e?void 0:e.filter(e=>r.has(e.billId)),u=new Map;for(let e of c)for(let t of null==e?void 0:e.tests)t.testId&&u.set(t.testId,(u.get(t.testId)||0)+((null==x?void 0:null===(i=x.diagnostic)||void 0===i?void 0:i.isTestDiscountIncludeInBill)?t.price:"amount"===t.discountType?t.price-t.discount:t.price*(1-t.discount/100)));let m=null==d?void 0:null===(n=d.data)||void 0===n?void 0:null===(l=n.tests)||void 0===l?void 0:l.filter(e=>u.get(e.id)),v=null==m?void 0:m.map(e=>u.get(e.id)||0),h=(null===(s=x.diagnostic)||void 0===s?void 0:s.isPCSamePayment)?void 0:new Map(null==d?void 0:null===(a=d.data)||void 0===a?void 0:null===(o=a.percentages)||void 0===o?void 0:o.map(e=>[e.testId,[e.discount,e.discountType]])),g=m.map(e=>{var t;let[i,l]=(null==x?void 0:null===(t=x.diagnostic)||void 0===t?void 0:t.isPCSamePayment)?[e.pcAmount,e.pcAmountType]:(null==h?void 0:h.get(e.id))||[];return{commission:i||0,isPercentage:"amount"!==l}}),y=Math.floor(null==g?void 0:g.reduce((e,t,i)=>e+(t.isPercentage?t.commission*(((null==v?void 0:v[i])||0)/100):t.commission),0));f(y);let j=null==c?void 0:c.reduce((e,t)=>e+t.totalAmout-t.totalAmountWithDiscount,0);return{selectedBills:c,totalAmountsByTestID:u,tests:m,totalDiscount:j,totals:v,lastPaidCommissions:h,initialCommissions:y}},[x,d,p]),D=(0,eF.c)({mode:"uncontrolled",initialValues:{commissions:[]},onValuesChange:e=>{f(Math.floor(e.commissions.reduce((e,t,i)=>e+(t.isPercentage?t.commission*(((null==w?void 0:w[i])||0)/100):t.commission),0)))}}),k=(0,C.useRef)(D);k.current=D;let{testCommissionControls:z}=(0,C.useMemo)(()=>{if(!P)return{};let e=k.current;e.setInitialValues({commissions:P.map(e=>{var t;let[i,l]=(null==x?void 0:null===(t=x.diagnostic)||void 0===t?void 0:t.isPCSamePayment)?[e.pcAmount,e.pcAmountType]:(null==I?void 0:I.get(e.id))||[];return{commission:i||0,isPercentage:"amount"!==l}})}),e.reset();let t=P.map((t,i)=>{let n=Math.floor((null==w?void 0:w[i])||0),s=e.getInputProps("commissions.".concat(i,".isPercentage"));return{id:t.id,Test:t.name,"Total Amount":(0,l.jsx)(m.Box,{className:V().box,bg:"#DADADA",children:n}),"PC Commission":(0,l.jsx)(eL,{i:i,form:e,total:n}),"Discount Type":(0,l.jsx)(_.r,{styles:{track:{fontWeight:600,fontSize:14},trackLabel:{minWidth:"7rem"}},onLabel:"Percentage",offLabel:"Amount",size:"xl",defaultChecked:s.defaultValue,...s},e.key("commissions.".concat(i,".isPercentage"))),"PC Payment":(0,l.jsx)(m.Box,{className:V().box,bg:"#D9e2ed",children:(0,l.jsx)(eG,{i:i,form:e,total:n})})}});return{testCommissionControls:(0,l.jsx)(J.i,{fz:"md",w:"auto",className:"text-wrap",children:(0,l.jsx)(J.i.Tbody,{children:["Test","Total Amount","PC Commission","Discount Type","PC Payment"].map((e,i)=>{let n=i?J.i.Td:J.i.Th;return(0,l.jsxs)(J.i.Tr,{children:[(0,l.jsx)(J.i.Th,{w:"10rem",children:e}),null==t?void 0:t.map(t=>(0,l.jsx)(n,{w:"10rem",children:t[e]},t.id))]},e)})})})}},[x,I,P,w]),N=(0,n.T)(),[Z,F]=(0,C.useState)(!1),E=(0,C.useRef)(!0);return c?(0,l.jsx)(U.Z,{}):v?(0,l.jsx)("div",{className:"p-3 text-center",children:"An error occurred"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("form",{onWheel:eR,className:V().bottom,onSubmit:D.onSubmit(async e=>{if(Z||!b||!P)return;F(!0);let{success:t,data:i}=await eZ(r,{bills:b.map(e=>{let{id:t}=e;return{id:t}}),isPaid:E.current,commissions:e.commissions.map((e,t)=>({testId:P[t].id,commission:e.commission,commissionType:e.isPercentage?"percentage":"amount"}))});E.current=!0,t?(await h(),await new Promise(e=>setTimeout(e,500)),T()):O().fire("Error",i||"Invalid Server Response","error"),F(!1)}),children:[(0,l.jsxs)(s.Stack,{className:"".concat(V().upper," rounded-3 p-2"),bg:"#c3d5ed",children:[(0,l.jsx)(J.i,{fz:"md",withRowBorders:!1,children:(0,l.jsxs)(J.i.Tbody,{children:[(0,l.jsxs)(J.i.Tr,{children:[(0,l.jsx)(J.i.Th,{children:"Payable"}),(0,l.jsx)(J.i.Td,{ta:"right",children:D.isDirty()?g:A})]}),(0,l.jsxs)(J.i.Tr,{children:[(0,l.jsx)(J.i.Th,{children:"Discount"}),(0,l.jsx)(J.i.Td,{ta:"right",children:S||0})]}),(0,l.jsxs)(J.i.Tr,{style:{borderTop:"1px solid #0000003F"},children:[(0,l.jsx)(J.i.Th,{children:"Total Commission"}),(0,l.jsx)(J.i.Td,{ta:"right",children:(D.isDirty()?g:A||0)-(S||0)})]})]})}),(0,l.jsxs)(a.Group,{justify:"space-between",mt:"auto",children:[(0,l.jsx)(u.Button,{type:"submit",radius:"sm",bg:"#FB9C48",onClick:()=>E.current=!1,disabled:Z&&E.current||(D.isDirty()?g:A||0)-(S||0)<=0,loading:Z&&!E.current,children:"Save to Expense"}),((null==x?void 0:null===(t=x.user)||void 0===t?void 0:t.role)==="admin"||(null==x?void 0:null===(i=x.diagnostic)||void 0===i?void 0:i.isPCSetPermission)&&(null==x?void 0:null===(o=x.user)||void 0===o?void 0:o.role)==="receptionist")&&(0,l.jsxs)(u.Button,{type:"submit",radius:"sm",bg:"#1A72E9",disabled:Z&&!E.current||(D.isDirty()?g:A||0)-(S||0)<=0,loading:Z&&E.current,children:["Pay Commission ",(0,l.jsx)("br",{})," Now"]})]})]}),z]}),(0,l.jsx)("div",{ref:j,children:(0,l.jsx)(er.V,{pcId:r})},y)]})}function eR(e){0==e.deltaX&&(e.preventDefault(),e.currentTarget.scrollBy({left:e.deltaY>0?50:-50}))}function eL(e){let{i:t,form:i,total:n}=e,[,s]=(0,C.useReducer)(e=>~e,0),{isPercentage:o}=i.getValues().commissions[t];return i.watch("commissions.".concat(t,".isPercentage"),s),(0,l.jsx)(F.Y,{rightSection:(0,l.jsx)(l.Fragment,{}),min:0,max:o?100:n,radius:"md",size:"md",suffix:o?"%":void 0,...i.getInputProps("commissions.".concat(t,".commission"))},i.key("commissions.".concat(t,".commission")))}function eG(e){let{i:t,form:i,total:l}=e,[,n]=(0,C.useReducer)(e=>~e,0),{commission:s,isPercentage:o}=i.getValues().commissions[t];return i.watch("commissions.".concat(t,".commission"),n),i.watch("commissions.".concat(t,".isPercentage"),n),o?l/100*s:s}var eO=i(79335),eW=()=>{var e,t,i,w,S,I;let A;let B=(0,n.C)(e=>{var t;return null===(t=e.bills)||void 0===t?void 0:t.allBills}),[D,k]=(0,C.useState)(!1),[z,N]=(0,C.useState)(4e3),[M,Z]=(0,C.useState)([new Date(2024,1,20),new Date]),F=(0,n.C)(e=>e.auth),_=(0,C.useRef)(null),E=(0,C.useRef)(null),[R,L]=(0,C.useState)(null),G=()=>{var e,t;let i=0;return null==B||null===(t=B.items)||void 0===t||null===(e=t.bills)||void 0===e||e.forEach(e=>{i+=e.totalAmountWithDiscount}),Math.floor(i)},[O,W]=(0,C.useState)(!1);return(0,l.jsx)("div",{className:V().container,children:(0,l.jsxs)(s.Stack,{gap:"md",children:[(0,l.jsx)(o.X,{shadow:"xs",p:"md",radius:"md",withBorder:!0,children:(0,l.jsxs)(s.Stack,{gap:"md",children:[(0,l.jsxs)(a.Group,{justify:"space-between",align:"center",wrap:"wrap",children:[(0,l.jsxs)(a.Group,{gap:"md",children:[(0,l.jsx)(r.k,{size:"xl",radius:"md",variant:"gradient",gradient:{from:"blue",to:"cyan"},children:(0,l.jsx)(p.Z,{size:24})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d.Title,{order:2,fw:600,size:"h3",children:"PC Commission Management"}),(0,l.jsx)(c.Text,{size:"xs",c:"dimmed",children:"Manage and process PC commissions efficiently"})]})]}),(0,l.jsx)(u.Button,{component:j.default,href:"/billing",leftSection:(0,l.jsx)(x.Z,{size:20}),radius:"md",variant:"filled",className:V().responsiveButton,children:"Create New Bill"})]}),R&&(0,l.jsx)(m.Box,{children:(0,l.jsx)(v.C,{size:"lg",variant:"gradient",gradient:{from:"teal",to:"lime",deg:105},leftSection:(0,l.jsx)(p.Z,{size:16}),children:R.name})})]})}),(0,l.jsx)(m.Box,{className:"bg-white rounded-3 py-3",children:(0,l.jsx)(T.Z,{fluid:!0,children:(0,l.jsxs)(b.default,{className:"gy-3 gx-3",children:[(0,l.jsx)(P.default,{xs:12,sm:6,lg:4,children:(0,l.jsx)(eO.StatCard,{icon:(0,l.jsx)(g.Z,{size:24}),title:"Total Bill",value:(null==B?void 0:B.totalItems)||0,color:"blue",iconBg:"blue",isCurrency:!1})}),(0,l.jsx)(P.default,{xs:12,sm:6,lg:4,children:(0,l.jsx)(eO.StatCard,{icon:(0,l.jsx)(f.Z,{size:24}),title:"Sub Total",color:"green",value:G().toString(),iconBg:"green",isCurrency:!0})}),(0,l.jsx)(P.default,{xs:12,sm:12,lg:4,children:(0,l.jsx)(eO.StatCard,{icon:(0,l.jsx)(y.Z,{size:20}),title:"Discount",color:"orange",value:(A=0,null==B||null===(I=B.items)||void 0===I||null===(S=I.bills)||void 0===S||S.forEach(e=>{A+=e.totalAmout}),Math.floor(A)-G()).toString(),iconBg:"orange",isCurrency:!0})})]})})}),(0,l.jsx)(h.Space,{h:5}),(0,l.jsx)(m.Box,{style:{overflowX:"auto"},children:(0,l.jsx)(eM,{dates:M,setDates:Z,keyCount:z,setKeyCount:N,isSubmitting:D,setIsSubmitting:k,payCommissionBtnRef:E,printButtonRef:_,selectedObject:R,setPcCommissionVisible:W,setSelectedObject:L})}),O&&R&&((null==F?void 0:null===(e=F.user)||void 0===e?void 0:e.role)==="admin"||(null==F?void 0:null===(t=F.diagnostic)||void 0===t?void 0:t.isPCSetPermission)&&(null==F?void 0:null===(i=F.user)||void 0===i?void 0:i.role)==="receptionist")&&(0,l.jsx)(m.Box,{mt:"md",children:(null===(w=F.diagnostic)||void 0===w?void 0:w.isPCPaymentPerTest)?(0,l.jsx)(eE,{pcId:R.id}):(0,l.jsx)(q,{dates:M,keyCount:z,setKeyCount:N,isSubmitting:D,setIsSubmitting:k,payCommissionBtnRef:E,printButtonRef:_,selectedObject:R},z)})]})})}},10975:function(e,t,i){"use strict";i.d(t,{V:function(){return f}});var l=i(68328),n=i(25499),s=i(75540),o=i(88531),a=i(29593),r=i(22614),d=i(41224),c=i(22041),u=i(54632),m=i(97698),v=i(4505),h=i(71256),p=i(7203),x=i(75326),g=i.n(x);function f(e){var t,i,x,f,y,j,C,T,b,P,w,S,I,A,B,D;let{pcId:k,transactionBillIds:z,transactionCommissions:N,transactionTotalAmount:M,transactionPaidAmount:Z}=e,{data:F,isLoading:_,refetch:E,isError:R}=(0,s.h2)(k,{refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0});(0,v.useEffect)(()=>{console.log("refetch"),E()},[]);let{data:L,isLoading:G}=(0,s.Uc)(k,{refetchOnMountOrArgChange:!0}),O=(0,n.C)(e=>{var t;return null==e?void 0:null===(t=e.bills)||void 0===t?void 0:t.selectedBills}),W=(0,n.C)(e=>e.auth),[V,U]=(0,v.useState)(0),{selectedBills:q,totalAmountsByTestID:H,tests:Q,totals:K,totalDiscount:X,totalPatientIds:Y,lastPaidCommissions:J,initialCommissions:$}=(0,v.useMemo)(()=>{var e,t,i,l,n,s,o,a,r;if(!F)return{};let d=z||(null==O?void 0:O.map(e=>e.billId)),c=new Set(d),u=null==F?void 0:null===(t=F.data)||void 0===t?void 0:null===(e=t.bills)||void 0===e?void 0:e.filter(e=>c.has(e.billId)),m=new Map,v=new Map;for(let e of u)for(let t of null==e?void 0:e.tests)if(t.testId){m.set(t.testId,(m.get(t.testId)||0)+((null==W?void 0:null===(a=W.diagnostic)||void 0===a?void 0:a.isTestDiscountIncludeInBill)?t.price:"amount"===t.discountType?t.price-t.discount:t.price*(1-t.discount/100)));let i=[...null!==(r=v.get(t.testId))&&void 0!==r?r:[],e.patient.patientId.toString()];v.set(t.testId,i)}let h=null==F?void 0:null===(l=F.data)||void 0===l?void 0:null===(i=l.tests)||void 0===i?void 0:i.filter(e=>m.get(e.id)),p=null==h?void 0:h.map(e=>m.get(e.id)||0),x=N?new Map(N.map(e=>[e.testId||e.testCategoryId,[e.commission,e.commissionType]])):(null==W?void 0:null===(n=W.diagnostic)||void 0===n?void 0:n.isPCSamePayment)?void 0:new Map(null==F?void 0:null===(o=F.data)||void 0===o?void 0:null===(s=o.percentages)||void 0===s?void 0:s.map(e=>[e.testId,[e.discount,e.discountType]])),g=h.map(e=>{var t;let[i,l]=N?(null==x?void 0:x.get(e.id))||[]:(null==W?void 0:null===(t=W.diagnostic)||void 0===t?void 0:t.isPCSamePayment)?[e.pcAmount,e.pcAmountType]:(null==x?void 0:x.get(e.id))||[];return{commission:i||0,isPercentage:"amount"!==l}}),f=null!=M?M:Math.floor(g.reduce((e,t,i)=>e+(t.isPercentage?t.commission*(((null==p?void 0:p[i])||0)/100):t.commission),0));U(f);let y=M&&Z?M-Z:null==u?void 0:u.reduce((e,t)=>e+t.totalAmout-t.totalAmountWithDiscount,0);return{selectedBills:u,totalAmountsByTestID:m,tests:h,totalDiscount:y,totals:p,totalPatientIds:v,lastPaidCommissions:x,initialCommissions:f}},[W,F,O,z,N,M,Z]);return _||G?(0,l.jsx)(p.Z,{}):R?(0,l.jsx)("div",{className:"p-3 text-center",children:"An error occurred"}):(0,l.jsxs)("div",{className:"p-4 hidden-print",children:[(0,l.jsx)(h.Z,{diagnostic:W.diagnostic}),(0,l.jsx)(a.Space,{h:10}),(0,l.jsxs)(r.Group,{align:"start",justify:"space-between",children:[(0,l.jsxs)(d.Stack,{gap:1,children:[(0,l.jsxs)(c.Text,{children:["Pc Name :"," ",(0,l.jsx)(c.Text,{component:"span",fw:600,children:null==L?void 0:null===(t=L.data)||void 0===t?void 0:t.name})]}),(null==L?void 0:null===(i=L.data)||void 0===i?void 0:i.fathersName)&&(null==L?void 0:null===(f=L.data)||void 0===f?void 0:null===(x=f.fathersName)||void 0===x?void 0:x.length)>1?(0,l.jsxs)(c.Text,{children:["Father","'"," s Name : ",null==L?void 0:null===(y=L.data)||void 0===y?void 0:y.fathersName]}):(0,l.jsx)(l.Fragment,{}),(null==L?void 0:null===(j=L.data)||void 0===j?void 0:j.mobile)&&(null==L?void 0:null===(T=L.data)||void 0===T?void 0:null===(C=T.mobile)||void 0===C?void 0:C.length)>1?(0,l.jsxs)(c.Text,{children:["Phone: ",null==L?void 0:null===(b=L.data)||void 0===b?void 0:b.mobile]}):(0,l.jsx)(l.Fragment,{}),(null==L?void 0:null===(P=L.data)||void 0===P?void 0:P.address)&&(null==L?void 0:null===(S=L.data)||void 0===S?void 0:null===(w=S.address)||void 0===w?void 0:w.length)>1?(0,l.jsxs)(c.Text,{children:["Address : ",null==L?void 0:null===(I=L.data)||void 0===I?void 0:I.address,", ",null==L?void 0:null===(A=L.data)||void 0===A?void 0:A.thana," ,",null==L?void 0:null===(B=L.data)||void 0===B?void 0:B.district]}):(0,l.jsx)(l.Fragment,{})]}),(0,l.jsxs)(c.Text,{children:["Date:"," ",(0,l.jsx)(c.Text,{component:"span",fw:600,children:(0,m.Z)(new Date,"dd-MMM-yyyy")})," "]})]}),(0,l.jsxs)(u.i,{className:g().table,children:[(0,l.jsxs)(u.i.Thead,{children:[(0,l.jsx)(u.i.Th,{style:{textAlign:"center"},children:"Test Name"}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center"},children:"(P.ID)s"}),(0,l.jsxs)(u.i.Th,{style:{textAlign:"center"},children:["Commission ",(0,l.jsx)("br",{})," Rate"]})," ",(0,l.jsx)(u.i.Th,{style:{textAlign:"center"},children:"Qty"})," ",(0,l.jsx)(u.i.Th,{style:{textAlign:"center"},children:"Actual Price"}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center"},children:"Total Commission"})]}),(0,l.jsxs)(u.i.Tbody,{children:[null==Q?void 0:Q.map(e=>{var t,i,n,s,o,a,r,d;return(0,l.jsxs)(u.i.Tr,{children:[(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"30%"},children:e.name}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"30%"},children:null==Y?void 0:null===(t=Y.get(e.id))||void 0===t?void 0:t.map(e=>(0,l.jsxs)("span",{children:[e," ,"]},e))}),(0,l.jsxs)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:[null==J?void 0:null===(i=J.get(e.id))||void 0===i?void 0:i[0],"(",(null==J?void 0:null===(n=J.get(e.id))||void 0===n?void 0:n[1])==="amount"?"TK":"%",")"]})," ",(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:null==Y?void 0:null===(s=Y.get(e.id))||void 0===s?void 0:s.length})," ",(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:H.get(e.id)}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:(null==J?void 0:null===(o=J.get(e.id))||void 0===o?void 0:o[1])==="amount"?null==J?void 0:null===(r=J.get(e.id))||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:a.toLocaleString():Math.floor((H.get(e.id)||0)*(((null==J?void 0:null===(d=J.get(e.id))||void 0===d?void 0:d[0])||0)/100)).toLocaleString()})]},e.id)})," ",(0,l.jsxs)(u.i.Tr,{children:[(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"30%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"30%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"10%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"10%"},children:" "}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:"Total Comm."}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:($||0).toLocaleString()})]}),(0,l.jsxs)(u.i.Tr,{children:[(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"30%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"30%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"10%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"10%"},children:" "}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:"Less"}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:(X||0).toLocaleString()})]}),(0,l.jsxs)(u.i.Tr,{children:[(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"30%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"30%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"10%"}}),(0,l.jsx)(u.i.Td,{style:{textAlign:"center",width:"10%"},children:" "}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:"Paid Comm."}),(0,l.jsx)(u.i.Th,{style:{textAlign:"center",width:"10%"},children:(($||0)-(X||0)).toLocaleString()})]})]})]}),(0,l.jsx)(a.Space,{h:20}),(0,l.jsxs)(c.Text,{children:["In Words:"," ",(0,l.jsxs)(c.Text,{tt:"capitalize",component:"span",fw:600,children:[(0,o.V)(($||0)-(X||0))," TK"]})," "]}),(0,l.jsxs)(c.Text,{tt:"capitalize",children:["Printed By:"," ",(0,l.jsx)(c.Text,{tt:"capitalize",component:"span",fw:600,children:null==W?void 0:null===(D=W.user)||void 0===D?void 0:D.name})," "]}),(0,l.jsxs)(c.Text,{tt:"capitalize",children:["Printed At:"," ",(0,l.jsx)(c.Text,{tt:"capitalize",component:"span",fw:600,children:(0,m.Z)(new Date,"dd-MMM-yyyy:hh-mm a")})," "]}),(0,l.jsxs)(c.Text,{className:"",style:{position:"absolute",bottom:0,left:0,right:0,textAlign:"center"},children:["Powered By"," ",(0,l.jsx)(c.Text,{component:"span",fw:600,children:"sasthotech.com"})," "]})]})}},64687:function(e,t,i){"use strict";i.d(t,{u:function(){return o}});var l=i(72940),n=i(6780),s=i(67732);let o=async()=>{try{let e=await n.default.get("".concat("http://sasthotech.local:5000/api/v1","/admin/marketer"),l.FD);return{success:!0,data:e.data.data}}catch(t){if(t instanceof s.d7){var e;return{success:!1,data:null===(e=t.response)||void 0===e?void 0:e.data.message}}return{success:!1,data:"An error occurred"}}}},16201:function(e,t,i){"use strict";i.d(t,{C4:function(){return s},GU:function(){return r},WH:function(){return c},Yr:function(){return o},ZR:function(){return d},iw:function(){return u},kd:function(){return a},sI:function(){return n},tG:function(){return m}});let l=(0,i(79258).createSlice)({name:"diagnostic",initialState:{receptionist:[],diagnostics:[],pathologist:[],marketer:[]},reducers:{setReceptionist:(e,t)=>{Array.isArray(t.payload)?e.receptionist=t.payload:e.receptionist=[...e.receptionist,t.payload]},removeReceptionist:(e,t)=>{e.receptionist=e.receptionist.filter(e=>e.id!==t.payload)},setPathologist:(e,t)=>{Array.isArray(t.payload)?e.pathologist=t.payload:e.pathologist=[...e.pathologist,t.payload]},setMarketer:(e,t)=>{Array.isArray(t.payload)?e.marketer=t.payload:e.marketer=[...e.marketer,t.payload]},removeMarketer:(e,t)=>{e.marketer=e.marketer.filter(e=>e.id!==t.payload)},removePathologist:(e,t)=>{e.pathologist=e.pathologist.filter(e=>e.id!==t.payload)},setPathologistCategory:(e,t)=>{let{payload:{userId:i,categoryIds:l}}=t,n=e.pathologist.find(e=>e.id!==i);n&&(n.userTestCategory=l)},setDiagnosticList:(e,t)=>{Array.isArray(t.payload)?e.diagnostics=t.payload:e.diagnostics=[...e.diagnostics,t.payload]},removeFromDiagnosticLists:(e,t)=>{e.diagnostics=e.diagnostics.filter(e=>e.id!==t.payload)}}}),{setReceptionist:n,removeReceptionist:s,setDiagnosticList:o,removeFromDiagnosticLists:a,setPathologist:r,setMarketer:d,removeMarketer:c,removePathologist:u,setPathologistCategory:m}=l.actions;t.ZP=l.reducer},75540:function(e,t,i){"use strict";i.d(t,{JC:function(){return o},K0:function(){return s},Nr:function(){return v},Uc:function(){return c},Vi:function(){return f},db:function(){return d},ey:function(){return r},fR:function(){return a},h2:function(){return u},hC:function(){return p},js:function(){return g},pL:function(){return h},s:function(){return m}});var l=i(78101);let n=l.g.injectEndpoints({endpoints:e=>({getPCs:e.query({query:e=>{let{page:t=1,limit:i=10,search:l=""}=e||{},n=new URLSearchParams;return n.append("page",t.toString()),n.append("limit",i.toString()),l&&n.append("search",l),{url:"/pc?".concat(n.toString())}},keepUnusedDataFor:60}),getPCsPaginated:e.query({query:e=>{let{page:t=1,limit:i=10,search:l=""}=e||{},n=new URLSearchParams;return n.append("page",t.toString()),n.append("limit",i.toString()),l&&n.append("search",l),{url:"/pc/paginated?".concat(n.toString())}},keepUnusedDataFor:60}),createPC:e.mutation({query:e=>({url:"/pc",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:i,queryFulfilled:n}=t;try{await n,i(l.g.util.invalidateTags(["PC"]))}catch(e){}}}),updatePC:e.mutation({query:e=>{let{id:t,name:i,percentage:l,fathersName:n,mobile:s,thana:o,address:a,district:r}=e;return{url:"/pc/".concat(t),method:"PATCH",body:{name:i,percentage:l,fathersName:n,mobile:s,thana:o,address:a,district:r}}},async onQueryStarted(e,t){let{dispatch:i,queryFulfilled:n}=t;try{await n,i(l.g.util.invalidateTags(["PC"]))}catch(e){}}}),deletePC:e.mutation({query:e=>({url:"/pc/".concat(e),method:"DELETE"}),async onQueryStarted(e,t){let{dispatch:i,queryFulfilled:n}=t;try{await n,i(l.g.util.invalidateTags(["PC"]))}catch(e){}}}),getSinglePC:e.query({query:e=>({url:"/pc/".concat(e)})}),getSinglePCTests:e.query({query:e=>({url:"/pc/".concat(e,"/tests")})}),getPCCodeSettings:e.query({query:()=>({url:"/diagnostic/pc-code-settings"})}),updatePCCodeSettings:e.mutation({query:e=>({url:"/diagnostic/pc-code-settings",method:"PATCH",body:e}),async onQueryStarted(e,t){let{dispatch:i,queryFulfilled:l}=t;try{let{data:e}=await l;i(n.util.updateQueryData("getPCCodeSettings",void 0,t=>{Object.assign(t.data,e.data)}))}catch(e){}}}),bulkCreatePCs:e.mutation({query:e=>({url:"/pc/bulk-create",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:i,queryFulfilled:n}=t;try{await n,i(l.g.util.invalidateTags(["PC"]))}catch(e){}}}),bulkAssignCodes:e.mutation({query:()=>({url:"/pc/bulk-assign-codes",method:"POST"}),async onQueryStarted(e,t){let{dispatch:i,queryFulfilled:n}=t;try{await n,i(l.g.util.invalidateTags(["PC"]))}catch(e){}}}),previewSyncCodes:e.query({query:()=>({url:"/pc/sync-codes/preview"})}),syncCodes:e.mutation({query:()=>({url:"/pc/sync-codes",method:"POST"}),async onQueryStarted(e,t){let{dispatch:i,queryFulfilled:n}=t;try{await n,i(l.g.util.invalidateTags(["PC"]))}catch(e){}}})})}),{useGetPCsQuery:s,useGetPCsPaginatedQuery:o,useCreatePCMutation:a,useUpdatePCMutation:r,useDeletePCMutation:d,useGetSinglePCQuery:c,useGetSinglePCTestsQuery:u,useGetPCCodeSettingsQuery:m,useUpdatePCCodeSettingsMutation:v,useBulkCreatePCsMutation:h,useBulkAssignCodesMutation:p,usePreviewSyncCodesQuery:x,useLazyPreviewSyncCodesQuery:g,useSyncCodesMutation:f}=n},57974:function(e){e.exports={filterSection:"PcCommissionFilters_filterSection__4OEiC",filterContainer:"PcCommissionFilters_filterContainer__0pEOC",filterIcon:"PcCommissionFilters_filterIcon__IpR5x",filterTitle:"PcCommissionFilters_filterTitle__kvYjf",filterGrid:"PcCommissionFilters_filterGrid__7ZHfK",filterItem:"PcCommissionFilters_filterItem__lX_Eg",filterItemIcon:"PcCommissionFilters_filterItemIcon__AnAsU",selectInput:"PcCommissionFilters_selectInput__lkMUc",dateGroup:"PcCommissionFilters_dateGroup__XZ_Vb",dateInput:"PcCommissionFilters_dateInput__z7d_e",datePresetInput:"PcCommissionFilters_datePresetInput__o6jrH",pcOption:"PcCommissionFilters_pcOption__7HIBW",pcCode:"PcCommissionFilters_pcCode__S18F8",activeFilters:"PcCommissionFilters_activeFilters__kLESI",filterChip:"PcCommissionFilters_filterChip__6v9JU"}}},function(e){e.O(0,[1601,2975,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,1166,7967,6029,154,6306,7698,7186,4927,1493,9669,7140,2505,4507,8241,9335,9175,7402,1744],function(){return e(e.s=73130)}),_N_E=e.O()}]);