(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5295],{19476:function(e,t,n){Promise.resolve().then(n.bind(n,4712))},4712:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eC}});var i=n(68328),o=n(4505),l=n(34473),s=n(53729),a=n(41224),d=n(16391),r=n(68242),c=n(22041),u=n(87967),m=n(29259),p=n(77052),h=n(7965),x=n(29013),v=n(67781),f=n(33908),j=n.n(f),y=n(12450),g=n(25922),b=n(25621),w=n(36409),S=n(89043),C=n(32451),T=n(77303),N=n(31204),A=n(54632),z=n(7140),D=n(22975),P=n(73427),B=n(46557),I=n(65850),k=n(25499),F=n(62549),M=n(26809),G=n(84153);I.Zx.register({family:"NotoSans",fonts:[{src:"/fonts/NotoSans/NotoSans_Condensed-Regular.ttf"},{src:"/fonts/NotoSans/NotoSans-Bold.ttf",fontWeight:"bold"},{src:"/fonts/NotoSans/NotoSans-Italic.ttf",fontStyle:"italic"},{src:"/fonts/NotoSans/NotoSans-BoldItalic.ttf",fontWeight:"bold",fontStyle:"italic"},{src:"/fonts/NotoSans/NotoSans-Black.ttf",fontWeight:900},{src:"/fonts/NotoSans/NotoSans-ExtraBold.ttf",fontWeight:800},{src:"/fonts/NotoSans/NotoSans_Condensed-SemiBold.ttf",fontWeight:600},{src:"/fonts/NotoSans/NotoSans_Condensed-Medium.ttf",fontWeight:500},{src:"/fonts/NotoSans/NotoSans_Condensed-Light.ttf",fontWeight:300},{src:"/fonts/NotoSans/NotoSans_Condensed-Thin.ttf",fontWeight:100}]});let W=I.mM.create({page:{padding:10,fontFamily:"NotoSans"},table:{width:"100%",borderStyle:"solid",borderWidth:1,borderRightWidth:0,borderBottomWidth:0,fontFamily:"NotoSans"},tableRow:{flexDirection:"row"},tableCol:{width:"12.5%",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,padding:5,fontSize:10,textAlign:"center"},tableHeader:{fontWeight:"bold",textAlign:"center",backgroundColor:"#f8f9fa"},slotTitle:{fontSize:16,fontWeight:"bold",marginBottom:10,textAlign:"center",fontFamily:"NotoSans"},doctorInfo:{fontSize:14,marginBottom:15,textAlign:"center",fontWeight:"bold",fontFamily:"NotoSans"},paymentSummaryTitle:{fontSize:18,fontWeight:"bold",marginBottom:15,textAlign:"center",color:"#333",fontFamily:"NotoSans"},paymentSummaryText:{fontSize:12,marginBottom:6,fontFamily:"NotoSans"},paymentSummaryBold:{fontWeight:"bold",fontFamily:"NotoSans"}});var R=e=>{let{slotData:t,doctorInfo:n}=e,o=(0,k.C)(e=>e.auth.user),l=(0,k.C)(e=>e.auth.diagnostic),s={name:(null==l?void 0:l.name)||"",address:(null==l?void 0:l.address)||"",phone1:(null==l?void 0:l.phone1)||"",phone2:(null==l?void 0:l.phone2)||"",division:(null==l?void 0:l.division)||"",logo:(null==l?void 0:l.logo)||"",id:(null==l?void 0:l.id)||"",city:(null==l?void 0:l.city)||"",paymentDate:(null==l?void 0:l.paymentDate)||"",admin:(null==l?void 0:l.admin)||""},a="সকাল"==t.slotName?"Morning":"সন্ধ্যা"==t.slotName?"Evening":t.slotName,d=(0,k.C)(e=>e.dates),r=null==o?void 0:o.name,c=(()=>{let e=(null==t?void 0:t.appointments)||[],n=e.reduce((e,t)=>e+(t.finalFee||t.fee||0),0),i=e.reduce((e,t)=>e+(t.paidAmount||0),0),o=e.reduce((e,t)=>e+(t.pcAmount||0),0);return{totalPayable:n,totalPaid:i,totalPcAmount:o,fullPaidCount:e.filter(e=>!0===e.isPaid).length,partialPaidCount:e.filter(e=>e.paidAmount>0&&e.paidAmount<(e.finalFee||e.fee||0)).length,unpaidCount:e.filter(e=>!e.paidAmount||0===e.paidAmount).length,totalAppointments:e.length}})(),u=()=>{var e,o;return(0,i.jsx)(I.BB,{children:(0,i.jsxs)(I.T3,{size:"A4",style:W.page,children:[(0,i.jsx)(F.default,{diagnosticState:s}),(0,i.jsx)(M.Z,{small:!1,dates:d,userName:null!=r?r:""}),(0,i.jsxs)(I.xv,{style:W.doctorInfo,children:["Doctor: ",null==n?void 0:n.name," - ",null==n?void 0:n.designation]}),(0,i.jsxs)(I.xv,{style:W.slotTitle,children:[a," Appointments"]}),(0,i.jsxs)(I.xv,{style:{fontSize:10,marginBottom:10,fontFamily:"NotoSans"},children:["Total Appointments: ",(null==t?void 0:null===(e=t.appointments)||void 0===e?void 0:e.length)||0]}),(0,i.jsxs)(I.G7,{style:{marginBottom:15,padding:12,borderStyle:"solid",borderWidth:1,borderColor:"#ddd",backgroundColor:"#f9f9f9"},children:[(0,i.jsx)(I.xv,{style:W.paymentSummaryTitle,children:"Payment Summary"}),(0,i.jsxs)(I.G7,{style:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:10},children:[(0,i.jsxs)(I.G7,{style:{width:"50%",paddingRight:10},children:[(0,i.jsxs)(I.xv,{style:W.paymentSummaryText,children:["Total Payable:"," ",(0,i.jsx)(I.xv,{style:W.paymentSummaryBold,children:c.totalPayable})]}),(0,i.jsxs)(I.xv,{style:W.paymentSummaryText,children:["Total Paid:"," ",(0,i.jsx)(I.xv,{style:W.paymentSummaryBold,children:c.totalPaid})]}),(0,i.jsxs)(I.xv,{style:W.paymentSummaryText,children:["Total PC Amount:"," ",(0,i.jsx)(I.xv,{style:W.paymentSummaryBold,children:c.totalPcAmount})]})]}),(0,i.jsxs)(I.G7,{style:{width:"50%",paddingLeft:10},children:[(0,i.jsxs)(I.xv,{style:[W.paymentSummaryText,{textAlign:"right"}],children:["Full Paid:"," ",(0,i.jsx)(I.xv,{style:W.paymentSummaryBold,children:c.fullPaidCount})," ","appointments"]}),(0,i.jsxs)(I.xv,{style:[W.paymentSummaryText,{textAlign:"right"}],children:["Partial Paid:"," ",(0,i.jsx)(I.xv,{style:W.paymentSummaryBold,children:c.partialPaidCount})," ","appointments"]}),(0,i.jsxs)(I.xv,{style:[W.paymentSummaryText,{textAlign:"right"}],children:["Unpaid:"," ",(0,i.jsx)(I.xv,{style:W.paymentSummaryBold,children:c.unpaidCount})," ","appointments"]})]})]})]}),(0,i.jsxs)(I.G7,{style:W.table,children:[(0,i.jsxs)(I.G7,{style:[W.tableRow,W.tableHeader],children:[(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"10%"}],children:"Serial"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"20%"}],children:"Patient Name"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"15%"}],children:"Phone"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:"Type"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:"Status"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:"Time"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:"Paid Amount"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"16%"}],children:"PC Name"})]}),null==t?void 0:null===(o=t.appointments)||void 0===o?void 0:o.map(e=>{var t,n,o;return(0,i.jsxs)(I.G7,{style:W.tableRow,children:[(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"10%",textTransform:"uppercase"}],children:null==e?void 0:e.serialNo}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"20%"}],children:null==e?void 0:null===(t=e.patient)||void 0===t?void 0:t.name}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"15%"}],children:null==e?void 0:null===(n=e.patient)||void 0===n?void 0:n.phone}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:null==e?void 0:e.type}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:(null==e?void 0:e.isPaid)?"PAID":"DUE"}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:j()(null==e?void 0:e.timeOf).format("hh:mm A")}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"13%"}],children:null==e?void 0:e.paidAmount}),(0,i.jsx)(I.xv,{style:[W.tableCol,{width:"16%",fontSize:8}],children:(null==e?void 0:null===(o=e.pc)||void 0===o?void 0:o.name)?"".concat(e.pc.name).concat(e.pc.mobile&&""!==e.pc.mobile?"\n(".concat(e.pc.mobile,")"):"").concat((null==e?void 0:e.pcAmount)?"\n৳ ".concat(e.pcAmount):""):"N/A"})]},null==e?void 0:e.id)})]})]})})};return(0,i.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,i.jsx)(G.Z,{PDFTemplate:()=>(0,i.jsx)(u,{})})})},Z=n(13520),Y=n(75865),E=n(3741),L=n(77255),O=n(58185),_=n(42407),U=n(22614),H=n(25299);function q(e){let{opened:t,onClose:n,onConfirm:l}=e,[s,d]=(0,o.useState)(""),r=()=>{d(""),n()};return(0,i.jsx)(D.u,{opened:t,onClose:r,title:"Appointment Late Notification",size:"md",centered:!0,children:(0,i.jsxs)(a.Stack,{gap:"lg",children:[(0,i.jsx)(c.Text,{size:"sm",c:"dimmed",children:"Enter how many minutes the appointment will be delayed:"}),(0,i.jsx)(m.Y,{label:"Minutes Late",placeholder:"Enter minutes...",value:s,onChange:d,min:1,max:999,allowDecimal:!1,allowNegative:!1,suffix:" min","data-autofocus":!0}),(0,i.jsxs)(U.Group,{justify:"flex-end",gap:"sm",children:[(0,i.jsx)(N.Button,{variant:"subtle",onClick:r,children:"Cancel"}),(0,i.jsx)(N.Button,{onClick:()=>{!s||0>=Number(s)||H.qk.openConfirmModal({title:"Confirm Late Notification",children:(0,i.jsxs)(c.Text,{size:"sm",children:["Are you sure you want to notify that the appointments will be late by"," ",(0,i.jsxs)(c.Text,{component:"span",fw:600,children:[s," minute",1!==Number(s)?"s":""," "]}),"to all the patients?"]}),labels:{confirm:"Yes, Notify",cancel:"Cancel"},confirmProps:{color:"blue"},onConfirm:()=>{null==l||l(Number(s),()=>{r()})}})},disabled:!s||0>=Number(s),children:"Submit"})]})]})})}var V=n(72940),Q=n(6780),X=n(67732);let J=async e=>{try{let t=await Q.default.get("".concat("http://sasthotech.local:5000/api/v1","/appointment/late-notify"),{...V.FD,params:e});return{success:!0,data:t.data.data}}catch(e){if(e instanceof X.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}};var K=n(31151);function $(e){let{slot:t,doctorChamberId:n,refetch:o,selectedDate:l,onPrint:s,hasAppointments:a}=e,[d,{open:r,close:c}]=(0,B.q)(!1);async function u(e){let i=K.toast.loading("Sending Late Notification!...");console.log(t);try{await J({slotId:t.id,date:l,lateBy:e,doctorChamberId:n}),K.toast.success("Sent Late Notification!",{id:i}),o()}catch(e){console.log(e),K.toast.error("Failed to send Late Notification",{id:i})}}return(0,i.jsxs)(Y.v,{shadow:"md",width:200,children:[(0,i.jsx)(Y.v.Target,{children:(0,i.jsx)(E.A,{variant:"transparent",color:"black",size:"xs",children:(0,i.jsx)(L.Z,{size:16})})}),(0,i.jsxs)(Y.v.Dropdown,{children:[(0,i.jsx)(Y.v.Label,{children:"Appointment Options"}),(0,i.jsx)(Y.v.Item,{leftSection:(0,i.jsx)(O.Z,{size:14}),onClick:s,disabled:!a,children:"Print"}),(0,i.jsx)(Y.v.Item,{leftSection:(0,i.jsx)(_.Z,{size:14}),onClick:r,children:"Late Notify"})]}),(0,i.jsx)(q,{opened:d,onClose:c,onConfirm:u})]})}var ee=n(90777),et=n(48604),en=n(4923),ei=n(39467),eo=n(98542),el=n(49238),es=n(45437),ea=n(44135),ed=n(96657),er=n(30651);function ec(e){var t,n,o,l;let{appointment:s,doctor:a,slotName:d,doctorChamberId:r,onRefetch:c,opened:u,onClose:m}=e,{patient:p}=s,h=j()(s.timeOf).format("YYYY-MM-DD"),x=j()(s.timeOf).format("hh:mm A"),{data:v}=(0,g.ei)(r),f=async e=>{let t=K.toast.loading("Updating Appointment Details...");try{if(!p.patientId)throw Error();let{success:n}=await (0,er.b)(s.id,{pCId:e.pCId,name:e.fullName,gender:e.gender,address:e.address,district:e.district,thana:e.thana,pcAmount:e.pcAmount,phone:e.phoneNumber,ageYear:Number(e.age),type:e.appointmentType,paidAmount:e.paidAmount,discount:e.discount,discountType:e.discountType,patientId:p.patientId,tests:e.tests,isFeeIncluded:e.isFeeIncluded});if(n)K.toast.success("Appointment Details Updated Successfully!",{id:t}),c(),m();else throw Error()}catch(e){K.toast.error("Failed to update Appointment Details",{id:t})}};return u?(0,i.jsx)(ed.Z,{phoneDisabled:!0,title:"Edit Appointment",opened:u,onClose:m,date:h,doctorName:a.name,handleSubmit:f,sessionName:d,serialNo:s.serialNo,doctorChamberId:r,slotTime:x,payableAmount:{FIRST_VISIT:(null==v?void 0:null===(t=v.data)||void 0===t?void 0:t.newPatientFee)||999,OLD_VISIT:(null==v?void 0:null===(n=v.data)||void 0===n?void 0:n.oldPatientFee)||999},defaultData:{phone:p.phone,fullname:p.name,gender:p.gender||"male",age:p.ageYear.toString(),address:p.address||"",district:p.district||"",thana:p.thana||"",appointmentType:s.type,discount:s.discount,discountType:s.discountType,paidAmount:s.paidAmount,pcEnabled:!!s.pc,pCId:null===(o=s.pc)||void 0===o?void 0:o.id,pcAmount:null===(l=s.pcAmount)||void 0===l?void 0:l.toString(),tests:s.tests||[]}}):null}var eu=n(61683);function em(e){let[t,n]=(0,o.useState)(e.value),[l,s]=(0,o.useState)(!1),a=t!==e.value,d=(0,o.useRef)(null);return(0,i.jsxs)(C.Box,{style:{position:"relative"},children:[(0,i.jsx)(m.Y,{...e,value:t,onBlur:t=>{var i;a&&t.relatedTarget!==d.current&&n(e.value),null==e||null===(i=e.onBlur)||void 0===i||i.call(e,t)},onChange:t=>{var i;"function"==typeof e.valueModifier?n(n=>e.valueModifier(t,n)):n(t),null===(i=e.onChange)||void 0===i||i.call(e,t)},size:"xs",hideControls:!0,variant:"filled",radius:"md",clampBehavior:"strict",styles:{input:{fontWeight:500,fontSize:"0.875rem",height:"28px",borderRadius:4,backgroundColor:"var(--mantine-color-gray-1)"}}}),a&&(0,i.jsx)(N.Button,{ref:d,size:"sm",variant:"filled",color:"blue",loading:l,onClick:function(){var n;s(!0),null===(n=e.onUpdate)||void 0===n||n.call(e,t,()=>{s(!1)})},radius:"md",h:32,px:12,style:{position:"absolute",top:"35px",left:"50%",transform:"translateX(-50%)",fontSize:"0.8rem",lineHeight:1,zIndex:10,boxShadow:"rgba(50, 50, 93, 0.25) 0px 13px 27px -5px, rgba(0, 0, 0, 0.3) 0px 8px 16px -8px",minWidth:"70px"},children:"Update"})]})}function ep(e){let{appointment:t,onRefetch:n}=e,{id:o,isPaid:l,finalFee:s,paidAmount:a,patient:d}=t,r=async(e,t)=>{let i=K.toast.loading("Updating Payment Amount...");try{if(!d.patientId)throw Error();let{success:l}=await (0,er.b)(o,{paidAmount:e,patientId:d.patientId});if(l)K.toast.success("Amount Updated Successfully!",{id:i}),n(),t();else throw Error()}catch(e){K.toast.error("Failed to update payment amount",{id:i}),t()}finally{t()}};return(0,i.jsx)(em,{status:l?"Paid":"Unpaid",color:"orange",value:a,onUpdate:r,valueModifier:e=>{let t=Math.max(Number(e)||0,0),n=t>=s?s:t;return console.log({valueToReturn:n}),n},min:0,max:s,rightSection:(0,i.jsxs)(c.Text,{size:"xs",children:["/\xa0৳",s]}),maw:120,rightSectionProps:{style:{width:"max-content",paddingRight:"6px"}}})}var eh=n(71149),ex=n(69804);function ev(e){let{appointment:t,doctor:n,opened:o,onClose:l}=e,s=(0,eh.dB)();return(0,i.jsx)(D.u,{opened:o,onClose:l,size:"80%",radius:0,transitionProps:{transition:"fade",duration:200},title:"Appointment Token PDF",children:(()=>{var e;let o=null===(e=ex.m.find(e=>e.id===s))||void 0===e?void 0:e.Component;return o?(0,i.jsx)(o,{appointment:t,doctor:n}):null})()})}var ef=n(14803);let ej=e=>{var t,n,l,s,d;let{appointment:r,onRefetch:u,slotName:m,doctorChamberId:p,doctor:h}=e,[x,v]=(0,o.useState)(!1),{opened:f,open:y,close:g}=(0,ef.Q)("card_appointmentModal"+(null==r?void 0:r.id)),[b,{open:w,close:S}]=(0,B.q)(!1),N=async e=>{let t=await (0,ee.G)(e);(null==t?void 0:t.success)?(K.toast.success("Appointment deleted successfully."),u()):K.toast.error("Failed to delete appointment.")};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(et.Z,{withBorder:!1,shadow:"none",radius:0,p:0,style:{borderBottom:"1px solid var(--mantine-color-gray-3)"},children:[(0,i.jsx)(en.k,{onClick:()=>v(e=>!e),w:"100%",p:"md",children:(0,i.jsxs)(U.Group,{justify:"space-between",align:"center",wrap:"nowrap",children:[(0,i.jsxs)(U.Group,{gap:"xs",wrap:"nowrap",children:[(0,i.jsx)(c.Text,{fw:600,size:"md",c:"dimmed",children:null==r?void 0:null===(n=r.serialNo)||void 0===n?void 0:null===(t=n.toString())||void 0===t?void 0:t.toUpperCase()}),(0,i.jsxs)(a.Stack,{gap:0,children:[(0,i.jsx)(c.Text,{fw:600,lineClamp:2,lh:1.2,children:null==r?void 0:null===(l=r.patient)||void 0===l?void 0:l.name}),(0,i.jsxs)(c.Text,{size:"xs",c:"dimmed",children:[j()(null==r?void 0:r.timeOf).format("hh:mm A")," •"," ",(null==r?void 0:r.isPaid)?"Paid":"Due"]})]})]}),(0,i.jsxs)(U.Group,{gap:"xs",wrap:"nowrap",miw:"100px",children:[(0,i.jsx)(eu.O,{appointment:r,onRefetch:u}),x?(0,i.jsx)(eo.Z,{size:18}):(0,i.jsx)(el.Z,{size:18})]})]})}),(0,i.jsx)(ei.U,{in:x,children:(0,i.jsxs)(C.Box,{p:"md",pt:0,children:[(0,i.jsx)(T.Divider,{mb:"sm"}),(0,i.jsxs)(a.Stack,{gap:"sm",children:[(0,i.jsxs)(U.Group,{justify:"space-between",children:[(0,i.jsx)(c.Text,{size:"sm",c:"dimmed",children:"Patient Number"}),(0,i.jsx)(c.Text,{size:"sm",children:null==r?void 0:null===(s=r.patient)||void 0===s?void 0:s.phone})]}),(0,i.jsxs)(U.Group,{justify:"space-between",children:[(0,i.jsx)(c.Text,{size:"sm",c:"dimmed",children:"Payment Status"}),(0,i.jsx)(ep,{appointment:r,onRefetch:u})]}),(0,i.jsxs)(U.Group,{justify:"space-between",children:[(0,i.jsx)(c.Text,{size:"sm",c:"dimmed",children:"PC Name"}),(0,i.jsx)(c.Text,{size:"sm",children:(null==r?void 0:null===(d=r.pc)||void 0===d?void 0:d.name)||"N/A"})]}),(0,i.jsxs)(U.Group,{justify:"space-between",children:[(0,i.jsx)(c.Text,{size:"sm",c:"dimmed",children:"PC Amount"}),(0,i.jsx)(c.Text,{size:"sm",children:null==r?void 0:r.pcAmount})]}),(0,i.jsx)(T.Divider,{my:"xs"}),(0,i.jsxs)(U.Group,{justify:"flex-end",gap:"xs",children:[(0,i.jsx)(E.A,{size:"lg",variant:"light",color:"blue",onClick:e=>{e.stopPropagation(),y()},children:(0,i.jsx)(es.Z,{size:20})}),(0,i.jsx)(E.A,{size:"lg",variant:"light",onClick:e=>{e.stopPropagation(),w()},children:(0,i.jsx)(O.Z,{size:20})}),(0,i.jsx)(E.A,{size:"lg",variant:"light",onClick:e=>{e.stopPropagation(),N(null==r?void 0:r.id)},color:"red",children:(0,i.jsx)(ea.Z,{size:20})})]})]})]})})]}),(0,i.jsx)(ec,{onRefetch:u,slotName:m,doctorChamberId:p||"",appointment:r,doctor:h,opened:f,onClose:g}),(0,i.jsx)(ev,{appointment:r,doctor:h,opened:b,onClose:S})]})};var ey=n(76029);let eg=e=>{var t,n,o,l;let{appointment:s,onRefetch:a,slotName:d,doctorChamberId:r,doctor:u}=e,{opened:m,open:p,close:h}=(0,ef.Q)("table_appointmentModal"+(null==s?void 0:s.id)),[x,{open:v,close:f}]=(0,B.q)(!1),y=async e=>{let t=await (0,ee.G)(e);(null==t?void 0:t.success)?(K.toast.success("Appointment deleted successfully."),a()):K.toast.error("Failed to delete appointment.")};return(0,i.jsxs)(A.i.Tr,{children:[(0,i.jsx)(A.i.Td,{style:{textTransform:"uppercase"},children:null==s?void 0:s.serialNo}),(0,i.jsx)(A.i.Td,{children:(0,i.jsx)(C.Box,{maw:200,children:(0,i.jsx)(ey.u,{label:null==s?void 0:null===(t=s.patient)||void 0===t?void 0:t.name,withArrow:!0,children:(0,i.jsx)(c.Text,{truncate:!0,children:null==s?void 0:null===(n=s.patient)||void 0===n?void 0:n.name})})})}),(0,i.jsx)(A.i.Td,{children:null==s?void 0:null===(o=s.patient)||void 0===o?void 0:o.phone}),(0,i.jsx)(A.i.Td,{children:(0,i.jsx)(eu.O,{appointment:s,onRefetch:a})}),(0,i.jsx)(A.i.Td,{children:j()(null==s?void 0:s.timeOf).format("hh:mm A")}),(0,i.jsx)(A.i.Td,{children:(0,i.jsx)(ep,{appointment:s,onRefetch:a})}),(0,i.jsx)(A.i.Td,{children:(null==s?void 0:null===(l=s.pc)||void 0===l?void 0:l.name)||"N/A"}),(0,i.jsx)(A.i.Td,{children:null==s?void 0:s.pcAmount}),(0,i.jsx)(A.i.Td,{children:(0,i.jsxs)(U.Group,{gap:"xs",children:[(0,i.jsx)(E.A,{size:"sm",variant:"transparent",onClick:()=>p(),color:"blue",children:(0,i.jsx)(es.Z,{size:18})}),(0,i.jsx)(ec,{opened:m,onClose:h,onRefetch:a,slotName:d,doctorChamberId:r,appointment:s,doctor:u}),(0,i.jsx)(E.A,{size:"sm",variant:"transparent",onClick:()=>v(),color:"blue",children:(0,i.jsx)(O.Z,{size:18})}),(0,i.jsx)(ev,{opened:x,onClose:f,appointment:s,doctor:u}),(0,i.jsx)(E.A,{size:"sm",variant:"transparent",onClick:()=>y(null==s?void 0:s.id),color:"red",children:(0,i.jsx)(ea.Z,{size:18})})]})})]})};var eb=e=>{var t,n,l,s,a,r;let{appointmentData:u,onRefetch:m,selectedDate:p}=e,[h,x]=(0,o.useState)({}),[v,f]=(0,o.useState)(null),[y,{open:g,close:b}]=(0,B.q)(!1),w=(null==u?void 0:null===(t=u.slots)||void 0===t?void 0:t.map(e=>({id:null==e?void 0:e.id,session:null==e?void 0:e.slotName,appointments:null==e?void 0:e.appointments})))||[];return(0,i.jsxs)(C.Box,{children:[(0,i.jsxs)(C.Box,{style:{padding:"16px"},children:[(0,i.jsx)(c.Text,{fz:{base:"md",sm:"xl"},fw:700,children:null==u?void 0:null===(n=u.Doctor)||void 0===n?void 0:n.name}),(0,i.jsx)(c.Text,{fz:{base:"sm",sm:"md"},c:"dimmed",children:null==u?void 0:null===(l=u.Doctor)||void 0===l?void 0:l.designation})]}),(null==u?void 0:u.slots)&&0!==u.slots.length?null==u?void 0:null===(s=u.slots)||void 0===s?void 0:s.map(e=>{var t,n,o,l;let s=null==w?void 0:w.find(t=>t.session===e.slotName),a=h[e.id]||1,r=(a-1)*15,v=null==s?void 0:null===(t=s.appointments)||void 0===t?void 0:t.slice(r,r+15),y=j()(null==s?void 0:null===(n=s.appointments[0])||void 0===n?void 0:n.timeOf).format("YYYY-MM-DD"),b=(null==s?void 0:s.appointments)&&s.appointments.length>0;return(0,i.jsxs)(C.Box,{children:[(0,i.jsx)(T.Divider,{my:"sm"}),(0,i.jsxs)(d.k,{gap:"sm",align:"center",justify:"space-between",p:"xs",px:"md",direction:{base:"row",sm:"row"},wrap:"nowrap",style:{overflow:"auto"},children:[(0,i.jsx)(c.Text,{c:"rgb(39, 38, 38)",fw:500,w:{base:"auto",sm:"auto"},children:e.slotName}),(0,i.jsxs)(d.k,{gap:"sm",align:"center",w:{base:"auto",sm:"auto"},children:[(0,i.jsx)(Z.default,{style:{color:"currentcolor",textDecoration:"none"},href:"/appointment/list/queue/v2?doctorChamberId=".concat(null==u?void 0:u.id,"&slotId=").concat(e.id,"&session=").concat(null==s?void 0:s.session,"&date=").concat(y),children:(0,i.jsx)(N.Button,{variant:"outline",color:"violet",size:"xs",disabled:!b,rightSection:(0,i.jsx)(P.Z,{size:14}),w:{base:"auto",sm:"auto"},children:"Manage"})}),(0,i.jsx)($,{slot:e,refetch:m,selectedDate:p,doctorChamberId:null==u?void 0:u.id,onPrint:()=>{f({slotName:e.slotName,appointments:(null==s?void 0:s.appointments)||[]}),g()},hasAppointments:!!b})]})]}),(0,i.jsx)(T.Divider,{mt:"sm"}),v&&0!==v.length?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.Box,{visibleFrom:"sm",style:{padding:"0 16px 16px 16px"},children:(0,i.jsxs)(A.i,{miw:700,mb:"xs",horizontalSpacing:"md",verticalSpacing:"xs",layout:"fixed",children:[(0,i.jsx)(A.i.Thead,{children:(0,i.jsxs)(A.i.Tr,{children:[(0,i.jsx)(A.i.Th,{w:60,children:"Serial"}),(0,i.jsx)(A.i.Th,{w:200,children:"Patient Name"}),(0,i.jsx)(A.i.Th,{w:120,children:"Patient Number"}),(0,i.jsx)(A.i.Th,{w:100,children:"Status"}),(0,i.jsx)(A.i.Th,{w:100,children:"Serial Time"}),(0,i.jsx)(A.i.Th,{w:150,children:"Payment Status"}),(0,i.jsx)(A.i.Th,{w:100,children:"PC Name"}),(0,i.jsx)(A.i.Th,{w:80,children:"PC Amount"}),(0,i.jsx)(A.i.Th,{w:100,children:"Actions"})]})}),(0,i.jsx)(A.i.Tbody,{children:null==v?void 0:v.map(t=>(0,i.jsx)(eg,{appointment:t,onRefetch:m,slotName:e.slotName,doctorChamberId:null==u?void 0:u.id,doctor:null==u?void 0:u.Doctor},null==t?void 0:t.id))})]})}),(0,i.jsx)(C.Box,{hiddenFrom:"sm",children:null==v?void 0:v.map(t=>(0,i.jsx)(ej,{appointment:t,onRefetch:m,slotName:e.slotName,doctorChamberId:null==u?void 0:u.id,doctor:null==u?void 0:u.Doctor},null==t?void 0:t.id))}),(null==s?void 0:s.appointments)&&(null==s?void 0:null===(o=s.appointments)||void 0===o?void 0:o.length)>0&&(0,i.jsx)(C.Box,{style:{padding:"0 16px 16px 16px"},children:(0,i.jsx)(z.t,{total:Math.ceil(((null==s?void 0:null===(l=s.appointments)||void 0===l?void 0:l.length)||0)/15),value:a,onChange:t=>x(n=>({...n,[null==e?void 0:e.id]:t})),mt:25,mb:10})})]}):(0,i.jsx)(C.Box,{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100px",textAlign:"center"},children:(0,i.jsx)(c.Text,{size:"md",c:"dimmed",children:"No appointments in this slot"})})]},e.id)}):(0,i.jsx)(C.Box,{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"150px",textAlign:"center"},children:(0,i.jsx)(c.Text,{size:"lg",c:"dimmed",children:"No appointments found for this date"})}),(0,i.jsx)(D.u,{opened:y,onClose:b,size:"80%",radius:0,transitionProps:{transition:"fade",duration:200},title:"Appointment Slot PDF",children:v&&(0,i.jsx)(R,{slotData:v,doctorInfo:{name:(null==u?void 0:null===(a=u.Doctor)||void 0===a?void 0:a.name)||"",designation:(null==u?void 0:null===(r=u.Doctor)||void 0===r?void 0:r.designation)||""}})})]})},ew=e=>{let{selectedDate:t,doctor:n,phoneNumberFilter:l}=e,[s,a]=o.useState(1e3*Math.random()),{data:d,isLoading:r,error:u,refetch:m}=(0,g.mx)({...n&&{doctorChamberId:n},date:t.date});console.log(d," appointment list data");let p=(0,o.useMemo)(()=>{let e=(null==d?void 0:d.data)||[],t=e;l&&(t=e.map(e=>({...e,slots:e.slots.map(e=>({...e,appointments:e.appointments.filter(e=>e.patient.phone.includes(l.toString()))})).filter(e=>e.appointments.length>0)})).filter(e=>e.slots.length>0));let n=e=>e.slots.reduce((e,t)=>{var n;return e+((null===(n=t.appointments)||void 0===n?void 0:n.length)||0)},0)>0?1:e.slots.length>0?2:3;return[...t].sort((e,t)=>n(e)-n(t))},[null==d?void 0:d.data,l]);if(r)return(0,i.jsxs)("div",{children:[(0,i.jsx)(b.O,{height:50,radius:"md",mb:10}),(0,i.jsx)(b.O,{height:50,radius:"md",mb:10}),(0,i.jsx)(b.O,{height:50,radius:"md",mb:10})]});if(u)return(0,i.jsx)(c.Text,{c:"red",children:"Error loading appointments. Please try again."});if(0===p.length)return(0,i.jsx)(w.M,{style:{padding:"2rem"},children:(0,i.jsx)(c.Text,{size:"lg",c:"dimmed",children:l?'No appointments found for phone number containing "'.concat(l,'" on the selected date.'):"No appointments found for the selected date and doctor."})});let h=async()=>{console.log("Refetching appointments..."),await m(),setTimeout(()=>{a(1e3*Math.random())},1e3)};return(0,i.jsx)(i.Fragment,{children:p.map(e=>(0,i.jsx)(S.X,{shadow:"xs",p:0,radius:"md",withBorder:!0,children:(0,i.jsx)(eb,{appointmentData:e,onRefetch:h,selectedDate:t.date})},"".concat(e.id,"-key-").concat(s)))})};let eS=j()().format("YYYY-MM-DD");var eC=()=>{let e=(0,y.useRouter)(),t=(0,y.useSearchParams)(),{data:n,isFetching:f}=(0,g.LW)(void 0),b=(0,o.useMemo)(()=>{var e;return(null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.map(e=>({label:e.Doctor.name,value:e.id})))||[]},[null==n?void 0:n.data]),w=t.get("date")||eS,[S,C]=(0,o.useState)({date:w}),[T,N]=(0,o.useState)(""),[A,z]=(0,o.useState)(void 0);return(0,o.useEffect)(()=>{let n=new URLSearchParams(t.toString());n.set("date",S.date),e.replace("?".concat(n.toString()),{scroll:!1})},[S.date,e,t]),(0,i.jsx)(l.Container,{size:"xl",px:"md",mb:(0,s.h)(40),children:(0,i.jsxs)(a.Stack,{gap:"lg",children:[(0,i.jsxs)(d.k,{direction:{base:"column",lg:"row"},gap:{base:"md",lg:"xl"},align:{base:"stretch",lg:"center"},justify:"space-between",py:"lg",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(r.Title,{order:2,mb:(0,s.h)(4),children:"Appointment List"}),(0,i.jsx)(c.Text,{size:"sm",c:"dimmed",children:"View and manage all booked appointments"})]}),(0,i.jsxs)(d.k,{gap:"md",direction:{base:"column",sm:"row"},wrap:"wrap",align:{base:"stretch",sm:"flex-end"},w:{base:"100%",lg:"auto"},children:[(0,i.jsx)(u.P,{placeholder:"Select Doctor",label:"Doctor",leftSection:(0,i.jsx)(h.Z,{size:16}),onChange:e=>N(e),data:b,searchable:!0,clearable:!0,disabled:f,w:{base:"100%",sm:"auto"},miw:{base:"auto",sm:(0,s.h)(200)},flex:{sm:1}}),(0,i.jsx)(m.Y,{placeholder:"Enter phone number",label:"Patient Phone",leftSection:(0,i.jsx)(x.Z,{size:16}),onChange:e=>z(Number(e)),disabled:f,hideControls:!0,w:{base:"100%",sm:"auto"},miw:{base:"auto",sm:(0,s.h)(200)},flex:{sm:1}}),(0,i.jsx)(p.DatePickerInput,{label:"Date",placeholder:"Select date",leftSection:(0,i.jsx)(v.Z,{size:16}),value:j()(S.date).toDate(),onChange:e=>{e&&C({date:j()(e).format("YYYY-MM-DD")})},clearable:!1,w:{base:"100%",sm:"auto"},miw:{base:"auto",sm:(0,s.h)(200)},flex:{sm:1}})]})]}),(0,i.jsx)(ew,{selectedDate:S,doctor:T,phoneNumberFilter:A})]})})}},26809:function(e,t,n){"use strict";var i=n(68328);n(4505);var o=n(65850),l=n(97698);let s=o.mM.create({container:{paddingVertical:5,fontSize:12},group:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},text:{fontSize:12,fontWeight:700},circle:{width:6,height:6,borderRadius:3,backgroundColor:"black",marginHorizontal:2},divider:{borderTop:"1px solid #787878",marginVertical:3}});t.Z=e=>{var t,n,a,d;let{small:r,dates:c,userName:u}=e,m=e=>(0,l.Z)(e?new Date(e):new Date,"dd-MMM-yyyy");return(0,i.jsxs)(o.G7,{style:s.container,children:[(0,i.jsx)(o.G7,{style:s.divider}),(0,i.jsxs)(o.G7,{style:s.group,children:[(0,i.jsxs)(o.G7,{style:{flexDirection:"row",alignItems:"center"},children:[(0,i.jsx)(o.xv,{style:[s.text,{fontSize:10}],children:"Period : "}),(0,i.jsx)(o.xv,{style:[s.text,{fontSize:10}],children:m(null!==(d=null==c?void 0:null===(t=c.dates)||void 0===t?void 0:t[0])&&void 0!==d?d:new Date)}),(0,i.jsxs)(o.xv,{style:[s.text,{fontSize:10}],children:[" "," To "," "]}),(0,i.jsx)(o.xv,{style:[s.text,{fontSize:10}],children:m((null==c?void 0:null===(n=c.dates)||void 0===n?void 0:n[1])||(null==c?void 0:null===(a=c.dates)||void 0===a?void 0:a[0])||new Date)})]}),(0,i.jsx)(o.G7,{style:s.circle}),(0,i.jsxs)(o.xv,{style:[s.text,{fontSize:10}],children:["Printed By : ",u||"Unknown"]}),(0,i.jsx)(o.G7,{style:s.circle}),(0,i.jsxs)(o.xv,{style:[s.text,{fontSize:10,marginTop:"15px"}],children:["Print Time : ",(0,l.Z)(new Date,"MM/dd/yyyy : hh:mm a")]})]}),!r&&(0,i.jsx)(o.G7,{style:s.divider})]})}},90777:function(e,t,n){"use strict";n.d(t,{G:function(){return s}});var i=n(72940),o=n(6780),l=n(67732);let s=async e=>{try{let t=await o.default.delete("".concat("http://sasthotech.local:5000/api/v1","/appointment/").concat(e),i.FD);return{success:!0,data:t.data.data}}catch(e){if(e instanceof l.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}}},30651:function(e,t,n){"use strict";n.d(t,{b:function(){return s}});var i=n(72940),o=n(6780),l=n(67732);let s=async(e,t)=>{try{let n=await o.default.patch("".concat("http://sasthotech.local:5000/api/v1","/appointment/").concat(e),t,{...i.FD,...i.Hn});return{success:!0,data:n.data.data}}catch(e){if(e instanceof l.d7){var n;return{success:!1,data:null===(n=e.response)||void 0===n?void 0:n.data.message}}return{success:!1,data:"An error occurred"}}}}},function(e){e.O(0,[1601,2975,3313,9826,4404,3439,7281,7852,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,1166,7967,6029,154,6306,7698,3583,7186,4193,4890,7125,6625,6004,4572,3697,2714,7135,1321,2893,9175,7402,1744],function(){return e(e.s=19476)}),_N_E=e.O()}]);