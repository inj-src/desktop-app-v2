(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1195],{83362:function(e,t,s){Promise.resolve().then(s.bind(s,83014))},83014:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return R}});var n=s(68328),i=s(4505),r=s(36409),o=s(14587),a=s(32451),l=s(34473),c=s(22614),d=s(41224),u=s(68242),h=s(22041),p=s(76029),x=s(3741),m=s(48604),f=s(58812),g=s(29663),j=s(11114),w=s(50430),v=s(8720),y=s(59406),b=s(67781),S=s(92671),k=s(38156),T=s(31662),z=s(93636),C=s(16391),E=s(17443),I=s(99238),N=s(24590),D=s(26543),G=s(91622),A=s(21864),M=s(24811),Z=s(79894);function L(e){let{sessionId:t,doctorChamberId:s,slotId:r,diagnosticId:a,date:l}=e,{toggle:c}=(0,Z.O)(),d=(0,G.N)({sessionId:t,slotId:r,diagnosticId:a,doctorChamberId:s}),{settings:u,setSettings:h}=(0,A.q)(),[p,x]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1),[g,j]=(0,i.useState)(!0);if((0,i.useEffect)(()=>{(null==d?void 0:d.queue.notices.length)&&j(!0)},[null==d?void 0:d.queue.notices.length]),null===d)return(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,n.jsx)(o.Loader,{})});let w=null==d?void 0:d.queue.appointments.filter(e=>"ON_GOING"===e.status),v=null==d?void 0:d.queue.appointments.filter(e=>["CONFIRMED","PENDING","WAITING","BOOKED"].includes(e.status)),y=v.length;u.enablePatientsDisplay&&(v=v.slice(0,u.patientsDisplay));let b=u.automaticGrouping?w.length:u.patientGroup;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{position:"relative",height:"100vh",overflow:"hidden"},children:[(0,n.jsxs)(C.k,{style:{position:"fixed",bottom:20,right:20,gap:12,zIndex:10,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:6,padding:8,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",border:"1px solid rgba(0, 0, 0, 0.05)"},children:[(0,n.jsx)(k.Z,{style:{cursor:"pointer",color:"#666"},onClick:()=>x(!0),size:20}),(0,n.jsx)(T.Z,{style:{cursor:"pointer",color:"#666"},onClick:()=>f(!0),size:20}),(0,n.jsx)(z.Z,{style:{cursor:"pointer",color:"#666"},onClick:c,size:20})]}),(0,n.jsx)(E.Z,{fontSizeMultiplier:u.fontSizeMultiplier,showSerialNo:u.showSerialNo,notices:d.queue.notices||[],showNotices:g,setShowNotices:()=>j(e=>!e),leftContent:(0,n.jsx)(N.Z,{fontSizeMultiplier:u.fontSizeMultiplier,patientGroup:b,showSerialNo:u.showSerialNo,upcoming:v}),rightContent:(0,n.jsx)(D.Z,{fontSizeMultiplier:u.fontSizeMultiplier,onGoingFullLength:y,ongoing:w,upcoming:v,patientGroup:u.patientGroup,automaticGrouping:u.automaticGrouping,showSerialNo:u.showSerialNo,showSerialTime:u.showSerialTime})})]}),(0,n.jsx)(I.Z,{opened:p,onClose:()=>x(!1),initialSettings:u,onSave:e=>h(e)}),(0,n.jsx)(M.P,{doctorSessionId:t,opened:m,onClose:()=>f(!1),setShowNotices:()=>j(!0)})]})}var O=s(22975),B=s(89853);function R(){let[e,t]=(0,i.useState)(null),[s,k]=(0,i.useState)(!0),[T,z]=(0,i.useState)(0),[C,E]=(0,i.useState)(null),[I,N]=(0,i.useState)(!1),{toggle:D,fullscreen:G}=(0,Z.O)(),A=(null==e?void 0:e.sessions)||[],M=async()=>{try{k(!0);let e=B.env.NEXT_PUBLIC_API_URL||"http://localhost:5001",s=await fetch("".concat(e,"/api/v1/appointment/live/running-sessions")),n=await s.json();t(n)}catch(e){console.error("Failed to fetch running sessions:",e)}finally{k(!1)}};(0,i.useEffect)(()=>{M()},[]),(0,i.useEffect)(()=>{let e=e=>{if(I)return;let t=A.length;if(0!==t)switch(e.key){case"ArrowDown":case"Tab":e.preventDefault(),z(e=>(e+1)%t);break;case"ArrowUp":e.preventDefault(),z(e=>(e-1+t)%t);break;case"ArrowRight":e.preventDefault(),z(e=>Math.min(e+1,t-1));break;case"ArrowLeft":e.preventDefault(),z(e=>Math.max(e-1,0));break;case"Enter":case" ":e.preventDefault(),R(A[T]);break;case"Escape":I&&U()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[A,T,I]),(0,i.useEffect)(()=>{let e=document.getElementById("session-card-".concat(T));e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})},[T]);let R=e=>{E(e),N(!0),G||D()},U=()=>{N(!1),E(null),G&&D()},_=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),F=e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"});return s?(0,n.jsx)(r.M,{style:{height:"100vh"},children:(0,n.jsx)(o.Loader,{size:"xl"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Box,{style:{minHeight:"100vh",backgroundColor:"#f8f9fa"},p:"xl",children:(0,n.jsxs)(l.Container,{size:"lg",children:[(0,n.jsxs)(c.Group,{justify:"space-between",mb:"xl",children:[(0,n.jsxs)(d.Stack,{gap:"xs",children:[(0,n.jsx)(u.Title,{order:1,children:"Running Live Sessions"}),(0,n.jsx)(h.Text,{c:"dimmed",size:"sm",children:"Select a session to view the live queue. Use arrow keys or Tab to navigate, Enter to select."})]}),(0,n.jsx)(p.u,{label:"Refresh sessions",children:(0,n.jsx)(x.A,{variant:"light",size:"lg",onClick:()=>M(),children:(0,n.jsx)(w.Z,{size:20})})})]}),0===A.length?(0,n.jsx)(m.Z,{withBorder:!0,shadow:"sm",padding:"xl",radius:"md",style:{textAlign:"center"},children:(0,n.jsxs)(d.Stack,{align:"center",gap:"md",children:[(0,n.jsx)(f.k,{size:80,radius:"xl",variant:"light",color:"gray",children:(0,n.jsx)(v.Z,{size:40})}),(0,n.jsx)(u.Title,{order:3,c:"dimmed",children:"No Active Sessions"}),(0,n.jsx)(h.Text,{c:"dimmed",size:"sm",children:"There are currently no running live sessions available."})]})}):(0,n.jsx)(g.Grid,{gutter:"md",children:A.map((e,t)=>(0,n.jsx)(g.Grid.Col,{span:{base:12,sm:6,md:4,lg:3},children:(0,n.jsx)(m.Z,{id:"session-card-".concat(t),shadow:T===t?"xl":"sm",padding:"lg",radius:"md",withBorder:!0,style:{cursor:"pointer",transition:"all 0.2s ease",border:T===t?"2px solid #862e9c":"1px solid rgba(0, 0, 0, 0.1)",transform:T===t?"translateY(-4px)":"none",backgroundColor:T===t?"#f8f0fc":"white"},onClick:()=>R(e),onMouseEnter:()=>z(t),children:(0,n.jsxs)(d.Stack,{gap:"md",children:[(0,n.jsxs)(c.Group,{justify:"space-between",align:"flex-start",children:[(0,n.jsx)(j.C,{color:"ACTIVE"===e.status?"green":"yellow",variant:"light",size:"lg",children:e.status}),T===t&&(0,n.jsx)(f.k,{color:"grape",size:"sm",radius:"xl",children:(0,n.jsx)(y.Z,{size:12})})]}),(0,n.jsxs)(d.Stack,{gap:"xs",children:[(0,n.jsxs)(c.Group,{gap:"xs",children:[(0,n.jsx)(f.k,{color:"grape",size:"md",variant:"light",children:(0,n.jsx)(v.Z,{size:16})}),(0,n.jsx)(h.Text,{fw:600,size:"sm",lineClamp:2,children:e.doctorChamber.Doctor.name})]}),(0,n.jsx)(h.Text,{size:"xs",c:"dimmed",lineClamp:2,pl:32,children:e.doctorChamber.Doctor.designation})]}),(0,n.jsxs)(c.Group,{gap:"xs",children:[(0,n.jsx)(f.k,{color:"blue",size:"sm",variant:"light",children:(0,n.jsx)(b.Z,{size:14})}),(0,n.jsx)(h.Text,{size:"xs",c:"dimmed",children:F(e.date)})]}),(0,n.jsxs)(c.Group,{gap:"xs",children:[(0,n.jsx)(f.k,{color:"orange",size:"sm",variant:"light",children:(0,n.jsx)(S.Z,{size:14})}),(0,n.jsxs)(h.Text,{size:"xs",c:"dimmed",children:[_(e.startTime)," - ",_(e.endTime)]})]}),e.isOnBreak&&(0,n.jsx)(j.C,{color:"red",variant:"filled",size:"sm",children:"On Break"}),e.currentDelayInMinutes>0&&(0,n.jsxs)(h.Text,{size:"xs",c:"red",fw:500,children:["Delayed by ",e.currentDelayInMinutes," min"]}),T===t&&(0,n.jsx)(h.Text,{size:"xs",c:"grape",ta:"center",fw:500,mt:"xs",children:"Press Enter to open"})]})})},e.id))}),A.length>0&&(0,n.jsx)(m.Z,{withBorder:!0,shadow:"sm",padding:"md",radius:"md",mt:"xl",children:(0,n.jsxs)(c.Group,{justify:"center",gap:"xl",children:[(0,n.jsxs)(h.Text,{size:"xs",c:"dimmed",children:[(0,n.jsx)(h.Text,{component:"span",fw:600,c:"dark",children:"Arrow Keys / Tab:"})," ","Navigate"]}),(0,n.jsxs)(h.Text,{size:"xs",c:"dimmed",children:[(0,n.jsx)(h.Text,{component:"span",fw:600,c:"dark",children:"Enter / Space:"})," ","Select"]}),(0,n.jsxs)(h.Text,{size:"xs",c:"dimmed",children:[(0,n.jsx)(h.Text,{component:"span",fw:600,c:"dark",children:"Esc:"})," ","Close"]})]})})]})}),(0,n.jsx)(O.u,{opened:I,onClose:U,withCloseButton:!1,padding:0,radius:0,fullScreen:G,size:G?void 0:"100%",children:C&&(0,n.jsx)(L,{sessionId:C.id,doctorChamberId:C.doctorChamberId,slotId:C.slotId,diagnosticId:C.diagnosticId,date:C.date})})]})}},72940:function(e,t,s){"use strict";s.d(t,{FD:function(){return i},Hn:function(){return n},y4:function(){return r}});let n={headers:{"Content-Type":"application/json"}},i={withCredentials:!0},r={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},78101:function(e,t,s){"use strict";s.d(t,{g:function(){return a}});var n=s(49854),i=s(68240),r=s(94183),o=s(28317);let a=(0,i.LC)({baseQuery:(0,r.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,t)=>fetch(e,t).then(async s=>{let i="string"==typeof e?e:e.url;return i.includes("?")||(null==t?void 0:t.body)||"string"!=typeof e&&e.body||await (0,o.t8)(i,await s.clone().json().catch(()=>null),(0,n.x)()),s}).catch(async s=>{if(s instanceof TypeError){let s="string"==typeof e?e:e.url;if(!s.includes("?")&&!(null==t?void 0:t.body)&&!("string"!=typeof e&&e.body)){let e=await (0,o.U2)(s,(0,n.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw s})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},49854:function(e,t,s){"use strict";let n;s.d(t,{d:function(){return c},x:function(){return l}});var i=s(72940),r=s(6780),o=s(67732),a=s(28317);function l(){return n||(n=(0,a.MT)("cached-responses-store","cached-responses")),n}async function c(e,t){try{let s=await r.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...i.FD});return await (0,a.t8)(e,s.data,l()),s.data}catch(t){if(t instanceof o.d7&&[o.d7.ERR_NETWORK,o.d7.ETIMEDOUT].includes(t.code)){let t=await (0,a.U2)(e,l());if(t)return t}throw t instanceof o.d7&&t.response&&401===t.response.status||console.error(t),t}}}},function(e){e.O(0,[1601,3069,6945,3852,1656,9722,4670,9258,9533,966,12,7538,1166,7967,6029,6306,1493,7125,4931,5980,53,5320,9175,7402,1744],function(){return e(e.s=83362)}),_N_E=e.O()}]);