(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2576],{94359:function(e,s,i){Promise.resolve().then(i.bind(i,4361))},4361:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return w}});var n=i(68328),r=i(46373),t=i(34473),o=i(41224),a=i(22614),d=i(68242),l=i(31204),c=i(48604),u=i(87967),v=i(22041),m=i(14587),h=i(54632),p=i(11114),g=i(7140),f=i(9326),T=i(50430),y=i(5966),x=i(67030),j=i(4505),A=i(12450),b=i(34703);let S=[{value:"",label:"All Status"},{value:"pending",label:"Pending"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"}];function w(){var e;let s=(0,A.useSearchParams)().get("diagnosticId"),[i,w]=(0,j.useState)(""),[E,q]=(0,j.useState)(""),[z,P]=(0,j.useState)(1),{data:C}=(0,x.NG)(),{data:G,isLoading:V,error:Z,refetch:U}=(0,y.nL)({serviceId:i||void 0,hospitalId:s||void 0,status:E||void 0,limit:20,offset:(z-1)*20}),D=(null==C?void 0:C.data)||[],L=(null==G?void 0:G.data)||[],k=(null==G?void 0:G.pagination)?Math.ceil(G.pagination.total/20):1,O=e=>{switch(e){case"completed":return"green";case"failed":return"red";case"in_progress":return"blue";default:return"gray"}},R=e=>{switch(e){case"completed":return"✓";case"failed":return"✗";case"in_progress":return"⚠";default:return"○"}};return Z?(0,n.jsx)(r.b,{icon:(0,n.jsx)(f.Z,{size:16}),title:"Error",color:"red",children:"Failed to load update logs. Please try again later."}):(0,n.jsxs)(t.Container,{fluid:!0,children:[(0,n.jsx)(b.Z,{}),(0,n.jsxs)(o.Stack,{gap:"lg",children:[(0,n.jsxs)(a.Group,{justify:"space-between",children:[(0,n.jsx)(d.Title,{order:2,children:"Update Logs"}),(0,n.jsx)(l.Button,{leftSection:(0,n.jsx)(T.Z,{size:16}),variant:"light",onClick:()=>U(),loading:V,children:"Refresh"})]}),(0,n.jsxs)(c.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[(0,n.jsx)(d.Title,{order:5,mb:"md",children:"Filters"}),(0,n.jsxs)(a.Group,{children:[(0,n.jsx)(u.P,{placeholder:"All Services",data:[{value:"",label:"All Services"},...D.map(e=>({value:e.id,label:e.displayName||e.name}))],value:i,onChange:e=>{w(e||""),P(1)},style:{minWidth:200},clearable:!0}),(0,n.jsx)(u.P,{placeholder:"All Status",data:S,value:E,onChange:e=>{q(e||""),P(1)},style:{minWidth:150},clearable:!0})]}),s&&(0,n.jsxs)(v.Text,{size:"sm",c:"dimmed",mt:"sm",children:["Showing logs for hospital: ",s]})]}),V?(0,n.jsx)(a.Group,{justify:"center",py:"xl",children:(0,n.jsx)(m.Loader,{size:"lg"})}):0===L.length?(0,n.jsx)(c.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,n.jsx)(v.Text,{c:"dimmed",ta:"center",children:"No update logs found."})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,n.jsxs)(h.i,{striped:!0,highlightOnHover:!0,children:[(0,n.jsx)(h.i.Thead,{children:(0,n.jsxs)(h.i.Tr,{children:[(0,n.jsx)(h.i.Th,{children:"Status"}),(0,n.jsx)(h.i.Th,{children:"Hospital"}),(0,n.jsx)(h.i.Th,{children:"Service"}),(0,n.jsx)(h.i.Th,{children:"Version"}),(0,n.jsx)(h.i.Th,{children:"Started"}),(0,n.jsx)(h.i.Th,{children:"Duration"}),(0,n.jsx)(h.i.Th,{children:"Triggered By"})]})}),(0,n.jsx)(h.i.Tbody,{children:L.map(e=>{let s=new Date(e.startedAt),i=Math.round(((e.completedAt?new Date(e.completedAt):new Date).getTime()-s.getTime())/1e3/60);return(0,n.jsxs)(h.i.Tr,{children:[(0,n.jsx)(h.i.Td,{children:(0,n.jsxs)(p.C,{color:O(e.status),size:"sm",children:[R(e.status)," ",e.status]})}),(0,n.jsx)(h.i.Td,{children:(0,n.jsx)(v.Text,{size:"sm",children:e.diagnosticId})}),(0,n.jsx)(h.i.Td,{children:(0,n.jsx)(v.Text,{size:"sm",fw:500,children:e.serviceName||"Unknown"})}),(0,n.jsx)(h.i.Td,{children:(0,n.jsxs)(v.Text,{size:"sm",style:{fontFamily:"monospace"},children:[e.fromVersion&&"".concat(e.fromVersion," → "),e.toVersion]})}),(0,n.jsx)(h.i.Td,{children:(0,n.jsx)(v.Text,{size:"sm",children:s.toLocaleString()})}),(0,n.jsx)(h.i.Td,{children:(0,n.jsx)(v.Text,{size:"sm",children:i<1?"< 1 min":"".concat(i," min").concat(1!==i?"s":"")})}),(0,n.jsx)(h.i.Td,{children:(0,n.jsx)(v.Text,{size:"sm",c:"dimmed",children:e.triggeredBy||"-"})})]},e.id)})})]})}),k>1&&(0,n.jsx)(a.Group,{justify:"center",children:(0,n.jsx)(g.t,{total:k,value:z,onChange:P})})]}),!V&&L.length>0&&(0,n.jsx)(c.Z,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,children:(0,n.jsxs)(a.Group,{justify:"space-between",children:[(0,n.jsxs)(v.Text,{size:"sm",c:"dimmed",children:["Showing ",L.length," of ",(null==G?void 0:null===(e=G.pagination)||void 0===e?void 0:e.total)||0," logs"]}),(0,n.jsxs)(v.Text,{size:"sm",c:"dimmed",children:["Page ",z," of ",k]})]})})]})]})}},34703:function(e,s,i){"use strict";i.d(s,{Z:function(){return h}});var n=i(68328),r=i(13342),t=i(12450),o=i(74556),a=i(56959),d=i(74625),l=i(71140),c=i(91024),u=i(31662),v=i(25539),m=i(39870);function h(){let e=(0,t.useRouter)(),s=(0,t.usePathname)();return(0,n.jsx)(r.m,{value:s.includes("/dashboard")?"dashboard":s.includes("/services")?"services":s.includes("/versions")?"versions":s.includes("/hospitals")?"hospitals":s.includes("/logs")?"logs":s.includes("/notifications")?"notifications":s.includes("/devices")?"devices":s.includes("/sessions")?"sessions":"dashboard",onChange:s=>{s&&e.push("/superadmin/version-admin/".concat(s))},mb:"lg",children:(0,n.jsxs)(r.m.List,{children:[(0,n.jsx)(r.m.Tab,{value:"dashboard",leftSection:(0,n.jsx)(o.Z,{size:16}),children:"Dashboard"}),(0,n.jsx)(r.m.Tab,{value:"services",leftSection:(0,n.jsx)(a.Z,{size:16}),children:"Services"}),(0,n.jsx)(r.m.Tab,{value:"versions",leftSection:(0,n.jsx)(d.Z,{size:16}),children:"Versions"}),(0,n.jsx)(r.m.Tab,{value:"hospitals",leftSection:(0,n.jsx)(l.Z,{size:16}),children:"Hospitals"}),(0,n.jsx)(r.m.Tab,{value:"logs",leftSection:(0,n.jsx)(c.Z,{size:16}),children:"Update Logs"}),(0,n.jsx)(r.m.Tab,{value:"notifications",leftSection:(0,n.jsx)(u.Z,{size:16}),children:"Notifications"}),(0,n.jsx)(r.m.Tab,{value:"sessions",leftSection:(0,n.jsx)(v.Z,{size:16}),children:"Sessions"}),(0,n.jsx)(r.m.Tab,{value:"devices",leftSection:(0,n.jsx)(m.Z,{size:16}),children:"Devices"})]})})}},72940:function(e,s,i){"use strict";i.d(s,{FD:function(){return r},Hn:function(){return n},y4:function(){return t}});let n={headers:{"Content-Type":"application/json"}},r={withCredentials:!0},t={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},67030:function(e,s,i){"use strict";i.d(s,{GM:function(){return a},M:function(){return r},MD:function(){return t},NG:function(){return n},nR:function(){return o}});let{useGetAllServicesQuery:n,useGetServiceQuery:r,useCreateServiceMutation:t,useUpdateServiceMutation:o,useDeleteServiceMutation:a,useAddServiceEnvVarMutation:d,useUpdateServiceEnvVarMutation:l,useDeleteServiceEnvVarMutation:c,useAddServiceVolumeMutation:u,useUpdateServiceVolumeMutation:v,useDeleteServiceVolumeMutation:m}=i(78101).g.injectEndpoints({endpoints:e=>({getAllServices:e.query({query:e=>({url:"/version-admin/services",method:"GET",params:e||{limit:50,offset:0}}),providesTags:["versionAdmin-services"]}),getService:e.query({query:e=>({url:"/version-admin/services/".concat(e),method:"GET"}),providesTags:(e,s,i)=>[{type:"versionAdmin-services",id:i}]}),createService:e.mutation({query:e=>({url:"/version-admin/services",method:"POST",body:e}),invalidatesTags:["versionAdmin-services"]}),updateService:e.mutation({query:e=>{let{id:s,data:i}=e;return{url:"/version-admin/services/".concat(s),method:"PUT",body:i}},invalidatesTags:(e,s,i)=>{let{id:n}=i;return["versionAdmin-services",{type:"versionAdmin-services",id:n}]}}),deleteService:e.mutation({query:e=>({url:"/version-admin/services/".concat(e),method:"DELETE"}),invalidatesTags:["versionAdmin-services"]}),addServiceEnvVar:e.mutation({query:e=>({url:"/version-admin/services/env",method:"POST",body:e}),invalidatesTags:(e,s,i)=>{let{serviceId:n}=i;return["versionAdmin-services",{type:"versionAdmin-services",id:n}]}}),updateServiceEnvVar:e.mutation({query:e=>{let{id:s,data:i}=e;return{url:"/version-admin/services/env/".concat(s),method:"PUT",body:i}},invalidatesTags:(e,s,i)=>{let{serviceId:n}=i;return n?["versionAdmin-services",{type:"versionAdmin-services",id:n}]:["versionAdmin-services"]}}),deleteServiceEnvVar:e.mutation({query:e=>{let{id:s}=e;return{url:"/version-admin/services/env/".concat(s),method:"DELETE"}},invalidatesTags:(e,s,i)=>{let{serviceId:n}=i;return n?["versionAdmin-services",{type:"versionAdmin-services",id:n}]:["versionAdmin-services"]}}),addServiceVolume:e.mutation({query:e=>({url:"/version-admin/services/volumes",method:"POST",body:e}),invalidatesTags:(e,s,i)=>{let{serviceId:n}=i;return["versionAdmin-services",{type:"versionAdmin-services",id:n}]}}),updateServiceVolume:e.mutation({query:e=>{let{id:s,data:i}=e;return{url:"/version-admin/services/volumes/".concat(s),method:"PUT",body:i}},invalidatesTags:(e,s,i)=>{let{serviceId:n}=i;return n?["versionAdmin-services",{type:"versionAdmin-services",id:n}]:["versionAdmin-services"]}}),deleteServiceVolume:e.mutation({query:e=>{let{id:s}=e;return{url:"/version-admin/services/volumes/".concat(s),method:"DELETE"}},invalidatesTags:(e,s,i)=>{let{serviceId:n}=i;return n?["versionAdmin-services",{type:"versionAdmin-services",id:n}]:["versionAdmin-services"]}})})})},5966:function(e,s,i){"use strict";i.d(s,{Kp:function(){return o},Rs:function(){return t},VQ:function(){return c},a6:function(){return n},ai:function(){return d},nL:function(){return l}});let{useGetAllVersionReleasesQuery:n,useGetVersionConfigQuery:r,useReleaseVersionMutation:t,useGetRolloutStatusQuery:o,useAssignVersionToHospitalMutation:a,useGetUpdateHistoryQuery:d,useGetAllUpdateLogsQuery:l,useCheckForUpdatesQuery:c,useGetAvailableVersionsQuery:u,useGetDashboardStatsQuery:v,useLogUpdateMutation:m}=i(78101).g.injectEndpoints({endpoints:e=>({getAllVersionReleases:e.query({query:e=>({url:"/version-admin/versions/releases",method:"GET",params:e||{limit:50,offset:0}}),providesTags:["versionAdmin-versions"]}),getVersionConfig:e.query({query:e=>({url:"/version-admin/versions/".concat(e,"/config"),method:"GET"}),providesTags:(e,s,i)=>[{type:"versionAdmin-versions",id:i}]}),releaseVersion:e.mutation({query:e=>({url:"/version-admin/versions/release",method:"POST",body:e}),invalidatesTags:["versionAdmin-versions","versionAdmin-services"]}),getRolloutStatus:e.query({query:e=>{let{serviceId:s,version:i}=e;return{url:"/version-admin/versions/rollout-status/".concat(s,"/").concat(i),method:"GET"}},providesTags:(e,s,i)=>{let{serviceId:n,version:r}=i;return[{type:"versionAdmin-versions",id:"".concat(n,"-").concat(r)}]}}),assignVersionToHospital:e.mutation({query:e=>({url:"/version-admin/versions/assign-hospital",method:"POST",body:e}),invalidatesTags:["versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs"]}),getUpdateHistory:e.query({query:e=>{let{diagnosticId:s,limit:i=20,offset:n=0}=e;return{url:"/version-admin/versions/history/".concat(s),method:"GET",params:{limit:i,offset:n}}},providesTags:(e,s,i)=>{let{diagnosticId:n}=i;return[{type:"versionAdmin-logs",id:n}]}}),getAllUpdateLogs:e.query({query:e=>({url:"/version-admin/versions/logs",method:"GET",params:e||{limit:50,offset:0}}),providesTags:["versionAdmin-logs"]}),checkForUpdates:e.query({query:e=>({url:"/version-admin/versions/check",method:"GET",params:{diagnosticId:e}})}),getAvailableVersions:e.query({query:e=>({url:"/version-admin/versions/available/".concat(e),method:"GET"})}),getDashboardStats:e.query({query:()=>({url:"/version-admin/dashboard/stats",method:"GET"}),providesTags:["versionAdmin-services","versionAdmin-versions","versionAdmin-logs"]}),logUpdate:e.mutation({query:e=>({url:"/version-admin/versions/update-log",method:"POST",body:e}),invalidatesTags:["versionAdmin-logs"]})})})},78101:function(e,s,i){"use strict";i.d(s,{g:function(){return a}});var n=i(49854),r=i(68240),t=i(94183),o=i(28317);let a=(0,r.LC)({baseQuery:(0,t.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,s)=>fetch(e,s).then(async i=>{let r="string"==typeof e?e:e.url;return r.includes("?")||(null==s?void 0:s.body)||"string"!=typeof e&&e.body||await (0,o.t8)(r,await i.clone().json().catch(()=>null),(0,n.x)()),i}).catch(async i=>{if(i instanceof TypeError){let i="string"==typeof e?e:e.url;if(!i.includes("?")&&!(null==s?void 0:s.body)&&!("string"!=typeof e&&e.body)){let e=await (0,o.U2)(i,(0,n.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw i})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},49854:function(e,s,i){"use strict";let n;i.d(s,{d:function(){return l},x:function(){return d}});var r=i(72940),t=i(6780),o=i(67732),a=i(28317);function d(){return n||(n=(0,a.MT)("cached-responses-store","cached-responses")),n}async function l(e,s){try{let i=await t.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:s,...r.FD});return await (0,a.t8)(e,i.data,d()),i.data}catch(s){if(s instanceof o.d7&&[o.d7.ERR_NETWORK,o.d7.ETIMEDOUT].includes(s.code)){let s=await (0,a.U2)(e,d());if(s)return s}throw s instanceof o.d7&&s.response&&401===s.response.status||console.error(s),s}}}},function(e){e.O(0,[1601,3069,6945,3852,1656,9722,4670,9258,9533,966,1166,7967,7140,5978,5064,9175,7402,1744],function(){return e(e.s=94359)}),_N_E=e.O()}]);