(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9479],{57823:function(e,n,t){Promise.resolve().then(t.bind(t,84719))},84719:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return w}});var a=t(68328);let{useUploadVersionMutation:r,useDeleteVersionMutation:s,useGetSingleVersionQuery:i,useGetVersionsQuery:o,useCheckForUpdatesQuery:l}=t(78101).g.injectEndpoints({endpoints:e=>({getVersions:e.query({query:e=>{let{component:n}=e;return{url:"/update/get-version/".concat(n,"}")}},keepUnusedDataFor:86400}),uploadVersion:e.mutation({query:e=>{let{file:n,...t}=e,a=new FormData;return a.append("file",n),Object.entries(t).forEach(e=>{let[n,t]=e;a.append(n,t)}),{url:"/update/upload",method:"POST",body:a}}}),checkForUpdates:e.query({query:e=>{let{component:n,version:t}=e;return{url:"/update/check-update/".concat(n,"/").concat(t,"}")}},keepUnusedDataFor:86400}),deleteVersion:e.mutation({query:e=>({url:"/versions/".concat(e),method:"DELETE"})}),getSingleVersion:e.query({query:e=>({url:"/versions/".concat(e)})})})});var c=t(41224),u=t(89043),d=t(68242),p=t(21288),h=t(87967),f=t(22041),g=t(55911),v=t(57956),y=t(31204),m=t(34022),b=t(4505);function w(){let[e,n]=(0,b.useState)(null),[t,s]=(0,b.useState)(""),[i,l]=(0,b.useState)(""),[w,x]=(0,b.useState)(""),{data:T,isFetching:j}=o({component:t},{skip:!t});console.log(T,"data");let[k,{isLoading:C,error:E}]=r(),F=async()=>{if(!e||!t||!i)return;let a=new FormData;a.append("file",e),a.append("component",t),a.append("version",i),w&&a.append("changelog",w);try{await k({file:e,component:t,version:i,changelog:w}).unwrap(),n(null),s(""),l(""),x("")}catch(e){console.error("Failed to upload:",e)}};return(0,a.jsx)(c.Stack,{justify:"center",align:"center",w:"100%",h:"100%",gap:"md",children:(0,a.jsxs)(u.X,{w:"50%",bg:"white",shadow:"lg",p:"lg",radius:"lg",children:[(0,a.jsx)(d.Title,{children:"Upload New Versions"}),(0,a.jsx)(p.S,{placeholder:"Pick file",label:"Upload new version",value:e,onChange:n}),(0,a.jsx)(h.P,{placeholder:"e.g., frontend, backend",label:"Component",data:[{label:"Backend",value:"backend"},{label:"FrontEnd",value:"frontend"},{label:"Synchronizer",value:"synchronizer"},{label:"Desktop App",value:"electron"},{label:"Prisma",value:"prims"}],value:t,onChange:e=>s(null!=e?e:""),required:!0}),t&&(0,a.jsx)(a.Fragment,{children:j?(0,a.jsx)(f.Text,{children:"Loading versions..."}):(0,a.jsxs)(f.Text,{c:"red",w:700,children:["Current version: ",JSON.stringify(null==T?void 0:T.data)]})}),(0,a.jsx)(g.TextInput,{placeholder:"e.g., 1.0.0",label:"Version",value:i,onChange:e=>l(e.currentTarget.value),required:!0}),(0,a.jsx)(v.g,{placeholder:"Describe the changes in this version",label:"Changelog",value:w,onChange:e=>x(e.currentTarget.value)}),(0,a.jsx)(y.Button,{mt:"lg",onClick:F,loading:C,disabled:!e||!t||!i,children:"Upload"}),C&&(0,a.jsx)(m.E,{value:100,size:"xl",radius:"xl",striped:!0}),E&&(0,a.jsx)(f.Text,{color:"red",children:"Upload failed. Please try again."})]})})}},72940:function(e,n,t){"use strict";t.d(n,{FD:function(){return r},Hn:function(){return a},y4:function(){return s}});let a={headers:{"Content-Type":"application/json"}},r={withCredentials:!0},s={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},78101:function(e,n,t){"use strict";t.d(n,{g:function(){return o}});var a=t(49854),r=t(68240),s=t(94183),i=t(28317);let o=(0,r.LC)({baseQuery:(0,s.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,n)=>fetch(e,n).then(async t=>{let r="string"==typeof e?e:e.url;return r.includes("?")||(null==n?void 0:n.body)||"string"!=typeof e&&e.body||await (0,i.t8)(r,await t.clone().json().catch(()=>null),(0,a.x)()),t}).catch(async t=>{if(t instanceof TypeError){let t="string"==typeof e?e:e.url;if(!t.includes("?")&&!(null==n?void 0:n.body)&&!("string"!=typeof e&&e.body)){let e=await (0,i.U2)(t,(0,a.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw t})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},49854:function(e,n,t){"use strict";let a;t.d(n,{d:function(){return c},x:function(){return l}});var r=t(72940),s=t(6780),i=t(67732),o=t(28317);function l(){return a||(a=(0,o.MT)("cached-responses-store","cached-responses")),a}async function c(e,n){try{let t=await s.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:n,...r.FD});return await (0,o.t8)(e,t.data,l()),t.data}catch(n){if(n instanceof i.d7&&[i.d7.ERR_NETWORK,i.d7.ETIMEDOUT].includes(n.code)){let n=await (0,o.U2)(e,l());if(n)return n}throw n instanceof i.d7&&n.response&&401===n.response.status||console.error(n),n}}}},function(e){e.O(0,[1601,3069,6945,3852,1656,9722,4670,9258,9533,966,1166,7967,6033,9175,7402,1744],function(){return e(e.s=57823)}),_N_E=e.O()}]);