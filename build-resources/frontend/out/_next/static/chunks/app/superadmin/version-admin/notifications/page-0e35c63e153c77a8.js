(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2552],{81401:function(e,i,t){Promise.resolve().then(t.bind(t,75081))},75081:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return U}});var s=t(68328),n=t(34703),a=t(24774),o=t(41224),r=t(22041),l=t(55911),c=t(22614),d=t(31204),u=t(34473),h=t(14587),m=t(46373),f=t(68242),v=t(89043),p=t(87967),x=t(48604),g=t(11114),j=t(76029),y=t(3741),T=t(7140),b=t(25299),w=t(22115),A=t(9326),C=t(9654),k=t(86083),N=t(9286),R=t(31662),S=t(64190),E=t(58895),z=t(60530),I=t(41819),B=t(12697),Z=t(12450),M=t(4505);let P=["SECURITY","FINANCIAL","SYSTEM","HR","PROMOTIONAL","ADMINISTRATIVE","OPERATIONAL"],L=["LOW","MEDIUM","HIGH","URGENT"];function U(){let e=(0,Z.useRouter)(),[i,t]=(0,M.useState)({category:"",priority:"",isRead:"",isBroadcast:""}),[U,G]=(0,M.useState)(""),[O,q]=(0,M.useState)(1),[D,H]=(0,M.useState)(20),F=(O-1)*D,{data:W,isLoading:_,error:Y}=(0,a.MQ)({...i.category&&{category:i.category},...i.priority&&{priority:i.priority},...i.isRead&&{isRead:"true"===i.isRead},...i.isBroadcast&&{isBroadcast:"true"===i.isBroadcast},limit:D,offset:F}),[J]=(0,a.j6)(),[V]=(0,a.JY)(),[Q]=(0,a.AI)(),[X]=(0,a.sJ)(),K=(null==W?void 0:W.data)||[],$=null==W?void 0:W.pagination,ee=$?Math.ceil($.total/D):1,ei=(e,s)=>{t({...i,[e]:s}),q(1)},et=e=>{G(e),q(1)},es=K.filter(e=>{if(!U)return!0;let i=U.toLowerCase();return e.title.toLowerCase().includes(i)||e.message.toLowerCase().includes(i)||e.type.toLowerCase().includes(i)}),en=async(e,i)=>{try{i?(await V(e).unwrap(),w.N9.show({title:"Success",message:"Notification marked as unread",color:"green"})):(await J(e).unwrap(),w.N9.show({title:"Success",message:"Notification marked as read",color:"green"}))}catch(e){var t;w.N9.show({title:"Error",message:(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to update notification",color:"red"})}},ea=(e,i)=>{b.qk.open({title:"Revoke Notification",children:(0,s.jsxs)(o.Stack,{gap:"md",children:[(0,s.jsxs)(r.Text,{size:"sm",children:["Are you sure you want to revoke “",i,"”? This will hide it from all recipients."]}),(0,s.jsx)(l.TextInput,{label:"Reason (optional)",placeholder:"Enter reason...",id:"revoke-reason-input","data-autofocus":!0}),(0,s.jsxs)(c.Group,{justify:"flex-end",mt:"md",children:[(0,s.jsx)(d.Button,{variant:"default",onClick:()=>b.qk.closeAll(),children:"Cancel"}),(0,s.jsx)(d.Button,{color:"orange",onClick:async()=>{var i,t;let s=(null===(i=document.getElementById("revoke-reason-input"))||void 0===i?void 0:i.value)||void 0;try{await Q({id:e,reason:s}).unwrap(),w.N9.show({title:"Success",message:"Notification revoked successfully",color:"green"}),b.qk.closeAll()}catch(e){w.N9.show({title:"Error",message:(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to revoke notification",color:"red"})}},children:"Revoke"})]})]})})},eo=(e,i)=>{b.qk.openConfirmModal({title:"Delete Notification",children:(0,s.jsxs)(r.Text,{size:"sm",children:["Are you sure you want to permanently delete “",i,"”? This action cannot be undone."]}),labels:{confirm:"Delete",cancel:"Cancel"},confirmProps:{color:"red"},onConfirm:async()=>{try{await X(e).unwrap(),w.N9.show({title:"Success",message:"Notification deleted successfully",color:"green"})}catch(e){var i;w.N9.show({title:"Error",message:(null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.message)||"Failed to delete notification",color:"red"})}}})},er=e=>{switch(e){case"URGENT":return"red";case"HIGH":return"orange";case"MEDIUM":return"yellow";case"LOW":return"gray"}},el=e=>{switch(e){case"SECURITY":return"red";case"FINANCIAL":return"green";case"SYSTEM":return"blue";case"HR":return"violet";case"PROMOTIONAL":return"pink";case"ADMINISTRATIVE":return"cyan";case"OPERATIONAL":return"teal"}},ec=e=>new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});return _?(0,s.jsxs)(u.Container,{fluid:!0,children:[(0,s.jsx)(n.Z,{}),(0,s.jsx)(c.Group,{justify:"center",py:"xl",children:(0,s.jsx)(h.Loader,{size:"lg"})})]}):Y?(0,s.jsxs)(u.Container,{fluid:!0,children:[(0,s.jsx)(n.Z,{}),(0,s.jsx)(m.b,{icon:(0,s.jsx)(A.Z,{size:16}),title:"Error",color:"red",children:"Failed to load notifications. Please try again later."})]}):(0,s.jsxs)(u.Container,{fluid:!0,children:[(0,s.jsx)(n.Z,{}),(0,s.jsxs)(o.Stack,{gap:"lg",children:[(0,s.jsxs)(c.Group,{justify:"space-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(f.Title,{order:2,children:"Notifications"}),(0,s.jsx)(r.Text,{size:"sm",c:"dimmed",mt:4,children:"Manage and send notifications to users and diagnostics"})]}),(0,s.jsx)(d.Button,{leftSection:(0,s.jsx)(C.Z,{size:16}),onClick:()=>e.push("/superadmin/version-admin/notifications/send"),children:"Send Notification"})]}),(0,s.jsx)(v.X,{shadow:"sm",p:"md",radius:"md",withBorder:!0,children:(0,s.jsxs)(o.Stack,{gap:"md",children:[(0,s.jsxs)(c.Group,{gap:"md",align:"flex-end",wrap:"wrap",children:[(0,s.jsx)(l.TextInput,{placeholder:"Search notifications...",leftSection:(0,s.jsx)(k.Z,{size:16}),value:U,onChange:e=>et(e.target.value),style:{flex:1,minWidth:200}}),(0,s.jsx)(p.P,{placeholder:"Category",data:[{value:"",label:"All Categories"},...P.map(e=>({value:e,label:e}))],value:i.category,onChange:e=>ei("category",e||""),clearable:!0,leftSection:(0,s.jsx)(N.Z,{size:16}),style:{minWidth:180}}),(0,s.jsx)(p.P,{placeholder:"Priority",data:[{value:"",label:"All Priorities"},...L.map(e=>({value:e,label:e}))],value:i.priority,onChange:e=>ei("priority",e||""),clearable:!0,style:{minWidth:150}}),(0,s.jsx)(p.P,{placeholder:"Status",data:[{value:"",label:"All"},{value:"true",label:"Read"},{value:"false",label:"Unread"}],value:i.isRead,onChange:e=>ei("isRead",e||""),clearable:!0,style:{minWidth:120}}),(0,s.jsx)(p.P,{placeholder:"Type",data:[{value:"",label:"All"},{value:"true",label:"Broadcast"},{value:"false",label:"Direct"}],value:i.isBroadcast,onChange:e=>ei("isBroadcast",e||""),clearable:!0,style:{minWidth:120}}),(0,s.jsx)(p.P,{placeholder:"Per page",data:[{value:"10",label:"10 per page"},{value:"20",label:"20 per page"},{value:"50",label:"50 per page"},{value:"100",label:"100 per page"}],value:D.toString(),onChange:e=>{e&&(H(parseInt(e)),q(1))},style:{minWidth:140}})]}),(0,s.jsx)(c.Group,{gap:"xs",justify:"space-between",wrap:"wrap",children:(0,s.jsxs)(c.Group,{gap:"xs",children:[(0,s.jsx)(R.Z,{size:20}),(0,s.jsxs)(r.Text,{fw:500,children:[es.length," Notification",1!==es.length?"s":""]}),$&&(0,s.jsxs)(r.Text,{size:"sm",c:"dimmed",children:["(Showing ",F+1,"-",Math.min(F+D,$.total)," of"," ",$.total,")"]})]})})]})}),0===es.length?(0,s.jsx)(v.X,{shadow:"sm",p:"xl",radius:"md",withBorder:!0,children:(0,s.jsx)(r.Text,{c:"dimmed",ta:"center",children:U||Object.values(i).some(e=>e)?"No notifications found matching your filters":"No notifications yet"})}):(0,s.jsx)(o.Stack,{gap:"md",children:es.map(e=>(0,s.jsx)(x.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,style:{opacity:e.isRevoked?.6:1,backgroundColor:e.isRead?void 0:"var(--mantine-color-blue-0)"},children:(0,s.jsx)(o.Stack,{gap:"sm",children:(0,s.jsxs)(c.Group,{justify:"space-between",align:"flex-start",children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)(c.Group,{gap:"xs",mb:"xs",children:[(0,s.jsx)(g.C,{color:er(e.priority),variant:"filled",children:e.priority}),(0,s.jsx)(g.C,{color:el(e.category),variant:"light",children:e.category}),e.isBroadcast&&(0,s.jsx)(g.C,{color:"blue",variant:"outline",children:"Broadcast"}),e.isRevoked&&(0,s.jsx)(g.C,{color:"red",variant:"filled",children:"Revoked"}),!e.isRead&&(0,s.jsx)(g.C,{color:"green",variant:"dot",children:"Unread"})]}),(0,s.jsx)(f.Title,{order:4,children:e.title}),(0,s.jsx)(r.Text,{size:"sm",c:"dimmed",mt:4,children:e.message}),(0,s.jsxs)(c.Group,{gap:"lg",mt:"md",children:[(0,s.jsxs)(r.Text,{size:"xs",c:"dimmed",children:["Type: ",e.type.replace(/_/g," ")]}),e.diagnostic&&(0,s.jsxs)(r.Text,{size:"xs",c:"dimmed",children:["Diagnostic: ",e.diagnostic.name]}),(0,s.jsxs)(r.Text,{size:"xs",c:"dimmed",children:["Created: ",ec(e.createdAt)]}),e.sentBy&&(0,s.jsxs)(r.Text,{size:"xs",c:"dimmed",children:["By: ",e.sentBy.email]})]}),e.actionUrl&&(0,s.jsx)(d.Button,{size:"xs",variant:"light",mt:"sm",leftSection:(0,s.jsx)(S.Z,{size:14}),component:"a",href:e.actionUrl,target:"_blank",children:e.actionLabel||"View"}),e.isRevoked&&e.revokedReason&&(0,s.jsx)(m.b,{icon:(0,s.jsx)(A.Z,{size:16}),color:"red",variant:"light",mt:"sm",children:(0,s.jsxs)(r.Text,{size:"xs",children:["Revoked: ",e.revokedReason]})})]}),(0,s.jsxs)(c.Group,{gap:"xs",children:[(0,s.jsx)(j.u,{label:e.isRead?"Mark as Unread":"Mark as Read",children:(0,s.jsx)(y.A,{variant:"light",color:e.isRead?"gray":"green",onClick:()=>en(e.id,e.isRead),children:e.isRead?(0,s.jsx)(E.Z,{size:18}):(0,s.jsx)(z.Z,{size:18})})}),!e.isRevoked&&(0,s.jsx)(j.u,{label:"Revoke Notification",children:(0,s.jsx)(y.A,{variant:"light",color:"orange",onClick:()=>ea(e.id,e.title),children:(0,s.jsx)(I.Z,{size:18})})}),(0,s.jsx)(j.u,{label:"Delete Notification",children:(0,s.jsx)(y.A,{variant:"light",color:"red",onClick:()=>eo(e.id,e.title),children:(0,s.jsx)(B.Z,{size:18})})})]})]})})},e.id))}),$&&$.total>D&&(0,s.jsx)(v.X,{shadow:"sm",p:"md",radius:"md",withBorder:!0,children:(0,s.jsxs)(c.Group,{justify:"space-between",align:"center",wrap:"wrap",children:[(0,s.jsxs)(r.Text,{size:"sm",c:"dimmed",children:["Page ",O," of ",ee]}),(0,s.jsx)(T.t,{value:O,onChange:q,total:ee,size:"md",withEdges:!0})]})})]})]})}},34703:function(e,i,t){"use strict";t.d(i,{Z:function(){return f}});var s=t(68328),n=t(13342),a=t(12450),o=t(74556),r=t(56959),l=t(74625),c=t(71140),d=t(91024),u=t(31662),h=t(25539),m=t(39870);function f(){let e=(0,a.useRouter)(),i=(0,a.usePathname)();return(0,s.jsx)(n.m,{value:i.includes("/dashboard")?"dashboard":i.includes("/services")?"services":i.includes("/versions")?"versions":i.includes("/hospitals")?"hospitals":i.includes("/logs")?"logs":i.includes("/notifications")?"notifications":i.includes("/devices")?"devices":i.includes("/sessions")?"sessions":"dashboard",onChange:i=>{i&&e.push("/superadmin/version-admin/".concat(i))},mb:"lg",children:(0,s.jsxs)(n.m.List,{children:[(0,s.jsx)(n.m.Tab,{value:"dashboard",leftSection:(0,s.jsx)(o.Z,{size:16}),children:"Dashboard"}),(0,s.jsx)(n.m.Tab,{value:"services",leftSection:(0,s.jsx)(r.Z,{size:16}),children:"Services"}),(0,s.jsx)(n.m.Tab,{value:"versions",leftSection:(0,s.jsx)(l.Z,{size:16}),children:"Versions"}),(0,s.jsx)(n.m.Tab,{value:"hospitals",leftSection:(0,s.jsx)(c.Z,{size:16}),children:"Hospitals"}),(0,s.jsx)(n.m.Tab,{value:"logs",leftSection:(0,s.jsx)(d.Z,{size:16}),children:"Update Logs"}),(0,s.jsx)(n.m.Tab,{value:"notifications",leftSection:(0,s.jsx)(u.Z,{size:16}),children:"Notifications"}),(0,s.jsx)(n.m.Tab,{value:"sessions",leftSection:(0,s.jsx)(h.Z,{size:16}),children:"Sessions"}),(0,s.jsx)(n.m.Tab,{value:"devices",leftSection:(0,s.jsx)(m.Z,{size:16}),children:"Devices"})]})})}},72940:function(e,i,t){"use strict";t.d(i,{FD:function(){return n},Hn:function(){return s},y4:function(){return a}});let s={headers:{"Content-Type":"application/json"}},n={withCredentials:!0},a={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},24774:function(e,i,t){"use strict";t.d(i,{AI:function(){return d},JY:function(){return c},MQ:function(){return s},iU:function(){return o},j6:function(){return l},s8:function(){return r},sJ:function(){return u}});let{useGetAllNotificationsQuery:s,useGetNotificationsByDiagnosticQuery:n,useGetNotificationQuery:a,useGetNotificationStatsQuery:o,useCreateNotificationMutation:r,useMarkNotificationAsReadMutation:l,useMarkNotificationAsUnreadMutation:c,useRevokeNotificationMutation:d,useDeleteNotificationMutation:u}=t(78101).g.injectEndpoints({endpoints:e=>({getAllNotifications:e.query({query:e=>({url:"/version-admin/notifications",method:"GET",params:e||{limit:50,offset:0}}),providesTags:["versionAdmin-notifications"]}),getNotificationsByDiagnostic:e.query({query:e=>{let{diagnosticId:i,params:t}=e;return{url:"/version-admin/notifications/diagnostic/".concat(i),method:"GET",params:t||{limit:50,offset:0}}},providesTags:(e,i,t)=>{let{diagnosticId:s}=t;return[{type:"versionAdmin-notifications",id:s}]}}),getNotification:e.query({query:e=>({url:"/version-admin/notifications/".concat(e),method:"GET"}),providesTags:(e,i,t)=>[{type:"versionAdmin-notifications",id:t}]}),getNotificationStats:e.query({query:e=>({url:"/version-admin/notifications/stats",method:"GET",params:e||{}}),providesTags:["versionAdmin-notification-stats"]}),createNotification:e.mutation({query:e=>({url:"/version-admin/notifications",method:"POST",body:e}),invalidatesTags:["versionAdmin-notifications","versionAdmin-notification-stats"]}),markNotificationAsRead:e.mutation({query:e=>({url:"/version-admin/notifications/".concat(e,"/read"),method:"PATCH"}),invalidatesTags:(e,i,t)=>["versionAdmin-notifications","versionAdmin-notification-stats",{type:"versionAdmin-notifications",id:t}]}),markNotificationAsUnread:e.mutation({query:e=>({url:"/version-admin/notifications/".concat(e,"/unread"),method:"PATCH"}),invalidatesTags:(e,i,t)=>["versionAdmin-notifications","versionAdmin-notification-stats",{type:"versionAdmin-notifications",id:t}]}),revokeNotification:e.mutation({query:e=>{let{id:i,reason:t}=e;return{url:"/version-admin/notifications/".concat(i,"/revoke"),method:"PATCH",body:t?{reason:t}:{}}},invalidatesTags:(e,i,t)=>{let{id:s}=t;return["versionAdmin-notifications","versionAdmin-notification-stats",{type:"versionAdmin-notifications",id:s}]}}),deleteNotification:e.mutation({query:e=>({url:"/version-admin/notifications/".concat(e),method:"DELETE"}),invalidatesTags:["versionAdmin-notifications","versionAdmin-notification-stats"]})})})},78101:function(e,i,t){"use strict";t.d(i,{g:function(){return r}});var s=t(49854),n=t(68240),a=t(94183),o=t(28317);let r=(0,n.LC)({baseQuery:(0,a.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,i)=>fetch(e,i).then(async t=>{let n="string"==typeof e?e:e.url;return n.includes("?")||(null==i?void 0:i.body)||"string"!=typeof e&&e.body||await (0,o.t8)(n,await t.clone().json().catch(()=>null),(0,s.x)()),t}).catch(async t=>{if(t instanceof TypeError){let t="string"==typeof e?e:e.url;if(!t.includes("?")&&!(null==i?void 0:i.body)&&!("string"!=typeof e&&e.body)){let e=await (0,o.U2)(t,(0,s.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw t})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},49854:function(e,i,t){"use strict";let s;t.d(i,{d:function(){return c},x:function(){return l}});var n=t(72940),a=t(6780),o=t(67732),r=t(28317);function l(){return s||(s=(0,r.MT)("cached-responses-store","cached-responses")),s}async function c(e,i){try{let t=await a.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:i,...n.FD});return await (0,r.t8)(e,t.data,l()),t.data}catch(i){if(i instanceof o.d7&&[o.d7.ERR_NETWORK,o.d7.ETIMEDOUT].includes(i.code)){let i=await (0,r.U2)(e,l());if(i)return i}throw i instanceof o.d7&&i.response&&401===i.response.status||console.error(i),i}}}},function(e){e.O(0,[1601,3069,6945,3852,1656,9722,4670,9258,9533,966,1166,7967,6029,7140,5978,6150,9175,7402,1744],function(){return e(e.s=81401)}),_N_E=e.O()}]);