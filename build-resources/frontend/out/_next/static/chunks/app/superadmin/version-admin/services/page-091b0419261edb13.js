(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9868],{56666:function(e,n,t){Promise.resolve().then(t.bind(t,29712))},29712:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return G}});var i=t(68328),r=t(22041),s=t(22614),l=t(14587),o=t(46373),a=t(34473),c=t(41224),d=t(68242),u=t(31204),v=t(48604),p=t(76029),m=t(3741),x=t(11114),h=t(9326),j=t(9654),g=t(60711),f=t(45437),b=t(12697),w=t(67030),y=t(4505),k=t(12450),C=t(22115),S=t(25299),V=t(22975),I=t(36409),N=t(55911),E=t(57956),T=t(77303),P=t(89043),M=t(72375),z=t(47720),L=t(81014),A=t(35294);function B(e){let{opened:n,onClose:t,service:o}=e,[a,{isLoading:v}]=(0,w.MD)(),[p,{isLoading:x}]=(0,w.nR)(),{data:h,isLoading:g,isFetching:f}=(0,w.M)((null==o?void 0:o.id)||"",{skip:!(null==o?void 0:o.id)||!n}),k=null==h?void 0:h.data,S=(0,z.c)({initialValues:{name:"",displayName:"",description:"",environmentVariables:[],volumes:[]},validate:{name:e=>e?null:"Service name is required"}});(0,y.useEffect)(()=>{n&&k?S.setValues({name:k.name||"",displayName:k.displayName||"",description:k.description||"",environmentVariables:k.environmentVariables?k.environmentVariables.map(e=>({...e})):[],volumes:k.volumes?k.volumes.map(e=>({...e})):[]}):n&&!o&&S.reset()},[n,k,o]);let B=async e=>{try{(null==o?void 0:o.id)?(await p({id:o.id,data:e}).unwrap(),C.N9.show({title:"Success",message:"Service updated successfully",color:"green"})):(await a(e).unwrap(),C.N9.show({title:"Success",message:"Service created successfully",color:"green"})),t()}catch(e){var n;C.N9.show({title:"Error",message:(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.message)||"Failed to ".concat((null==o?void 0:o.id)?"update":"create"," service"),color:"red"})}},Z=()=>{S.reset(),t()};return(0,i.jsx)(V.u,{opened:n,onClose:Z,title:(null==o?void 0:o.id)?"Edit Service":"Create New Service",size:"lg",children:(null==o?void 0:o.id)&&(g||f)?(0,i.jsx)(I.M,{py:"xl",children:(0,i.jsxs)(c.Stack,{align:"center",gap:"md",children:[(0,i.jsx)(l.Loader,{size:"lg"}),(0,i.jsx)(r.Text,{size:"sm",c:"dimmed",children:"Loading service details..."})]})}):(0,i.jsx)("form",{onSubmit:S.onSubmit(B),children:(0,i.jsxs)(c.Stack,{gap:"md",children:[(0,i.jsx)(N.TextInput,{label:"Service Name",placeholder:"hms-backend",required:!0,...S.getInputProps("name")}),(0,i.jsx)(N.TextInput,{label:"Display Name",placeholder:"HMS Backend",...S.getInputProps("displayName")}),(0,i.jsx)(E.g,{label:"Description",placeholder:"Hospital Management System Backend",minRows:2,...S.getInputProps("description")}),(0,i.jsx)(T.Divider,{}),(0,i.jsxs)(s.Group,{justify:"space-between",children:[(0,i.jsx)(d.Title,{order:5,children:"Environment Variables"}),(0,i.jsxs)(s.Group,{gap:"xs",children:[(0,i.jsx)(A.Z,{environmentVariables:S.values.environmentVariables,filename:"".concat(S.values.name||"service",".env")}),(0,i.jsx)(u.Button,{size:"xs",leftSection:(0,i.jsx)(j.Z,{size:14}),variant:"light",onClick:()=>S.insertListItem("environmentVariables",{key:"",value:"",description:"",isSecret:!1}),children:"Add Variable"})]})]}),(0,i.jsx)(L.Z,{onEnvVarsExtracted:e=>{e.forEach(e=>{let n=S.values.environmentVariables.findIndex(n=>n.key===e.key);-1!==n?S.setFieldValue("environmentVariables.".concat(n),{...S.values.environmentVariables[n],...e}):S.insertListItem("environmentVariables",e)})}}),S.values.environmentVariables.map((e,n)=>(0,i.jsx)(P.X,{p:"md",withBorder:!0,children:(0,i.jsxs)(c.Stack,{gap:"xs",children:[(0,i.jsxs)(s.Group,{justify:"space-between",align:"flex-start",children:[(0,i.jsxs)(d.Title,{order:6,children:["Variable ",n+1]}),(0,i.jsx)(m.A,{color:"red",variant:"light",onClick:()=>S.removeListItem("environmentVariables",n),children:(0,i.jsx)(b.Z,{size:16})})]}),(0,i.jsx)(N.TextInput,{label:"Key",placeholder:"NODE_ENV",required:!0,...S.getInputProps("environmentVariables.".concat(n,".key"))}),(0,i.jsx)(N.TextInput,{label:"Value",placeholder:"production",required:!0,...S.getInputProps("environmentVariables.".concat(n,".value"))}),(0,i.jsx)(N.TextInput,{label:"Description",placeholder:"Environment setting",...S.getInputProps("environmentVariables.".concat(n,".description"))}),(0,i.jsx)(M.X,{label:"Is Secret",...S.getInputProps("environmentVariables.".concat(n,".isSecret"),{type:"checkbox"})})]})},e.id||e.key||"env-".concat(n))),(0,i.jsx)(T.Divider,{}),(0,i.jsxs)(s.Group,{justify:"space-between",children:[(0,i.jsx)(d.Title,{order:5,children:"Volumes"}),(0,i.jsx)(u.Button,{size:"xs",leftSection:(0,i.jsx)(j.Z,{size:14}),variant:"light",onClick:()=>S.insertListItem("volumes",{hostPath:"",containerPath:"",description:""}),children:"Add Volume"})]}),S.values.volumes.map((e,n)=>(0,i.jsx)(P.X,{p:"md",withBorder:!0,children:(0,i.jsxs)(c.Stack,{gap:"xs",children:[(0,i.jsxs)(s.Group,{justify:"space-between",align:"flex-start",children:[(0,i.jsxs)(d.Title,{order:6,children:["Volume ",n+1]}),(0,i.jsx)(m.A,{color:"red",variant:"light",onClick:()=>S.removeListItem("volumes",n),children:(0,i.jsx)(b.Z,{size:16})})]}),(0,i.jsx)(N.TextInput,{label:"Host Path",placeholder:"$(pwd)/nginx.conf",required:!0,...S.getInputProps("volumes.".concat(n,".hostPath"))}),(0,i.jsx)(N.TextInput,{label:"Container Path",placeholder:"/etc/nginx/nginx.conf",required:!0,...S.getInputProps("volumes.".concat(n,".containerPath"))}),(0,i.jsx)(N.TextInput,{label:"Description",placeholder:"Nginx configuration",...S.getInputProps("volumes.".concat(n,".description"))})]})},e.id||"volume-".concat(n))),(0,i.jsxs)(s.Group,{justify:"flex-end",mt:"md",children:[(0,i.jsx)(u.Button,{variant:"default",onClick:Z,children:"Cancel"}),(0,i.jsx)(u.Button,{type:"submit",loading:v||x,children:(null==o?void 0:o.id)?"Update Service":"Create Service"})]})]})})})}var Z=t(34703),D=t(71530);function G(){let e=(0,k.useRouter)(),[n,t]=(0,y.useState)(!1),[V,I]=(0,y.useState)(null),{data:N,isLoading:E,error:T}=(0,w.NG)({limit:50}),[P,{isLoading:M}]=(0,w.GM)(),z=(0,k.useSearchParams)().get("id");if(z)return(0,i.jsx)(D.g,{id:z});let L=(null==N?void 0:N.data)||[],A=(e,n)=>{S.qk.openConfirmModal({title:"Delete Service",children:(0,i.jsx)(r.Text,{size:"sm",children:'Are you sure you want to delete the service "'.concat(n,'"? This action cannot be undone.')}),labels:{confirm:"Delete",cancel:"Cancel"},confirmProps:{color:"red"},onConfirm:async()=>{try{await P(e).unwrap(),C.N9.show({title:"Success",message:"Service deleted successfully",color:"green"})}catch(e){var n;C.N9.show({title:"Error",message:(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.message)||"Failed to delete service",color:"red"})}}})},G=e=>{I(e),t(!0)};return E?(0,i.jsx)(s.Group,{justify:"center",py:"xl",children:(0,i.jsx)(l.Loader,{size:"lg"})}):T?(0,i.jsx)(o.b,{icon:(0,i.jsx)(h.Z,{size:16}),title:"Error",color:"red",children:"Failed to load services. Please try again later."}):(0,i.jsxs)(a.Container,{fluid:!0,children:[(0,i.jsx)(Z.Z,{}),(0,i.jsxs)(c.Stack,{gap:"lg",children:[(0,i.jsxs)(s.Group,{justify:"space-between",children:[(0,i.jsx)(d.Title,{order:2,children:"Services"}),(0,i.jsx)(u.Button,{leftSection:(0,i.jsx)(j.Z,{size:16}),onClick:()=>{I(null),t(!0)},children:"New Service"})]}),0===L.length?(0,i.jsx)(v.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,i.jsx)(r.Text,{c:"dimmed",ta:"center",children:"No services found. Create your first service to get started."})}):(0,i.jsx)(c.Stack,{gap:"md",children:L.map(n=>{var t,l;return(0,i.jsx)(v.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,i.jsxs)(c.Stack,{gap:"sm",children:[(0,i.jsxs)(s.Group,{justify:"space-between",align:"flex-start",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(d.Title,{order:4,children:n.displayName||n.name}),(0,i.jsx)(r.Text,{size:"sm",c:"dimmed",mt:4,children:n.description||"No description"})]}),(0,i.jsxs)(s.Group,{gap:"xs",children:[(0,i.jsx)(p.u,{label:"View Details",children:(0,i.jsx)(m.A,{variant:"light",color:"blue",onClick:()=>e.push("/superadmin/version-admin/services?id=".concat(n.id)),children:(0,i.jsx)(g.Z,{size:18})})}),(0,i.jsx)(p.u,{label:"Edit",children:(0,i.jsx)(m.A,{variant:"light",color:"yellow",onClick:()=>G(n),children:(0,i.jsx)(f.Z,{size:18})})}),(0,i.jsx)(p.u,{label:"Delete",children:(0,i.jsx)(m.A,{variant:"light",color:"red",onClick:()=>A(n.id,n.displayName||n.name),loading:M,children:(0,i.jsx)(b.Z,{size:18})})})]})]}),(0,i.jsxs)(s.Group,{gap:"lg",children:[(0,i.jsxs)(x.C,{variant:"light",color:"blue",children:["Env Vars: ",(null===(t=n.environmentVariables)||void 0===t?void 0:t.length)||0]}),(0,i.jsxs)(x.C,{variant:"light",color:"green",children:["Volumes: ",(null===(l=n.volumes)||void 0===l?void 0:l.length)||0]}),n.versionReleases&&n.versionReleases.length>0&&(0,i.jsxs)(x.C,{variant:"light",color:"violet",children:["Latest: ",n.versionReleases[0].version]})]})]})},n.id)})}),(0,i.jsx)(B,{opened:n,onClose:()=>{t(!1),I(null)},service:V})]})]})}},36409:function(e,n,t){"use strict";t.d(n,{M:function(){return d}});var i=t(68328);t(4505);var r=t(65786),s=t(28266),l=t(32451),o=t(4687),a={root:"m_4451eb3a"};let c={},d=(0,o.b)((e,n)=>{let t=(0,r.w)("Center",c,e),{classNames:o,className:d,style:u,styles:v,unstyled:p,vars:m,inline:x,mod:h,...j}=t,g=(0,s.y)({name:"Center",props:t,classes:a,className:d,style:u,classNames:o,styles:v,unstyled:p,vars:m});return(0,i.jsx)(l.Box,{ref:n,mod:[{inline:x},h],...g("root"),...j})});d.classes=a,d.displayName="@mantine/core/Center"},49541:function(e,n,t){"use strict";t.d(n,{P:function(){return l},n:function(){return s}});var i=t(68328),r=t(53729);function s(e){let{size:n,style:t,...s}=e,l=void 0!==n?{width:(0,r.h)(n),height:(0,r.h)(n),...t}:t;return(0,i.jsx)("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:l,"aria-hidden":!0,...s,children:(0,i.jsx)("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function l(e){let{indeterminate:n,...t}=e;return n?(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 6","aria-hidden":!0,...t,children:(0,i.jsx)("rect",{width:"32",height:"6",fill:"currentColor",rx:"3"})}):(0,i.jsx)(s,{...t})}t(4505)},22041:function(e,n,t){"use strict";t.r(n),t.d(n,{Text:function(){return x}});var i=t(68328);t(4505);var r=t(63773),s=t(55622),l=t(12498),o=t(16569),a=t(65786),c=t(28266),d=t(32451),u=t(4687),v={root:"m_b6d8b162"};let p={inherit:!1},m=(0,s.Z)((e,n)=>{let{variant:t,lineClamp:i,gradient:s,size:a,color:c}=n;return{root:{"--text-fz":(0,r.yv)(a),"--text-lh":(0,r.Dp)(a),"--text-gradient":"gradient"===t?(0,o.u)(s,e):void 0,"--text-line-clamp":"number"==typeof i?i.toString():void 0,"--text-color":c?(0,l.p)(c,e):void 0}}}),x=(0,u.b)((e,n)=>{let t=(0,a.w)("Text",p,e),{lineClamp:r,truncate:s,inline:l,inherit:o,gradient:u,span:x,__staticSelector:h,vars:j,className:g,style:f,classNames:b,styles:w,unstyled:y,variant:k,mod:C,size:S,...V}=t,I=(0,c.y)({name:["Text",h],props:t,classes:v,className:g,style:f,classNames:b,styles:w,unstyled:y,vars:j,varsResolver:m});return(0,i.jsx)(d.Box,{...I("root",{focusable:!0}),ref:n,component:x?"span":"p",variant:k,mod:[{"data-truncate":"start"===s?"start":"end"===s||s?"end":void 0,"data-line-clamp":"number"==typeof r,"data-inline":l,"data-inherit":o},C],size:S,...V})});x.classes=v,x.displayName="@mantine/core/Text"},11686:function(e,n,t){"use strict";t.d(n,{c:function(){return function e(n,t){return Array.isArray(n)?[...n].reduce((n,i)=>({...n,...e(i,t)}),{}):"function"==typeof n?n(t):null==n?{}:n}}})},57434:function(e,n,t){"use strict";t.d(n,{C:function(){return r}});var i=t(4505);function r(e){let{value:n,defaultValue:t,finalValue:r,onChange:s=()=>{}}=e,[l,o]=(0,i.useState)(void 0!==t?t:r);return void 0!==n?[n,s,!0]:[l,function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];o(e),null==s||s(e,...t)},!1]}},25299:function(e,n,t){"use strict";t.d(n,{qk:function(){return a},Ro:function(){return l}});var i,r=t(74467),s=t(51727);let[l,o]=(i="mantine-modals",[function(e){let n=Object.keys(e).reduce((n,t)=>(n["".concat(i,":").concat(t)]=n=>e[t](n.detail),n),{});(0,r.Y)(()=>(Object.keys(n).forEach(e=>{window.removeEventListener(e,n[e]),window.addEventListener(e,n[e])}),()=>Object.keys(n).forEach(e=>{window.removeEventListener(e,n[e])})),[n])},function(e){return function(){for(var n,t,r=arguments.length,s=Array(r),l=0;l<r;l++)s[l]=arguments[l];return n="".concat(i,":").concat(String(e)),t=s[0],void window.dispatchEvent(new CustomEvent(n,{detail:t}))}}]),a={open:e=>{let n=e.modalId||(0,s.k)();return o("openModal")({...e,modalId:n}),n},close:o("closeModal"),closeAll:o("closeAllModals"),openConfirmModal:e=>{let n=e.modalId||(0,s.k)();return o("openConfirmModal")({...e,modalId:n}),n},openContextModal:e=>{let n=e.modalId||(0,s.k)();return o("openContextModal")({...e,modalId:n}),n},updateModal:e=>o("updateModal")(e),updateContextModal:e=>o("updateContextModal")(e)}}},function(e){e.O(0,[1601,3069,6945,3852,1656,9722,4670,9258,966,12,7538,6029,4927,9645,5978,1036,3369,9175,7402,1744],function(){return e(e.s=56666)}),_N_E=e.O()}]);