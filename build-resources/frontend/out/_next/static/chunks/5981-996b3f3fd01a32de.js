(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5981],{75981:function(e,t,n){"use strict";var i=n(68328),a=n(38823),r=n(68718),s=n(48604),o=n(68242),u=n(21288),l=n(23138),d=n(31204),c=n(90655),g=n(23583),p=n(4505),m=n(90660),h=n.n(m),f=n(14193);t.Z=e=>{let{signInfo:t}=e,[n,m]=(0,p.useState)(0),y=f.Ry({name:f.Z_().required(" Name is Required"),designation:f.Z_().required("Designation  is Required")}),[v,w]=(0,p.useState)(null),[S,x]=(0,p.useState)((null==t?void 0:t.image)||""),[T,{isLoading:b}]=(0,r.ht)(),[D,{isLoading:A}]=(0,r.ER)(),E=e=>{if(e){w(e);let t=new FileReader;t.onloadend=()=>{x(t.result)},t.readAsDataURL(e)}else x("")};return(0,p.useMemo)(()=>{(null==t?void 0:t.image)&&x(null==t?void 0:t.image)},[t]),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"2rem"},children:(0,i.jsxs)(s.Z,{style:{width:"50%"},shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[(0,i.jsxs)(o.Title,{children:[t?"Update":"Add New"," Sign"]}),(0,i.jsx)(g.J9,{enableReinitialize:!0,validationSchema:y,initialValues:{name:(null==t?void 0:t.name)||"",designation:(null==t?void 0:t.designation)||"",image:null},onSubmit:async(e,n)=>{let{setSubmitting:i,resetForm:a,setFieldValue:r}=n;try{if(i(!0),t){let{name:n,designation:i,...a}=e,r={name:n,designation:i};v&&(r={...r,image:v}),await D({id:null==t?void 0:t.id,...r})&&h().fire("Success","Updated Signature Data","success")}else{let t={...e,...v&&{image:v}},n=await T(t);if("error"in n)throw console.log(n,t),Error("Unknown Error Occurred");n&&(h().fire("Success","Added Signature Data","success"),a(),w(null),r("image",null),m(e=>e+1),x(""))}}catch(e){h().fire("Error","Something Went Wrong","error")}finally{i(!1)}},children:e=>{let{values:r,handleChange:s,handleSubmit:o,setFieldValue:p,isSubmitting:m,errors:h,touched:f}=e;return(0,i.jsxs)(g.l0,{onSubmit:o,style:{width:"100%"},children:[(0,i.jsx)(a.Z,{label:"Name",withAsterisk:!0,placeholder:"Type Name",value:r.name,onChange:s,type:"text",name:"name",error:h.name}),(0,i.jsx)(a.Z,{label:"Description",withAsterisk:!0,placeholder:"Type Description",value:r.designation,onChange:s,type:"text",name:"designation",error:h.designation}),(0,i.jsx)(u.S,{clearable:!0,name:"image",accept:"image/*",onChange:E,leftSection:(0,i.jsx)(c.Z,{}),label:"Attach Signature",placeholder:"Signature",leftSectionPointerEvents:"none",style:{marginTop:"1rem"},withAsterisk:!0},n),S&&(0,i.jsx)(l.E,{src:S,alt:"Preview",width:200,height:100,style:{marginTop:"1rem",marginBottom:"1rem",width:"200px",height:"40px"}}),(0,i.jsx)(d.Button,{loading:m,type:"submit",size:"lg",className:"mt-3",style:{marginTop:"1rem"},children:t?"Update Sign":"Add Sign"})]})}})]})})}},38823:function(e,t,n){"use strict";n.d(t,{E:function(){return c}});var i=n(68328),a=n(30331),r=n(55911),s=n(73626),o=n(23583),u=n(4505),l=n(49749),d=n.n(l);let c={size:"md",variant:"filled",radius:"md"},g={mt:"md",withAsterisk:!1},p=(0,u.memo)(function(e){let{onChange:t,onBlur:n,onClick:o,value:l,useFieldResult:p,...m}=e,[{value:h,onChange:f,onBlur:y,...v},w,S]=p,x=(0,u.useRef)(null),T=(0,s.y)(()=>{if(x.current){let e;let{type:t,value:n}=x.current;S.setValue("number"===t?isNaN(e=parseFloat(n))?"":e:n)}},200);return(0,u.useEffect)(()=>{x.current&&x.current.value!==h&&!(document.hasFocus()&&document.activeElement===x.current)&&(x.current.value=null!=h?h:"")},[h]),(0,i.jsx)(r.TextInput,{ref:x,error:w.touched&&w.error,defaultValue:h,classNames:d(),onChange:e=>{T()},onBlur:e=>{null==n||n(e),y(e)},onClick:e=>{"number"===m.type&&"0"===e.currentTarget.value&&e.currentTarget.select(),null==o||o(e)},onWheel:a.P,...v,...g,...c,...m})},(e,t)=>e.useFieldResult[0].value===t.useFieldResult[0].value&&e.useFieldResult[1].touched===t.useFieldResult[1].touched&&e.useFieldResult[1].error===t.useFieldResult[1].error&&e.error===t.error);t.Z=e=>(0,i.jsx)(p,{useFieldResult:(0,o.U$)(e.name),...e})},72940:function(e,t,n){"use strict";n.d(t,{FD:function(){return a},Hn:function(){return i},y4:function(){return r}});let i={headers:{"Content-Type":"application/json"}},a={withCredentials:!0},r={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},78101:function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var i=n(49854),a=n(68240),r=n(94183),s=n(28317);let o=(0,a.LC)({baseQuery:(0,r.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,t)=>fetch(e,t).then(async n=>{let a="string"==typeof e?e:e.url;return a.includes("?")||(null==t?void 0:t.body)||"string"!=typeof e&&e.body||await (0,s.t8)(a,await n.clone().json().catch(()=>null),(0,i.x)()),n}).catch(async n=>{if(n instanceof TypeError){let n="string"==typeof e?e:e.url;if(!n.includes("?")&&!(null==t?void 0:t.body)&&!("string"!=typeof e&&e.body)){let e=await (0,s.U2)(n,(0,i.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw n})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},68718:function(e,t,n){"use strict";n.d(t,{Ck:function(){return a},ER:function(){return s},U6:function(){return o},Um:function(){return u},ht:function(){return r}});let i=n(78101).g.injectEndpoints({endpoints:e=>({getSigns:e.query({query:()=>({url:"/signatures"}),keepUnusedDataFor:86400,transformResponse:e=>(Array.isArray(null==e?void 0:e.data)&&e.data.sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),e)}),createSign:e.mutation({query:e=>{var t;let n=new FormData;return n.append("name",e.name),e.designation&&n.append("designation",e.designation),e.image&&n.append("image",null==e?void 0:e.image,null==e?void 0:null===(t=e.image)||void 0===t?void 0:t.name),{url:"/signatures",method:"POST",body:n}},async onQueryStarted(e,t){let{dispatch:n,queryFulfilled:a}=t,r=Date.now().toString(36),s=n(i.util.updateQueryData("getSigns",void 0,t=>{t.data.push({...e,id:r,loading:!0})}));try{let{data:e}=await a;n(i.util.updateQueryData("getSigns",void 0,t=>{let n=t.data.findIndex(e=>e.id===r);n>=0&&(t.data[n]=e.data)}))}catch(e){s.undo()}}}),updateSign:e.mutation({query:e=>{let{id:t,...n}=e,i=new FormData;return i.append("name",n.name),n.designation&&i.append("designation",n.designation),n.image&&i.append("image",n.image,n.image.name),{url:"/signatures/".concat(t),method:"PATCH",body:i}},async onQueryStarted(e,t){let{id:n,...a}=e,{dispatch:r,queryFulfilled:s}=t,o=r(i.util.updateQueryData("getSigns",void 0,e=>{let t=e.data.findIndex(e=>e.id===n);t>=0&&(e.data[t]={...e.data[t],...a})}));try{let{data:e}=await s;r(i.util.updateQueryData("getSigns",void 0,t=>{let i=t.data.findIndex(e=>e.id===n);i>=0&&(t.data[i]=e.data)}))}catch(e){o.undo()}}}),deleteSign:e.mutation({query:e=>({url:"/signatures/".concat(e),method:"DELETE"}),async onQueryStarted(e,t){let{dispatch:n,queryFulfilled:a}=t,r=n(i.util.updateQueryData("getSigns",void 0,t=>{let n=t.data.find(t=>t.id===e);n&&(n.loading=!0)}));try{await a,n(i.util.updateQueryData("getSigns",void 0,t=>{let n=t.data.findIndex(t=>t.id===e);n>=0&&t.data.splice(n,1)}))}catch(e){r.undo()}}}),getSingleSign:e.query({query:e=>({url:"/signatures/".concat(e)})})})}),{useGetSignsQuery:a,useCreateSignMutation:r,useUpdateSignMutation:s,useDeleteSignMutation:o,useGetSingleSignQuery:u}=i},49854:function(e,t,n){"use strict";let i;n.d(t,{d:function(){return l},x:function(){return u}});var a=n(72940),r=n(6780),s=n(67732),o=n(28317);function u(){return i||(i=(0,o.MT)("cached-responses-store","cached-responses")),i}async function l(e,t){try{let n=await r.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...a.FD});return await (0,o.t8)(e,n.data,u()),n.data}catch(t){if(t instanceof s.d7&&[s.d7.ERR_NETWORK,s.d7.ETIMEDOUT].includes(t.code)){let t=await (0,o.U2)(e,u());if(t)return t}throw t instanceof s.d7&&t.response&&401===t.response.status||console.error(t),t}}},30331:function(e,t,n){"use strict";function i(e){e.currentTarget.blur(),e.stopPropagation(),setTimeout(()=>{var t;null==e||null===(t=e.currentTarget)||void 0===t||t.focus()},0)}n.d(t,{P:function(){return i}})},49749:function(e){e.exports={input:"InputFieldWithOptionsFast_input__HgGdh",placeholder:"InputFieldWithOptionsFast_placeholder__EagU9",wrapper:"InputFieldWithOptionsFast_wrapper__8GXHB"}}}]);