(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5320],{24811:function(e,t,i){"use strict";i.d(t,{P:function(){return M}});var n=i(68328),r=i(4505);let{useCreateNoticeMutation:l,useGetNoticesQuery:o,useGetNoticeQuery:s,useUpdateNoticeMutation:a,useDeleteNoticeMutation:c,useGetActiveNoticesQuery:d}=i(78101).g.injectEndpoints({endpoints:e=>({createNotice:e.mutation({query:e=>({url:"/appointment/notice",method:"POST",body:e}),invalidatesTags:["notice"]}),getNotices:e.query({query:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{url:"/appointment/notice",method:"GET",params:e}},providesTags:["notice"],transformResponse:e=>({data:e.data})}),getNotice:e.query({query:e=>({url:"/appointment/notice/".concat(e),method:"GET"}),providesTags:["notice"],transformResponse:e=>({data:e.data})}),updateNotice:e.mutation({query:e=>{let{id:t,...i}=e;return{url:"/appointment/notice/".concat(t),method:"PATCH",body:i}},invalidatesTags:["notice"]}),deleteNotice:e.mutation({query:e=>({url:"/appointment/notice/".concat(e),method:"DELETE"}),invalidatesTags:["notice"]}),getActiveNotices:e.query({query:e=>({url:"/appointment/notice/active/".concat(e),method:"GET"}),providesTags:["notice"],transformResponse:e=>({data:e.data})})})});var u=i(41224),h=i(22975),m=i(14587),p=i(46373),x=i(22041),g=i(22614),f=i(31204),j=i(87967),v=i(57956),S=i(55911),y=i(31151);function w(e){let{doctorSessionId:t,opened:i,onClose:o}=e,[s,{isLoading:a}]=l(),[c,d]=(0,r.useState)(null),[m,p]=(0,r.useState)(""),[x,w]=(0,r.useState)(""),[T,b]=(0,r.useState)("");(0,r.useEffect)(()=>{i&&(d(null),p(""),w(new Date().toISOString().slice(0,16)),b(""))},[i]);let N=async()=>{try{if(!c)throw Error("Notice type is required");if(!m.trim())throw Error("Message is required");if(!x)throw Error("Start time is required");await s({doctorSessionId:t,type:c,message:m.trim(),startTime:x,approximateDurationInMinutes:Number(T)||0}).unwrap(),y.toast.success("Notice created successfully!"),o()}catch(t){var e;y.toast.error("Failed to create notice",{description:(null===(e=t.data)||void 0===e?void 0:e.message)||"Please try again"})}};return(0,n.jsx)(h.u,{opened:i,onClose:o,title:"Create Notice",size:"md",centered:!0,children:(0,n.jsxs)(u.Stack,{gap:"md",children:[(0,n.jsx)(j.P,{label:"Notice Type",placeholder:"Select notice type",data:[{value:"DELAY_NOTICE",label:"Delay Notice"},{value:"GENERAL",label:"General"},{value:"NAMAZ",label:"Namaz Break"},{value:"FOOD",label:"Food Break"},{value:"OTHER",label:"Other"},{value:"BREAK",label:"Break"},{value:"EMERGENCY",label:"Emergency"}],value:c,onChange:e=>d(e),required:!0}),(0,n.jsx)(v.g,{label:"Message",placeholder:"Enter notice message",value:m,onChange:e=>p(e.currentTarget.value),required:!0,minRows:3}),(0,n.jsx)(S.TextInput,{label:"Start Time",type:"datetime-local",value:x,onChange:e=>w(e.currentTarget.value),disabled:!0,required:!0}),(0,n.jsx)(S.TextInput,{label:"Approximate Duration (minutes)",type:"number",placeholder:"Enter duration in minutes (optional)",value:T,onChange:e=>b(e.currentTarget.value),min:0}),(0,n.jsxs)(g.Group,{justify:"right",mt:"md",children:[(0,n.jsx)(f.Button,{variant:"default",onClick:o,disabled:a,children:"Cancel"}),(0,n.jsx)(f.Button,{onClick:N,loading:a,disabled:!c||!m.trim()||!x||a,children:"Create Notice"})]})]})})}var T=i(48604),b=i(11114),N=i(76029),C=i(3741),k=i(95120),z=i(12697);function E(e){let{notice:t}=e,[i,{isLoading:r}]=c(),[l,{isLoading:o}]=a(),s=async()=>{try{await l({id:t.id,endTime:new Date().toISOString(),isActive:!1}).unwrap(),y.toast.success("Notice ended successfully")}catch(e){y.toast.error("Failed to end notice")}},d=async()=>{try{await i(t.id).unwrap(),y.toast.success("Notice deleted successfully")}catch(e){y.toast.error("Failed to delete notice")}},h=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(0,n.jsxs)(T.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,w:"100%",children:[(0,n.jsxs)(g.Group,{justify:"space-between",mb:"sm",children:[(0,n.jsx)(b.C,{color:t.isActive?"green":"gray",variant:"light",children:t.type.split("_").join(" ")}),(0,n.jsxs)(x.Text,{size:"sm",c:"dimmed",children:[t.approximateDurationInMinutes," minutes"]})]}),(0,n.jsxs)(g.Group,{justify:"space-between",align:"top",children:[(0,n.jsxs)(u.Stack,{gap:4,style:{flex:1},children:[(0,n.jsxs)(x.Text,{size:"sm",lineClamp:2,children:[(0,n.jsx)(x.Text,{span:!0,size:"sm",c:"dimmed",fw:600,mr:6,children:"Message:"}),t.message]}),(0,n.jsxs)(x.Text,{size:"sm",children:[(0,n.jsx)(x.Text,{span:!0,size:"sm",c:"dimmed",fw:600,mr:6,children:"Time:"}),h(t.startTime),t.endTime&&(0,n.jsxs)(n.Fragment,{children:[" - ",h(t.endTime)]})]})]}),(0,n.jsxs)(g.Group,{justify:"right",gap:"xs",children:[t.isActive&&(0,n.jsx)(N.u,{label:"End Notice",children:(0,n.jsx)(C.A,{variant:"light",color:"orange",onClick:s,disabled:o,"aria-label":"End Notice",children:(0,n.jsx)(k.Z,{size:16})})}),(0,n.jsx)(N.u,{label:"Delete Notice",children:(0,n.jsx)(C.A,{variant:"light",color:"red",onClick:d,disabled:r,"aria-label":"Delete",children:(0,n.jsx)(z.Z,{size:16})})})]})]})]})}var A=i(4938);function M(e){var t,i,l,s;let{doctorSessionId:a,opened:c,onClose:d,setShowNotices:j}=e,{data:v,isLoading:S,error:y}=o({doctorSessionId:a},{skip:!c||!a}),[T,b]=(0,r.useState)(!1);return(0,n.jsxs)(u.Stack,{children:[(0,n.jsx)(h.u,{opened:c,onClose:d,title:"Session Notices",centered:!0,size:"lg",children:(0,n.jsxs)(u.Stack,{mih:300,children:[S&&(0,n.jsx)(m.Loader,{m:"auto"}),y&&(0,n.jsx)(p.b,{color:"red",title:"Error",children:"Failed to load notices."}),(null==v?void 0:null===(i=v.data)||void 0===i?void 0:null===(t=i.notices)||void 0===t?void 0:t.length)?(0,n.jsx)(u.Stack,{gap:"sm",children:[...v.data.notices].sort((e,t)=>Number(t.isActive)-Number(e.isActive)).map(e=>(0,n.jsx)(E,{notice:e},e.id))}):!S&&(0,n.jsxs)(u.Stack,{gap:"md",align:"center",justify:"center",m:"auto",children:[(0,n.jsx)(A.Z,{size:72,color:"gray"}),(0,n.jsxs)(x.Text,{c:"dimmed",ta:"center",m:"auto",children:["No notices found for this session. ",(0,n.jsx)("br",{}),"Add one using the create button."]})]}),(0,n.jsxs)(g.Group,{justify:"right",mt:"auto",children:[(0,n.jsx)(f.Button,{variant:"default",onClick:d,children:"Cancel"}),j&&(0,n.jsx)(f.Button,{disabled:!(null==v?void 0:null===(s=v.data)||void 0===s?void 0:null===(l=s.notices)||void 0===l?void 0:l.filter(e=>e.isActive).length),variant:"light",onClick:()=>{j(),d()},children:"Show Notices"}),(0,n.jsx)(f.Button,{onClick:()=>b(!0),children:"Create Notice"})]})]})}),(0,n.jsx)(w,{doctorSessionId:a,opened:T,onClose:()=>b(!1)})]})}},26543:function(e,t,i){"use strict";i.d(t,{Z:function(){return f}});var n=i(68328),r=i(33908),l=i.n(r),o=i(89043),s=i(16391),a=i(22041),c=i(25338),d=i.n(c),u=function(e){var t;let{items:i,showSerialNo:r,showSerialTime:c,fontSizeMultiplier:u}=e,h=i.at(-1),m=l()(null==h?void 0:h.timeOf).format("hh:mm A"),p=28*u;return(0,n.jsx)("div",{className:d().container,children:(0,n.jsx)(o.X,{p:"lg",radius:"md",withBorder:!0,style:{background:"var(--mantine-color-lime-0)",borderColor:"var(--mantine-color-green-5)"},children:(0,n.jsxs)(s.k,{align:"center",gap:"md",children:[r&&(0,n.jsx)(a.Text,{style:{fontSize:p,fontWeight:600,minWidth:"100px"},children:i.map(e=>e.serialNo.toUpperCase()).join(" • ")}),1===i.length?(0,n.jsx)(a.Text,{style:{fontSize:p},children:null===(t=i[0].patient)||void 0===t?void 0:t.name.toUpperCase()}):(0,n.jsxs)(a.Text,{style:{fontSize:p},children:["(",i.length," Patient",i.length>1?"s":"",")"]}),(0,n.jsx)(a.Text,{style:{fontSize:p,marginLeft:"auto"},children:"On Going"}),c&&(0,n.jsx)(a.Text,{style:{fontSize:p,width:"200px",textAlign:"right"},children:m})]})})})},h=i(54632),m=function(e){let{items:t,highlight:i=!1,showSerialNo:r=!0,showSerialTime:s=!0,fontSizeMultiplier:a}=e,c=28*a;return(0,n.jsx)("div",{className:d().container,children:(0,n.jsxs)(o.X,{p:"md",radius:"md",withBorder:!0,shadow:i?"sm":void 0,style:{background:i?"var(--mantine-color-blue-0)":"white",borderColor:i?"var(--mantine-color-blue-5)":void 0},children:[i&&(0,n.jsx)("div",{className:d().ping}),(0,n.jsx)(h.i,{children:(0,n.jsx)(h.i.Tbody,{children:t.map(e=>{var t;let o=l()(e.timeOf).format("hh:mm A");return(0,n.jsxs)(h.i.Tr,{children:[r&&(0,n.jsx)(h.i.Td,{style:{fontSize:c,fontWeight:600,width:"100px"},children:e.serialNo.toUpperCase()}),(0,n.jsxs)(h.i.Td,{style:{fontSize:c,textAlign:"left"},children:[null===(t=e.patient)||void 0===t?void 0:t.name.toUpperCase(),e.isReportQueue&&" (REPORT)"]}),(0,n.jsx)(h.i.Td,{style:{fontSize:c,textAlign:"right"},children:i?"Next Up":"Waiting"}),s&&(0,n.jsx)(h.i.Td,{style:{fontSize:c,textAlign:"right",width:"200px"},children:o})]},e.id)})})})]})})},p=function(e){var t;let{item:i,highlight:r=!1,onGoing:c=!1,showSerialNo:u=!0,showSerialTime:h=!0,fontSizeMultiplier:m}=e;if(!i)return null;let p=l()(null==i?void 0:i.timeOf).format("hh:mm A"),x=28*m;return(0,n.jsx)("div",{className:d().container,children:(0,n.jsxs)(o.X,{p:"lg",radius:"md",withBorder:!0,shadow:r?"sm":void 0,style:{background:r?"var(--mantine-color-blue-0)":c?"var(--mantine-color-lime-0)":"white",borderColor:r?"var(--mantine-color-blue-5)":c?"var(--mantine-color-green-5)":void 0},children:[r&&(0,n.jsx)("div",{className:d().ping}),(0,n.jsxs)(s.k,{align:"center",gap:"md",children:[u&&(0,n.jsx)(a.Text,{style:{fontSize:x,fontWeight:600,minWidth:"100px"},children:i.serialNo.toUpperCase()}),(0,n.jsxs)(a.Text,{style:{fontSize:x},children:[null===(t=i.patient)||void 0===t?void 0:t.name.toUpperCase(),i.isReportQueue&&" (REPORT)"]}),(0,n.jsx)(a.Text,{style:{fontSize:x,marginLeft:"auto"},children:c?"On Going":r?"Next Up":"Waiting"}),h&&(0,n.jsx)(a.Text,{style:{fontSize:x,width:"200px",textAlign:"right"},children:p})]})]})})};function x(e){let{fullLength:t,patientsDisplay:i,fontSizeMultiplier:r}=e;return(0,n.jsx)(o.X,{p:"md",radius:"md",withBorder:!0,children:(0,n.jsxs)(a.Text,{style:{fontSize:28*r,textAlign:"center"},children:[t-i," More Patients ↓"]})})}function g(e){let{fontSizeMultiplier:t}=e;return(0,n.jsx)(o.X,{p:"md",radius:"md",withBorder:!0,children:(0,n.jsx)(a.Text,{style:{fontSize:28*t,textAlign:"center"},children:"Please wait for your turn."})})}function f(e){let{patientGroup:t,ongoing:i,upcoming:r,showSerialNo:l,showSerialTime:o,automaticGrouping:s,onGoingFullLength:a,fontSizeMultiplier:c}=e,d=s?i.length||1:t;if(1!==d)return(0,n.jsxs)(n.Fragment,{children:[i.length>0?(0,n.jsx)(u,{fontSizeMultiplier:c,items:i,showSerialNo:l,showSerialTime:o}):(0,n.jsx)(g,{fontSizeMultiplier:c}),(function(e,t){let i=[];for(let n=0;n<e.length;n+=t)i.push(e.slice(n,n+t));return i})(r,d).map((e,t)=>(0,n.jsx)(m,{fontSizeMultiplier:c,items:e,title:"Upcoming Group ".concat(t+1),highlight:0===t,showSerialNo:l,showSerialTime:o},t)),a>r.length&&(0,n.jsx)(x,{fullLength:a,patientsDisplay:r.length,fontSizeMultiplier:c})]});{let e=r[0],t=r.slice(1);return(0,n.jsxs)(n.Fragment,{children:[i.length>0?(0,n.jsx)(u,{fontSizeMultiplier:c,items:i,showSerialNo:l,showSerialTime:o}):(0,n.jsx)(g,{fontSizeMultiplier:c}),e&&(0,n.jsx)(p,{fontSizeMultiplier:c,item:e,highlight:!0,showSerialNo:l,showSerialTime:o}),t.map(e=>(0,n.jsx)(p,{fontSizeMultiplier:c,item:e,showSerialNo:l,showSerialTime:o},e.id)),a>r.length&&(0,n.jsx)(x,{fullLength:a,patientsDisplay:r.length,fontSizeMultiplier:c})]})}}},17443:function(e,t,i){"use strict";i.d(t,{Z:function(){return u}});var n=i(68328),r=i(16391),l=i(41224),o=i(22041),s=i(22975),a=i(24672),c=i(6936);function d(e){let{notices:t,fontSizeMultiplier:i,showNotices:r,setShowNotices:d}=e;return(0,n.jsx)(s.u,{opened:t.length>0&&r,title:(0,n.jsxs)(o.Text,{fw:600,c:"dimmed",children:[t.length>1&&t.length," Notice",t.length>1?"s":""]}),onClose:d,centered:!0,size:"xl",children:(0,n.jsx)(a.tq,{slidesPerView:1,direction:"horizontal",loop:!0,autoplay:{delay:7e3,disableOnInteraction:!1,waitForTransition:!0},modules:[c.pt],children:t.map(e=>(0,n.jsx)(a.o5,{children:(0,n.jsxs)(l.Stack,{gap:20,pb:40,children:[(0,n.jsx)(o.Text,{fw:600,ta:"center",style:{fontSize:44*i,lineHeight:1},children:e.approximateDurationInMinutes?"".concat(e.approximateDurationInMinutes," MINUTE BREAK"):e.type}),(0,n.jsxs)(o.Text,{fw:300,style:{fontSize:36*i,lineHeight:1},ta:"center",children:["Announcement time:"," ",new Date(e.startTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})]}),(0,n.jsx)(o.Text,{fw:400,style:{fontSize:36*i,lineHeight:1},ta:"center",c:"dimmed",children:e.message})]})},e.id))})})}i(36291),i(89982);var u=function(e){let{leftContent:t,rightContent:i,showSerialNo:s,showNotices:a,fontSizeMultiplier:c,setShowNotices:u,notices:h}=e;return(0,n.jsxs)(r.k,{w:"100%",h:"100vh",gap:0,style:{position:"relative"},children:[(0,n.jsxs)(l.Stack,{w:"30%",bg:"white",style:{borderRight:"1px solid var(--mantine-color-gray-3)"},p:"lg",align:"center",children:[(0,n.jsx)(o.Text,{fw:600,mb:"sm",c:"dimmed",size:"30px",children:"Upcoming Patients"}),t,(0,n.jsx)(o.Text,{size:"sm",c:"dimmed",ta:"center",mt:"auto",children:"Powered by SasthoTech"})]}),(0,n.jsx)(l.Stack,{flex:1,p:"xl",my:"auto",style:{overflow:"clip"},children:i}),(0,n.jsx)(d,{fontSizeMultiplier:c,notices:h||[],showNotices:a,setShowNotices:u})]})}},24590:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var n=i(68328),r=i(22041),l=i(4505),o=i(24672),s=i(6936);function a(e){let{patientGroup:t,upcoming:i,showSerialNo:r,fontSizeMultiplier:a}=e,[d,u]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{u(!1);let e=setTimeout(()=>{u(!0)},10);return()=>clearTimeout(e)},[i,t]),!1===d||!1===r)?null:(0,n.jsx)(o.tq,{slidesPerView:"auto",direction:"vertical",speed:1500,autoplay:{delay:1,disableOnInteraction:!1,waitForTransition:!0},modules:[s.pt],children:i.slice(0,t||1).map(e=>(0,n.jsx)(o.o5,{children:(0,n.jsx)(c,{text:e.serialNo.toUpperCase(),fontSizeMultiplier:a},e.id)},e.id))})}function c(e){let{text:t,fontSizeMultiplier:i}=e,o=(0,l.useRef)(null);return(0,l.useLayoutEffect)(()=>{if(o.current){let e=o.current.getBoundingClientRect().width,t=window.innerWidth;e>.3*t-60&&(o.current.style.fontSize="calc(min(calc(".concat(o.current.style.fontSize," * ").concat((.3*t-60)/e,"), 180px) * ").concat(i,")")),o.current.style.opacity="1"}}),(0,n.jsx)(r.Text,{ref:o,fw:600,style:{width:"max-content",fontSize:"1000px",lineHeight:1,letterSpacing:-1,opacity:0,marginInline:"auto",marginTop:20},c:"dark",children:t})}i(89982),i(22385),i(36291)},99238:function(e,t,i){"use strict";i.d(t,{Z:function(){return h}});var n=i(68328),r=i(22975),l=i(41224),o=i(29259),s=i(81209),a=i(22041),c=i(18952),d=i(31204),u=i(4505);function h(e){let{opened:t,onClose:i,initialSettings:h,onSave:m}=e,[p,x]=(0,u.useState)(h);return(0,n.jsx)(r.u,{opened:t,onClose:i,title:"Settings",centered:!0,children:(0,n.jsxs)(l.Stack,{style:{overflow:"clip"},children:[(0,n.jsx)(o.Y,{label:"Patient Group",value:p.patientGroup,onChange:e=>{x(t=>({...t,patientGroup:"number"==typeof e?e:t.patientGroup}))},min:1,max:10,disabled:p.automaticGrouping}),(0,n.jsx)(s.r,{label:"Automatic Patient Grouping",checked:p.automaticGrouping,onChange:e=>x(t=>({...t,automaticGrouping:e.target.checked}))}),(0,n.jsx)(s.r,{label:"Show Serial No",checked:p.showSerialNo,onChange:e=>x(t=>({...t,showSerialNo:e.target.checked}))}),(0,n.jsx)(s.r,{label:"Show Serial Time",checked:p.showSerialTime,onChange:e=>(console.log(e),x(t=>({...t,showSerialTime:e.target.checked})))}),(0,n.jsx)(s.r,{label:"Enable Patients Limit",checked:p.enablePatientsDisplay,onChange:e=>x(t=>({...t,enablePatientsDisplay:e.target.checked}))}),(0,n.jsx)(o.Y,{label:"Patients Limit",value:p.patientsDisplay,onChange:e=>{x(t=>({...t,patientsDisplay:"number"==typeof e?e:t.patientsDisplay}))},min:1,max:100,disabled:!p.enablePatientsDisplay}),(0,n.jsxs)(l.Stack,{gap:4,children:[(0,n.jsxs)(a.Text,{size:"sm",fw:500,children:["Font Size Multiplier: ",p.fontSizeMultiplier,"x"]}),(0,n.jsx)(c.i,{value:p.fontSizeMultiplier,label:null,onChange:e=>x(t=>({...t,fontSizeMultiplier:e})),min:.2,max:1.5,step:.1})]}),(0,n.jsx)(d.Button,{onClick:()=>{m(p),i()},children:"Save"})]})})}},21864:function(e,t,i){"use strict";i.d(t,{q:function(){return l}});var n=i(4505);let r={patientGroup:1,showSerialNo:!0,showSerialTime:!0,automaticGrouping:!1,patientsDisplay:10,enablePatientsDisplay:!0,fontSizeMultiplier:1};function l(){let[e,t]=(0,n.useState)(()=>{let e;let t=localStorage.getItem("queueSettings");if(t)try{let i=JSON.parse(t);e={...r,...i}}catch(t){console.error("Failed to parse queueSettings",t),e=r}else e=r,localStorage.setItem("queueSettings",JSON.stringify(e));return e});return(0,n.useEffect)(()=>{localStorage.setItem("queueSettings",JSON.stringify(e))},[e]),{settings:e,setSettings:t}}},91622:function(e,t,i){"use strict";i.d(t,{N:function(){return l}});var n=i(4505),r=i(86);let l=e=>{let[t,i]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let t="http://sasthotech.local:5000";if(!t){console.error("NEXT_PUBLIC_SOCKET_URL is not defined");return}let n=(0,r.ZP)(t,{transports:["websocket","polling"]});return n.on("connect",()=>{console.log("Connected to socket:",n.id),n.emit("joinQueue",e)}),n.on("queueUpdate",e=>{i(e)}),n.on("error",e=>{console.error("Socket error:",e)}),n.on("disconnect",()=>{console.log("Disconnected from socket")}),()=>{n.disconnect()}},[e.doctorChamberId,e.slotId,e.sessionId,e.diagnosticId]),t}},22385:function(){},25338:function(e){e.exports={container:"queue_container__PCNTT",ping:"queue_ping__5VXh_",outlineGrow:"queue_outlineGrow__f3cgs"}}}]);