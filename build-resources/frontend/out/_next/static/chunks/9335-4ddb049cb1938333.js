(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9335],{71256:function(e,i,t){"use strict";var o=t(68328),s=t(22614),l=t(22041),n=t(77303),r=t(62471);i.Z=e=>{let{diagnostic:i,email:t,children:d,color:a,patientId:c,small:u,large:m,isBigLogo:v,idLabel:h,idBorder:x,labId:p}=e,g=(0,r._)({key:"print-show-division-name",defaultValue:"true"});return(0,o.jsxs)("div",{className:"diagnostic-info1",children:[(0,o.jsx)(s.Group,{children:v&&(0,o.jsx)("img",{style:{aspectRatio:"auto",width:"100%",height:"100px"},src:"/images/heathcare.png",alt:"Diagnotic Image"})}),(0,o.jsxs)(s.Group,{wrap:"nowrap",justify:v?"center":"space-between",children:[(0,o.jsxs)(s.Group,{wrap:"nowrap",bg:"white",py:1,mb:1,align:"center",children:[null!=v?v:(0,o.jsx)("img",{width:u?50:100,height:u?50:100,style:{objectFit:"cover"},src:"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||window.location.hostname.includes("local")?null==i?void 0:i.offlineLogo:null==i?void 0:i.logo,alt:"Diagnotic Image"}),(0,o.jsx)(s.Group,{wrap:"nowrap",children:(0,o.jsxs)("div",{children:[(0,o.jsx)(l.Text,{styles:{root:{fontSize:"".concat(m?32:u?14:24)}},size:"xl",style:{fontSize:m?16:void 0},fw:700,children:null==i?void 0:i.name}),(0,o.jsxs)(l.Text,{fw:500,my:1,styles:{root:{wordBreak:"break-word",fontSize:m?12:void 0}},children:["Address: ",null==i?void 0:i.address,"true"===g&&(null==i?void 0:i.division)?";".concat(null==i?void 0:i.division):""]}),(0,o.jsxs)(s.Group,{children:[(0,o.jsxs)(l.Text,{my:1,fw:500,styles:{root:{wordBreak:"break-word",fontSize:m?12:void 0}},children:["Phone: ",null==i?void 0:i.phone1," , ",null==i?void 0:i.phone2]}),t?(0,o.jsxs)(l.Text,{my:1,fw:500,styles:{root:{wordBreak:"break-word",fontSize:m?16:void 0}},children:["; Email : ",t]}):(0,o.jsx)(o.Fragment,{})]})]})})]}),p&&(0,o.jsxs)(l.Text,{fw:700,mt:"auto",mb:9,style:{border:x?"2px solid #555":"none",padding:x?"4px":"0px",borderRadius:x?"2px":"0px"},styles:{root:{fontSize:"calc(var(--mantine-scale) * ".concat(m?16:u?12:14,")")}},children:["Lab\xa0ID:\xa0",p]}),c&&(0,o.jsxs)(l.Text,{fw:700,mt:"auto",mb:9,style:{border:x?"2px solid #555":"none",padding:x?"4px":"0px",borderRadius:x?"2px":"0px"},styles:{root:{fontSize:"calc(var(--mantine-scale) * ".concat(m?16:u?12:14,")")}},children:["Patient\xa0ID:\xa0",c]}),d]}),(0,o.jsx)(n.Divider,{size:"sm",color:a||"black",style:{marginBottom:"2px"}})]})}},79335:function(e,i,t){"use strict";t.r(i),t.d(i,{StatCard:function(){return eQ},default:function(){return eY}});var o=t(68328),s=t(25499),l=t(34473),n=t(41224),r=t(89043),d=t(22614),a=t(58812),c=t(68242),u=t(22041),m=t(11114),v=t(29663),h=t(77303),x=t(48604),p=t(8720),g=t(25564),f=t(35288),j=t(4013),y=t(4505),T=t(96579),C=t.n(T),b=t(76029),w=t(3741),D=t(31204),S=t(32451),B=t(10779),z=t(87967),_=t(77379),P=t(7140),I=t(9286),A=t(50430),k=t(58185),R=t(82e3),E=t(67781),N=t(13916),G=t(72940),M=t(6780),Z=t(67732);let L=async e=>{let{from:i,to:t,limit:o,page:s,isPaid:l,isCommissionPaid:n,isDoctorCommissionPaid:r,isPCCommissionPaid:d,doctorId:a}=e;try{let e="".concat("http://sasthotech.local:5000/api/v1","/bill/doctor?");i&&t&&(e+="from=".concat(i.toISOString(),"&to=").concat(t.toISOString())),o&&s&&(e+="&limit=".concat(o,"&page=").concat(s)),void 0!==l&&(e+="&isPaid=".concat(l)),void 0!==n&&(e+="&isCommissionPaid=".concat(n)),void 0!==r&&(e+="&isDoctorCommissionPaid=".concat(r)),void 0!==d&&(e+="&isPCCommissionPaid=".concat(d)),a&&(e+="&doctorId=".concat(a));let c=await M.default.get(e,G.FD);return{success:!0,data:c.data.data}}catch(e){if(e instanceof Z.d7){var c;return{success:!1,data:null===(c=e.response)||void 0===c?void 0:c.data.message}}return{success:!1,data:"An error occurred"}}};var O=t(81943),W=t(12450);let q=(e,i,t)=>{let[o,l]=(0,y.useState)(!1),n=(0,W.useSearchParams)(),r=(0,s.T)(),d=(0,s.C)(e=>!e.bills.allBills);return(0,y.useEffect)(()=>{(async()=>{l(!0);let t=n.get("from"),o=n.get("to"),s=new Date,d=new Date;d.setHours(0,0,0),s.setHours(23,59,59),(t&&o||e[0])&&(e[0]?((d=new Date(e[0])).setHours(0,0,0),e[1]?(s=new Date(e[1])).setHours(23,59,59):(s=new Date(e[0])).setHours(23,59,59)):t&&o&&(s=new Date(o),d=new Date(t))),await F({firstDate:d,finalDate:s,searchParams:n,selectedObject:i,dispatch:r})&&l(!1)})(),console.log("loaded")},[n,i,e,d]),o},F=async e=>{let{firstDate:i,finalDate:t,searchParams:o,selectedObject:s,dispatch:l}=e,n=o.get("doctorPaymentStatus"),r=o.get("doctorCommissionType"),d=o.get("pcCommissionFilter"),{success:a,data:c}=await L({from:i,to:new Date(t),limit:parseInt(o.get("limit"))||50,page:parseInt(o.get("page"))||1,..."perTest"===r?{isCommissionPaid:"paid"===n||"all"===n&&void 0}:{isDoctorCommissionPaid:"paid"===n||"all"===n&&void 0},isPCCommissionPaid:"paid"===d||"unpaid"!==d&&void 0,doctorId:null==s?void 0:s.id});return a&&l((0,O.Im)(c)),!0},U=async(e,i)=>{try{let t=await M.default.post("".concat("http://sasthotech.local:5000/api/v1","/commission/doctor/").concat(e),i,{...G.FD,...G.Hn});return{success:!0,data:t.data.data}}catch(e){if(e instanceof Z.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}};var H=t(25922),X=t(58576),V=t(41363),Q=t(74559),Y=t(77052);t(4646),t(14685),t(26250),t(12725),t(33089),t(3674);var K=t(78259),J=t(76607),$=t(88412),ee=t(90660),ei=t.n(ee),et=t(7203),eo=t(54632),es=t(72375),el=t(16391),en=t(75689),er=t(83170),ed=t(90396),ea=t(58291),ec=t(28704),eu=t(59406),em=t(24901),ev=t(7965),eh=t(29728),ex=t(58211),ep=t(60711),eg=t(13520),ef=t(53502),ej=t(32839),ey=t.n(ej),eT=e=>{var i,t,l,c,v,h,p;let{checkBoxRef:f}=e,[T,C]=(0,y.useState)([]),[D,B]=(0,y.useState)([]),z=(0,ef.v9)(e=>e.bills),_=(0,s.T)(),P=(0,W.useSearchParams)(),I=P.get("doctorPaymentStatus"),A=P.get("doctorCommissionType");(0,y.useEffect)(()=>{var e,i;let t=null==z?void 0:null===(i=z.allBills)||void 0===i?void 0:null===(e=i.items)||void 0===e?void 0:e.doctorPayableCategory;C(["Bill ID","Patient Name","Bill Date","Sub Total","Discount",...(null==t?void 0:t.map(e=>(null==e?void 0:e.name)||"Unknown"))||[]])},[null==z?void 0:null===(t=z.allBills)||void 0===t?void 0:null===(i=t.items)||void 0===i?void 0:i.doctorPayableCategory]),(0,y.useEffect)(()=>{var e;let{doctorPayableCategory:i,bills:t}=(null==z?void 0:null===(e=z.allBills)||void 0===e?void 0:e.items)||{},o=[];null==t||t.map(e=>{let t=[];null==i||i.forEach(i=>{var o;let s=null==e?void 0:null===(o=e.testCategories)||void 0===o?void 0:o.find(e=>(null==e?void 0:e.id)===(null==i?void 0:i.id));t.push({testCategoryId:(null==i?void 0:i.id)||"",price:(null==s?void 0:s.price)||0})});let s={id:(null==e?void 0:e.id)||"",billId:(null==e?void 0:e.billId)||"",name:(null==e?void 0:e.name)||"N/A",billDate:(null==e?void 0:e.createdAt)||new Date,subTotal:Math.floor((null==e?void 0:e.totalAmountWithDiscount)||0),discount:Math.floor(((null==e?void 0:e.totalAmout)||0)-((null==e?void 0:e.totalAmountWithDiscount)||0)),prices:t,isCommissionPaid:"perTest"===A?null==e?void 0:e.isCommissionPaid:null==e?void 0:e.isDoctorCommissionPaid,isPaid:(null==e?void 0:e.isPaid)||!1,isPCCommissionPaid:(null==e?void 0:e.isCommissionPaid)||!1};o.push(s)}),B(o)},[null==z?void 0:null===(l=z.allBills)||void 0===l?void 0:l.items,A]);let k=e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"N/A",R=(0,y.useMemo)(()=>{let e=0,i=0,t={};return D.forEach(o=>{var s;e+=o.subTotal||0,i+=o.discount||0,null===(s=o.prices)||void 0===s||s.forEach(e=>{t[e.testCategoryId]||(t[e.testCategoryId]=0),t[e.testCategoryId]+=e.price||0})}),{subTotal:e,discount:i,categoryTotals:t}},[D]),N=(null==z?void 0:null===(c=z.selectedBills)||void 0===c?void 0:c.length)||0,G=(null==D?void 0:D.length)||0;return(0,o.jsxs)(S.Box,{children:[N>0&&(0,o.jsx)(r.X,{className:ey().selectionBar,mb:"xs",children:(0,o.jsxs)(d.Group,{justify:"space-between",align:"center",children:[(0,o.jsxs)(d.Group,{gap:"md",children:[(0,o.jsx)(a.k,{size:"lg",radius:"md",variant:"light",color:"violet",children:(0,o.jsx)(er.Z,{size:20})}),(0,o.jsxs)("div",{children:[(0,o.jsxs)(u.Text,{size:"sm",fw:700,c:"violet.7",children:[N," of ",G," bills selected"]}),(0,o.jsx)(u.Text,{size:"xs",c:"dimmed",children:"Ready for commission processing"})]})]}),(0,o.jsxs)(m.C,{size:"lg",variant:"gradient",gradient:{from:"violet",to:"grape"},children:["Total: ৳"," ",null==z?void 0:null===(v=z.selectedBills)||void 0===v?void 0:v.reduce((e,i)=>e+(i.subTotal||0),0).toLocaleString()]})]})}),(0,o.jsx)(x.Z,{className:ey().tableCard,shadow:"sm",padding:0,radius:"md",children:(0,o.jsx)(eo.i.ScrollContainer,{minWidth:1500,children:(0,o.jsxs)(eo.i,{className:ey().doctorTable,styles:{th:{wordWrap:"normal",backgroundColor:"transparent",borderBottom:"2px solid #e9ecef",padding:"16px 12px"},td:{wordWrap:"normal",padding:"14px 12px",borderBottom:"1px solid #f1f3f5"}},striped:!1,withRowBorders:!1,verticalSpacing:"sm",highlightOnHover:!0,children:[(0,o.jsx)(eo.i.Thead,{children:(0,o.jsxs)(eo.i.Tr,{className:ey().headerRow,children:[(0,o.jsx)(eo.i.Th,{style:{width:50},children:(0,o.jsx)(b.u,{label:"Row number",children:(0,o.jsx)(a.k,{size:"sm",color:"gray",variant:"light",children:(0,o.jsx)(ed.Z,{size:14})})})}),(0,o.jsx)(eo.i.Th,{style:{width:60},children:(0,o.jsx)(es.X,{ref:f,"aria-label":"Select all bills",color:"violet",size:"md",onChange:e=>{let i=(null==D?void 0:D.filter(e=>(!(null==e?void 0:e.isCommissionPaid)||"paid"===I)&&(null==e?void 0:e.isPaid)))||[];e.currentTarget.checked?_((0,O.aE)(i)):_((0,O.aT)(D))}})}),null==T?void 0:T.map((e,i)=>(0,o.jsx)(eo.i.Th,{children:(0,o.jsxs)(d.Group,{gap:6,justify:"center",children:[0===i&&(0,o.jsx)(a.k,{size:"sm",color:"blue",variant:"light",children:(0,o.jsx)(g.Z,{size:14})}),1===i&&(0,o.jsx)(a.k,{size:"sm",color:"grape",variant:"light",children:(0,o.jsx)(ea.Z,{size:14})}),2===i&&(0,o.jsx)(a.k,{size:"sm",color:"cyan",variant:"light",children:(0,o.jsx)(E.Z,{size:14})}),3===i&&(0,o.jsx)(a.k,{size:"sm",color:"green",variant:"light",children:(0,o.jsx)(ec.Z,{size:14})}),4===i&&(0,o.jsx)(a.k,{size:"sm",color:"orange",variant:"light",children:(0,o.jsx)(j.Z,{size:14})}),(0,o.jsx)(u.Text,{size:"sm",fw:700,c:"dark.7",children:e})]})},"".concat(e,"-").concat(i))),(0,o.jsx)(eo.i.Th,{children:(0,o.jsx)(u.Text,{ta:"center",size:"sm",fw:700,c:"dark.7",children:"Actions"})})]})}),(0,o.jsxs)(eo.i.Tbody,{children:[D&&D.length>0?D.map((e,i)=>{var t,s,l,n;let r=null==z?void 0:null===(t=z.selectedBills)||void 0===t?void 0:t.find(i=>(null==i?void 0:i.billId)===(null==e?void 0:e.billId)),a=null==e?void 0:e.isCommissionPaid,c=null==e?void 0:e.isPaid;return(0,o.jsxs)(eo.i.Tr,{className:"".concat(ey().tableRow," ").concat(c?a?ey().paidRow:r?ey().selectedRow:"":ey().unpaidRow),children:[(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsx)(u.Text,{size:"xs",fw:600,c:"dimmed",className:ey().rowNumber,children:i+1})})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:a&&"paid"!==I?(0,o.jsx)(b.u,{label:"Commission already paid",children:(0,o.jsx)(m.C,{size:"lg",variant:"gradient",gradient:{from:"teal",to:"lime",deg:105},leftSection:(0,o.jsx)(eu.Z,{size:14}),children:"Paid"})}):c||"paid"===I?(0,o.jsx)(es.X,{"aria-label":"Select bill ".concat(null==e?void 0:e.billId),checked:!!r,color:"violet",size:"md",onChange:i=>{i.currentTarget.checked?_((0,O.aE)(e)):_((0,O.aT)(null==e?void 0:e.billId))}}):(0,o.jsx)(b.u,{label:"Bill payment pending",children:(0,o.jsx)(m.C,{size:"lg",variant:"gradient",gradient:{from:"orange",to:"red",deg:105},leftSection:(0,o.jsx)(em.Z,{size:14}),children:"Unpaid"})})})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsxs)(el.k,{justify:"center",align:"center",gap:"xs",children:[(0,o.jsx)(m.C,{size:"lg",variant:"light",color:"blue",className:ey().billIdBadge,children:(null==e?void 0:e.billId)||"N/A"}),(null==e?void 0:e.isPCCommissionPaid)&&(0,o.jsx)(b.u,{label:"PC commission paid",withArrow:!0,children:(0,o.jsx)(m.C,{size:"sm",color:"cyan",variant:"light",leftSection:(0,o.jsx)(ev.Z,{size:14}),children:"PC"})}),(0,o.jsx)(en.q,{value:(null==e?void 0:e.billId)||"",timeout:2e3,children:e=>{let{copied:i,copy:t}=e;return(0,o.jsx)(b.u,{label:i?"Copied!":"Copy Bill ID",withArrow:!0,position:"top",children:(0,o.jsx)(w.A,{color:i?"teal":"gray",variant:"subtle",onClick:t,size:"sm",className:ey().copyButton,children:(0,o.jsx)(eh.Z,{size:14})})})}})]})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsx)(u.Text,{size:"sm",fw:600,c:"dark.8",children:(null==e?void 0:e.name)||"N/A"})})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsxs)(d.Group,{gap:6,children:[(0,o.jsx)(E.Z,{size:16,color:"#868e96"}),(0,o.jsx)(u.Text,{size:"sm",fw:500,c:"dimmed",children:k(null==e?void 0:e.billDate)})]})})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsx)(m.C,{size:"lg",variant:"light",color:"green",leftSection:(0,o.jsx)(ex.Z,{size:14}),children:(null==e?void 0:null===(s=e.subTotal)||void 0===s?void 0:s.toLocaleString())||"0"})})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(null==e?void 0:e.discount)>0?(0,o.jsx)(m.C,{size:"lg",variant:"light",color:"orange",leftSection:(0,o.jsx)(ex.Z,{size:14}),children:(null==e?void 0:null===(l=e.discount)||void 0===l?void 0:l.toLocaleString())||"0"}):(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"-"})})}),null==e?void 0:null===(n=e.prices)||void 0===n?void 0:n.map((i,t)=>{var s;let l=(null==i?void 0:i.price)>0;return(0,o.jsx)(eo.i.Td,{className:l?ey().activePriceCell:"",children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:l?(0,o.jsxs)(m.C,{size:"md",variant:"dot",color:"indigo",className:ey().priceBadge,children:["৳ ",null==i?void 0:null===(s=i.price)||void 0===s?void 0:s.toFixed(2)]}):(0,o.jsx)(u.Text,{size:"xs",c:"gray.5",fw:500,children:"-"})})},"price-".concat(t,"-").concat(null==e?void 0:e.billId))}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsx)(b.u,{label:"View bill details",children:(0,o.jsx)(w.A,{component:eg.default,href:"/billing/details?billingId=".concat(null==e?void 0:e.billId,"&view=true"),variant:"light",color:"violet",size:"lg",radius:"md",className:ey().actionButton,children:(0,o.jsx)(ep.Z,{size:18})})})})})]},(null==e?void 0:e.billId)||Math.random())}):(0,o.jsx)(eo.i.Tr,{children:(0,o.jsx)(eo.i.Td,{colSpan:(null==T?void 0:T.length)+2||7,children:(0,o.jsxs)(n.Stack,{align:"center",gap:"md",py:60,children:[(0,o.jsx)(a.k,{size:80,radius:"xl",variant:"light",color:"gray",children:(0,o.jsx)(g.Z,{size:40})}),(0,o.jsxs)(n.Stack,{gap:4,align:"center",children:[(0,o.jsx)(u.Text,{size:"lg",fw:600,c:"dark.4",children:"No bills found"}),(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Try adjusting your filters or date range"})]})]})})}),D&&D.length>0&&(0,o.jsxs)(eo.i.Tr,{className:ey().summaryRow,children:[(0,o.jsx)(eo.i.Td,{colSpan:2,children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsx)(m.C,{size:"lg",variant:"gradient",gradient:{from:"indigo",to:"cyan"},leftSection:(0,o.jsx)(ec.Z,{size:16}),children:"TOTAL"})})}),(0,o.jsx)(eo.i.Td,{colSpan:3,children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsxs)(u.Text,{size:"sm",fw:700,c:"dimmed",children:[G," Bill",1!==G?"s":""]})})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsxs)(m.C,{size:"lg",variant:"light",color:"green",className:ey().totalBadge,children:["৳ ",R.subTotal.toLocaleString()]})})}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsxs)(m.C,{size:"lg",variant:"light",color:"orange",className:ey().totalBadge,children:["৳ ",R.discount.toLocaleString()]})})}),null===(p=D[0])||void 0===p?void 0:null===(h=p.prices)||void 0===h?void 0:h.map((e,i)=>{let t=R.categoryTotals[e.testCategoryId]||0;return(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:t>0?(0,o.jsxs)(m.C,{size:"md",variant:"filled",color:"indigo",className:ey().totalBadge,children:["৳ ",t.toFixed(2)]}):(0,o.jsx)(u.Text,{size:"xs",c:"gray.4",fw:500,children:"-"})})},"total-".concat(i))}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsx)(el.k,{justify:"center",align:"center",children:(0,o.jsx)(a.k,{size:"md",color:"gray",variant:"light",children:(0,o.jsx)(ec.Z,{size:16})})})})]})]})]})})})]})},eC=t(88531),eb=t(29593),ew=t(97698),eD=t(71256),eS=t(75326),eB=t.n(eS),ez=e=>{var i,t,l,r,a,c,v,x,p,g,f,j,T,C,b,w;let{doctorId:D,commissionOverrides:S}=e,{data:B,isLoading:z,refetch:_,isError:P}=(0,H.Fp)(D,{refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,skip:!D}),{data:I,isLoading:A}=(0,H.bX)(D,{refetchOnMountOrArgChange:!0,skip:!D}),k=(0,s.C)(e=>{var i;return null==e?void 0:null===(i=e.bills)||void 0===i?void 0:i.selectedBills}),R=(0,s.C)(e=>e.auth),[E,N]=(0,y.useState)(0);(0,y.useEffect)(()=>{D&&_()},[D,_]);let{selectedBills:G,totalAmountsByTestID:M,tests:Z,totals:L,totalDiscount:O,totalPatientIds:W,lastPaidCommissions:q,initialCommissions:F}=(0,y.useMemo)(()=>{var e,i,t,o,s,l,n,r,d;if(!B)return{};let a=new Set(null==k?void 0:k.map(e=>e.billId)),c=null==B?void 0:null===(i=B.data)||void 0===i?void 0:null===(e=i.bills)||void 0===e?void 0:e.filter(e=>a.has(e.billId)),u=new Map,m=new Map;for(let e of c)for(let i of null==e?void 0:e.tests)if(i.testId){u.set(i.testId,(u.get(i.testId)||0)+((null==R?void 0:null===(r=R.diagnostic)||void 0===r?void 0:r.isTestDiscountIncludeInBill)?i.price:"amount"===i.discountType?i.price-i.discount:i.price*(1-i.discount/100)));let t=[...null!==(d=m.get(i.testId))&&void 0!==d?d:[],e.patient.patientId.toString()];m.set(i.testId,t)}let v=null==B?void 0:null===(o=B.data)||void 0===o?void 0:null===(t=o.tests)||void 0===t?void 0:t.filter(e=>u.get(e.id)),h=null==v?void 0:v.map(e=>u.get(e.id)||0),x=S?new Map(S.map(e=>[e.testId,[e.commission,e.commissionType]])):void 0,p=(null==R?void 0:null===(s=R.diagnostic)||void 0===s?void 0:s.isDoctorCommissionEnabled)?void 0:new Map(null==B?void 0:null===(n=B.data)||void 0===n?void 0:null===(l=n.percentages)||void 0===l?void 0:l.map(e=>[e.testId,[e.discount,e.discountType]])),g=Math.floor(v.map(e=>{var i;let[t,o]=(null==x?void 0:x.get(e.id))||((null==R?void 0:null===(i=R.diagnostic)||void 0===i?void 0:i.isDoctorCommissionEnabled)?[e.doctorCommissionAmount,e.doctorCommissionType]:(null==p?void 0:p.get(e.id))||[]);return{commission:t||0,isPercentage:"amount"!==o}}).reduce((e,i,t)=>e+(i.isPercentage?i.commission*(((null==h?void 0:h[t])||0)/100):i.commission),0));N(g);let f=null==c?void 0:c.reduce((e,i)=>e+i.totalAmout-i.totalAmountWithDiscount,0);return{selectedBills:c,totalAmountsByTestID:u,tests:v,totalDiscount:f,totals:h,totalPatientIds:m,lastPaidCommissions:x||p,initialCommissions:g}},[R,B,k,S]);return z||A?(0,o.jsx)(et.Z,{}):P?(0,o.jsx)("div",{className:"p-3 text-center",children:"An error occurred"}):D?(0,o.jsxs)("div",{className:"p-4 hidden-print",children:[(0,o.jsx)(eD.Z,{diagnostic:R.diagnostic}),(0,o.jsx)(eb.Space,{h:10}),(0,o.jsxs)(d.Group,{align:"start",justify:"space-between",mb:"md",children:[(0,o.jsxs)(n.Stack,{gap:4,children:[(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Doctor Name:"}),(0,o.jsxs)(u.Text,{fw:700,size:"md",children:["Dr. ",null==I?void 0:null===(i=I.data)||void 0===i?void 0:i.name]}),(null==I?void 0:null===(t=I.data)||void 0===t?void 0:t.designation)&&(0,o.jsx)(m.C,{size:"sm",variant:"light",color:"blue",children:null==I?void 0:null===(l=I.data)||void 0===l?void 0:l.designation})]}),(null==I?void 0:null===(r=I.data)||void 0===r?void 0:r.mobile)&&(null==I?void 0:null===(c=I.data)||void 0===c?void 0:null===(a=c.mobile)||void 0===a?void 0:a.length)>1&&(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Phone:"}),(0,o.jsx)(u.Text,{size:"sm",fw:600,children:null==I?void 0:null===(v=I.data)||void 0===v?void 0:v.mobile})]}),(null==I?void 0:null===(x=I.data)||void 0===x?void 0:x.address)&&(null==I?void 0:null===(g=I.data)||void 0===g?void 0:null===(p=g.address)||void 0===p?void 0:p.length)>1&&(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Address:"}),(0,o.jsx)(u.Text,{size:"sm",children:null==I?void 0:null===(f=I.data)||void 0===f?void 0:f.address})]}),(null==I?void 0:null===(j=I.data)||void 0===j?void 0:j.email)&&(null==I?void 0:null===(C=I.data)||void 0===C?void 0:null===(T=C.email)||void 0===T?void 0:T.length)>1&&(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Email:"}),(0,o.jsx)(u.Text,{size:"sm",children:null==I?void 0:null===(b=I.data)||void 0===b?void 0:b.email})]})]}),(0,o.jsxs)(n.Stack,{gap:4,align:"flex-end",children:[(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Date:"}),(0,o.jsx)(m.C,{size:"lg",variant:"filled",color:"blue",children:(0,ew.Z)(new Date,"dd-MMM-yyyy")})]}),(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Total Bills:"}),(0,o.jsx)(m.C,{size:"md",variant:"light",color:"green",children:(null==G?void 0:G.length)||0})]})]})]}),(0,o.jsx)(h.Divider,{my:"md"}),(0,o.jsxs)(eo.i,{className:eB().table,highlightOnHover:!0,children:[(0,o.jsx)(eo.i.Thead,{children:(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{style:{textAlign:"center",width:"5%"},children:"#"}),(0,o.jsx)(eo.i.Th,{style:{textAlign:"center",width:"25%"},children:"Test Name"}),(0,o.jsx)(eo.i.Th,{style:{textAlign:"center",width:"25%"},children:"Patient IDs"}),(0,o.jsxs)(eo.i.Th,{style:{textAlign:"center",width:"10%"},children:["Commission",(0,o.jsx)("br",{}),"Rate"]}),(0,o.jsx)(eo.i.Th,{style:{textAlign:"center",width:"8%"},children:"Qty"}),(0,o.jsxs)(eo.i.Th,{style:{textAlign:"center",width:"12%"},children:["Actual",(0,o.jsx)("br",{}),"Price"]}),(0,o.jsxs)(eo.i.Th,{style:{textAlign:"center",width:"15%"},children:["Total",(0,o.jsx)("br",{}),"Commission"]})]})}),(0,o.jsxs)(eo.i.Tbody,{children:[null==Z?void 0:Z.map((e,i)=>{var t,s,l,n,r,d,a,c,v,h;return(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Td,{style:{textAlign:"center"},children:(0,o.jsx)(u.Text,{size:"sm",fw:600,c:"dimmed",children:i+1})}),(0,o.jsx)(eo.i.Td,{style:{textAlign:"left",paddingLeft:"1rem"},children:(0,o.jsx)(u.Text,{size:"sm",fw:600,children:e.name})}),(0,o.jsx)(eo.i.Td,{style:{textAlign:"center"},children:(0,o.jsx)(u.Text,{size:"xs",c:"blue",children:null==W?void 0:null===(t=W.get(e.id))||void 0===t?void 0:t.map((i,t)=>{var s;return(0,o.jsxs)("span",{children:[i,t<((null==W?void 0:null===(s=W.get(e.id))||void 0===s?void 0:s.length)||0)-1?", ":""]},i)})})}),(0,o.jsx)(eo.i.Td,{style:{textAlign:"center"},children:(0,o.jsxs)(m.C,{size:"sm",variant:"light",color:(null==q?void 0:null===(s=q.get(e.id))||void 0===s?void 0:s[1])==="amount"?"orange":"blue",children:[null==q?void 0:null===(l=q.get(e.id))||void 0===l?void 0:l[0],(null==q?void 0:null===(n=q.get(e.id))||void 0===n?void 0:n[1])==="amount"?" ৳":"%"]})}),(0,o.jsx)(eo.i.Td,{style:{textAlign:"center"},children:(0,o.jsx)(u.Text,{size:"sm",fw:600,children:null==W?void 0:null===(r=W.get(e.id))||void 0===r?void 0:r.length})}),(0,o.jsx)(eo.i.Td,{style:{textAlign:"right",paddingRight:"1rem"},children:(0,o.jsxs)(u.Text,{size:"sm",fw:600,c:"green",children:["৳ ",null===(d=M.get(e.id))||void 0===d?void 0:d.toLocaleString()]})}),(0,o.jsx)(eo.i.Td,{style:{textAlign:"right",paddingRight:"1rem"},children:(0,o.jsxs)(u.Text,{size:"sm",fw:700,c:"blue",children:["৳"," ",(null==q?void 0:null===(a=q.get(e.id))||void 0===a?void 0:a[1])==="amount"?null==q?void 0:null===(v=q.get(e.id))||void 0===v?void 0:null===(c=v[0])||void 0===c?void 0:c.toLocaleString():Math.floor((M.get(e.id)||0)*(((null==q?void 0:null===(h=q.get(e.id))||void 0===h?void 0:h[0])||0)/100)).toLocaleString()]})})]},e.id)}),(0,o.jsxs)(eo.i.Tr,{style:{backgroundColor:"#f8f9fa"},children:[(0,o.jsx)(eo.i.Td,{colSpan:5}),(0,o.jsx)(eo.i.Th,{style:{textAlign:"right",paddingRight:"1rem"},children:(0,o.jsx)(u.Text,{size:"sm",fw:700,children:"Total Commission:"})}),(0,o.jsx)(eo.i.Th,{style:{textAlign:"right",paddingRight:"1rem"},children:(0,o.jsxs)(u.Text,{size:"md",fw:700,c:"blue",children:["৳ ",(F||0).toLocaleString()]})})]}),(0,o.jsxs)(eo.i.Tr,{style:{backgroundColor:"#e7f5ff",borderTop:"2px solid #228be6"},children:[(0,o.jsx)(eo.i.Td,{colSpan:5}),(0,o.jsx)(eo.i.Th,{style:{textAlign:"right",paddingRight:"1rem"},children:(0,o.jsx)(u.Text,{size:"md",fw:700,c:"blue",children:"Paid Commission:"})}),(0,o.jsx)(eo.i.Th,{style:{textAlign:"right",paddingRight:"1rem"},children:(0,o.jsxs)(u.Text,{size:"lg",fw:700,c:"blue",children:["৳ ",(F||0).toLocaleString()]})})]})]})]}),(0,o.jsx)(eb.Space,{h:20}),(0,o.jsxs)(n.Stack,{gap:"xs",children:[(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"sm",fw:600,children:"In Words:"}),(0,o.jsxs)(u.Text,{size:"sm",tt:"capitalize",fw:700,c:"blue",children:[(0,eC.V)((F||0)-(O||0))," Taka Only"]})]}),(0,o.jsx)(h.Divider,{my:"sm"}),(0,o.jsxs)(d.Group,{gap:"xl",children:[(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"xs",c:"dimmed",children:"Printed By:"}),(0,o.jsx)(u.Text,{size:"xs",tt:"capitalize",fw:600,children:null==R?void 0:null===(w=R.user)||void 0===w?void 0:w.name})]}),(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(u.Text,{size:"xs",c:"dimmed",children:"Printed At:"}),(0,o.jsx)(u.Text,{size:"xs",fw:600,children:(0,ew.Z)(new Date,"dd-MMM-yyyy hh:mm a")})]})]})]}),(0,o.jsxs)(u.Text,{size:"xs",c:"dimmed",style:{position:"absolute",bottom:20,left:0,right:0,textAlign:"center"},children:["Powered By"," ",(0,o.jsx)(u.Text,{component:"span",fw:700,c:"blue",children:"sasthotech.com"})]})]}):null},e_=t(72752),eP=e=>{var i,t,l,n,r,a,c,m,v,h;let x;let{doctorName:p}=e,g=(0,W.useSearchParams)(),f=(0,s.C)(e=>e.auth.diagnostic),j=(0,s.C)(e=>e.pcCommissions.commissions),T=(0,s.C)(e=>e.bills);(0,s.C)(e=>e.bills.selectedBills);let C=(0,y.useMemo)(()=>"",[]),{data:b}=(0,H.bX)(C,{skip:!C}),[w,D]=(0,y.useState)([]),[S,B]=(0,y.useState)([]),[z,_]=(0,y.useState)(null);(0,y.useEffect)(()=>{var e,i,t;D(["Bill Id","Name",...(null==T?void 0:null===(t=T.allBills)||void 0===t?void 0:null===(i=t.items)||void 0===i?void 0:null===(e=i.doctorPayableCategory)||void 0===e?void 0:e.map(e=>e.name))||[]])},[null==T?void 0:null===(t=T.allBills)||void 0===t?void 0:null===(i=t.items)||void 0===i?void 0:i.doctorPayableCategory]),(0,y.useEffect)(()=>{var e;let{doctorPayableCategory:i,bills:t}=(null==T?void 0:null===(e=T.allBills)||void 0===e?void 0:e.items)||{},o=[];null==t||t.map(e=>{let t=[];null==i||i.forEach(i=>{var o;let s=null==e?void 0:null===(o=e.testCategories)||void 0===o?void 0:o.find(e=>e.id===i.id);s?t.push({testCategoryId:i.id,price:s.price}):t.push({testCategoryId:i.id,price:0})});let s={id:e.id,billId:e.billId,name:e.name,time:e.createdAt,subTotal:Math.floor(e.totalAmountWithDiscount),discount:Math.floor(e.totalAmout-e.totalAmountWithDiscount),prices:t,isDoctorCommissionPaid:e.isDoctorCommissionPaid};o.push(s)}),B(o)},[null==T?void 0:null===(l=T.allBills)||void 0===l?void 0:l.items]),(0,y.useEffect)(()=>{var e;let i={};null==T||null===(e=T.selectedBills)||void 0===e||e.forEach(e=>{var t;null==e||null===(t=e.prices)||void 0===t||t.forEach(e=>{let t=e.testCategoryId;i[t]=(i[t]||0)+e.price})}),_(i)},[null==T?void 0:T.selectedBills]);let P=()=>{var e,i;let t=0;return"paid"===g.get("doctorPaymentStatus")?null==b||null===(i=b.data)||void 0===i||null===(e=i.doctorTestCategoryPercentages)||void 0===e||e.forEach(e=>{e&&(t+=I((null==z?void 0:z[e.testCategoryId])||0,(null==e?void 0:e.discount)||0,"percentage"===e.discountType))}):null==j||j.forEach(e=>{t+="percentage"===e.discountType?e.price*e.discount/100:0!==e.price?e.discount:0}),Math.floor(t)},I=(e,i,t)=>t?Math.floor(i*e/100):Math.floor(i);return(0,o.jsxs)("div",{className:"print-total-bill px-3 ",children:[(0,o.jsxs)("style",{type:"text/css",media:"print",children:["@page { size: A5 portrait; }","* { font-weight: 700 !important; }"]}),(0,o.jsx)(eD.Z,{small:!0,diagnostic:f}),(0,o.jsx)(e_.Z,{small:!0}),(0,o.jsxs)(d.Group,{children:[(0,o.jsx)(u.Text,{children:"Doctor Name: "}),(0,o.jsx)(u.Text,{children:p})]}),(0,o.jsxs)("div",{className:"bg-white rounded-4",children:[(0,o.jsxs)(eo.i,{borderColor:"#000000",className:eB().table,verticalSpacing:0,layout:"fixed",children:[(0,o.jsx)(eo.i.Thead,{children:(0,o.jsxs)(eo.i.Tr,{className:eB().table,children:[null==w?void 0:w.map(e=>(0,o.jsx)(eo.i.Th,{className:"text-center",children:(0,o.jsx)(u.Text,{styles:{root:{fontSize:"Bill Id"===e?"10px":"auto",wordBreak:"break-word"}},ta:"center",size:"xs",fw:700,children:e})},e)),(0,o.jsx)(eo.i.Th,{className:"text-center",children:(0,o.jsx)(u.Text,{style:{wordBreak:"break-word"},ta:"center",size:"xs",fw:700,children:"Discount"})})]})}),(0,o.jsxs)(eo.i.Tbody,{children:[null==S?void 0:S.map(e=>{if(T.selectedBills.find(i=>i.billId===e.billId))return(0,o.jsxs)(eo.i.Tr,{className:eB().table,bg:e.isDoctorCommissionPaid?"var(--mantine-color-green-light)":T.selectedBills.find(i=>i.billId===e.billId)?"var(--mantine-color-blue-light)":void 0,children:[(0,o.jsx)(eo.i.Td,{className:"text-center",children:(0,o.jsx)(u.Text,{style:{fontSize:10,wordBreak:"break-word"},size:"xs",children:e.billId})}),(0,o.jsx)(eo.i.Td,{style:{wordBreak:"break-word"},className:"text-center",children:(0,o.jsx)(u.Text,{style:{wordBreak:"break-word"},size:"xs",children:e.name})}),e.prices.map((e,i)=>(0,o.jsx)(eo.i.Td,{style:{wordBreak:"break-word"},className:"text-center",children:(0,o.jsxs)(u.Text,{ta:"center",size:"sm",children:[" ",Math.floor((null==e?void 0:e.price)||0)]})},i)),(0,o.jsx)(eo.i.Td,{className:"text-center",children:(0,o.jsx)(u.Text,{size:"sm",children:e.discount})})]},e.billId)}),(0,o.jsxs)(eo.i.Tr,{className:eB().table,styles:{tr:{borderTop:"1px solid black"}},children:[(0,o.jsxs)(eo.i.Td,{children:["  "," "]}),(0,o.jsxs)(eo.i.Td,{children:[" ",(0,o.jsx)(u.Text,{ta:"center",size:"xs",children:"Total"})," "]}),null==T?void 0:null===(a=T.allBills)||void 0===a?void 0:null===(r=a.items)||void 0===r?void 0:null===(n=r.doctorPayableCategory)||void 0===n?void 0:n.map(e=>(0,o.jsxs)(eo.i.Td,{children:[(0,o.jsx)(u.Text,{style:{wordBreak:"break-word"},ta:"center",size:"sm",children:Math.floor((null==z?void 0:z[e.id])||0)||0})," "]},null==e?void 0:e.id)),(0,o.jsxs)(eo.i.Td,{children:[(0,o.jsx)(u.Text,{style:{wordBreak:"break-word"},ta:"center",size:"sm",children:(x=0,null==T||null===(h=T.selectedBills)||void 0===h||h.forEach(e=>{x+=e.discount}),(null==f?void 0:f.includeDiscountInPcCommission)?Math.floor(x):0)})," "]})]}),(0,o.jsxs)(eo.i.Tr,{className:eB().table,children:[(0,o.jsxs)(eo.i.Td,{children:["  "," "]}),(0,o.jsxs)(eo.i.Td,{children:[" ",(0,o.jsx)(u.Text,{ta:"center",style:{fontSize:10,wordBreak:"break-word"},children:"Comm."})," "]}),null==T?void 0:null===(v=T.allBills)||void 0===v?void 0:null===(m=v.items)||void 0===m?void 0:null===(c=m.doctorPayableCategory)||void 0===c?void 0:c.map(e=>{var i,t;let s;if(s="paid"===g.get("doctorPaymentStatus")?null==b?void 0:null===(t=b.data)||void 0===t?void 0:null===(i=t.doctorTestCategoryPercentages)||void 0===i?void 0:i.find(i=>i.testCategoryId===e.id):null==j?void 0:j.find(i=>i.testCategoryId===e.id))return(0,o.jsxs)(eo.i.Td,{children:[(0,o.jsx)(u.Text,{style:{wordBreak:"break-word"},size:"sm",ta:"center",children:(null==s?void 0:s.discountType)==="percentage"?Math.floor(((null==s?void 0:s.discount)||0)*((null==z?void 0:z[e.id])||0)/100):(null==s?void 0:s.discount)!==0&&(null==z?void 0:z[e.id])!==0?Math.floor((null==s?void 0:s.discount)||0):0})," "]},null==s?void 0:s.testCategoryId)}),(0,o.jsx)(eo.i.Td,{children:(0,o.jsxs)(u.Text,{ta:"center",size:"xs",children:["  ","--"]})})]})]})]}),(0,o.jsx)(eo.i,{mt:"md",ml:"auto",w:"auto",withRowBorders:!1,verticalSpacing:0,children:(0,o.jsxs)(eo.i.Tbody,{children:[(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{children:"Payable"}),(0,o.jsx)(eo.i.Td,{style:{wordBreak:"break-word"},children:P()})]}),(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{children:"Less"}),(0,o.jsx)(eo.i.Td,{style:{wordBreak:"break-word"},children:"0"})]}),(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{children:"Paid"}),(0,o.jsx)(eo.i.Td,{style:{wordBreak:"break-word"},children:P()})]})]})})]})]})},eI=t(64159),eA=t(28301),ek=e=>{var i,t,l;let{setSelectedObject:r,setKeyCount:c,keyCount:v,selectedObject:h,setDoctorCommissionVisible:p,printButtonRef:g,isSubmitting:f,setIsSubmitting:j,dates:T,setDates:G,doctorCommissionType:M,setDoctorCommissionType:Z}=e,L=(0,W.useSearchParams)(),ee=(0,W.useRouter)(),eo=(0,s.T)(),es=(0,s.C)(e=>{var i;return null==e?void 0:null===(i=e.bills)||void 0===i?void 0:i.allBills}),el=(0,s.C)(e=>{var i;return null==e?void 0:null===(i=e.bills)||void 0===i?void 0:i.selectedBills}),en=(0,s.C)(e=>e.pcCommissions.commissions),er=(0,s.C)(e=>e.auth),ed=null==er?void 0:er.diagnostic,ea=null==er?void 0:null===(i=er.user)||void 0===i?void 0:i.role,ec=(0,s.C)(eA.F0);(0,eI.J)();let{data:eu,refetch:em}=(0,H.bX)((null==h?void 0:h.id)||"",{skip:!(null==h?void 0:h.id)}),[ev,eh]=(0,y.useState)(L.get("doctorPaymentStatus")||"unpaid"),[ex,ep]=(0,y.useState)(L.get("pcCommissionFilter")),[eg,ef]=(0,y.useState)((null==ed?void 0:ed.doctorCommissionBasis)||"CATEGORY_WISE"),[ej,ey]=(0,y.useState)(!1),eC=q(T,h),eb=(0,y.useRef)(null),ew=(0,y.useRef)(null),eD=(0,$.useReactToPrint)({content:()=>eb.current,documentTitle:"Doctor Commission Lists",onAfterPrint(){eo((0,X.RB)([])),eo((0,O.aT)([])),eo((0,X.RB)([])),eS()}}),eS=async()=>{var e,i,t;await F({firstDate:null!==(e=T[0])&&void 0!==e?e:(0,K.Z)(new Date),finalDate:null!==(t=T[1])&&void 0!==t?t:(0,J.Z)(null!==(i=T[0])&&void 0!==i?i:new Date),dispatch:eo,selectedObject:h,searchParams:L})&&(j(!1),c(v+1))},eB=async e=>{ey(!0);let i=new FormData;i.append("doctorCommissionBasis",e);let{success:t,data:o}=await (0,V.$)(i);t?(ef(e),ed&&eo((0,Q.Im)({...ed,doctorCommissionBasis:e})),ei().fire({title:"Success",text:"Commission basis updated successfully",icon:"success",timer:2e3,showConfirmButton:!1})):ei().fire("Error",o||"Failed to update commission basis","error"),ey(!1)},e_=async e=>{j(!0);let i=null==el?void 0:el.map(e=>({id:e.id})),t=null==en?void 0:en.map(e=>({testCategoryId:e.testCategoryId,commission:null==e?void 0:e.discount,commissionType:(null==e?void 0:e.discountType)||"percentage"}));if(null==h?void 0:h.id){let{success:n,data:r}=await U(null==h?void 0:h.id,{bills:i,isPaid:e,commissions:t});if(n){if((await ei().fire({confirmButtonText:"Print",showCancelButton:!0,title:"Success",html:"Doctor Commission Saved.</br> Do you want to print?",icon:"success"})).isConfirmed)eD();else{var o,s,l;await F({firstDate:null!==(o=T[0])&&void 0!==o?o:(0,K.Z)(new Date),finalDate:null!==(l=T[1])&&void 0!==l?l:(0,J.Z)(null!==(s=T[0])&&void 0!==s?s:new Date),dispatch:eo,selectedObject:h,searchParams:L}),eo((0,O.aT)([])),eo((0,X.RB)([])),em()}}else ei().fire("Error",r||"Invalid Server Response","error");j(!1)}else ei().fire("Error","Select a doctor from dropdown","error"),j(!1)};return((0,y.useEffect)(()=>{let e=new URLSearchParams(window.location.search);e.set("doctorPaymentStatus",ev),e.set("doctorCommissionType",M);let i="".concat(window.location.pathname,"?").concat(e.toString());ee.push(i),eo((0,X.RB)([])),eo((0,O.aT)([]))},[ev,M,eo,ee]),(0,y.useEffect)(()=>{h?p(!0):p(!1)},[h,p]),(0,y.useEffect)(()=>{(null==ed?void 0:ed.doctorCommissionBasis)&&ef(ed.doctorCommissionBasis)},[null==ed?void 0:ed.doctorCommissionBasis]),eC)?(0,o.jsx)(et.Z,{}):(0,o.jsxs)(n.Stack,{gap:"lg",children:[(0,o.jsx)(x.Z,{shadow:"sm",padding:"lg",radius:"md",className:C().filterSection,children:(0,o.jsxs)(n.Stack,{gap:"md",children:[(0,o.jsxs)(d.Group,{justify:"space-between",align:"center",children:[(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(a.k,{size:"md",radius:"md",variant:"light",color:"blue",children:(0,o.jsx)(I.Z,{size:18})}),(0,o.jsx)(u.Text,{size:"md",fw:600,children:"Filters & Selection"})]}),(0,o.jsx)(b.u,{label:"Refresh data",children:(0,o.jsx)(w.A,{variant:"subtle",color:"gray",onClick:()=>eS(),children:(0,o.jsx)(A.Z,{size:18})})})]}),(0,o.jsxs)(D.Button,{ref:g,onClick:()=>e_(!0),size:"md",radius:"md",className:"d-none",children:[(0,o.jsx)(k.Z,{})," Print"]}),(0,o.jsxs)(d.Group,{grow:!0,wrap:"wrap",children:[(0,o.jsx)(S.Box,{className:C().filterItem,children:(0,o.jsx)(B.z,{inline:!0,label:h?"Selected":"",size:16,color:"green",disabled:!h,children:(0,o.jsx)(z.P,{placeholder:"\uD83E\uDE7A Select Doctor",data:(null==ec?void 0:ec.map(e=>({value:e.id,label:"Dr. ".concat(e.name," - ").concat(e.designation)})))||[],value:(null==h?void 0:h.id)||null,onChange:e=>{r((null==ec?void 0:ec.find(i=>i.id===e))||null)},searchable:!0,clearable:!0,size:"md",leftSection:(0,o.jsx)(R.Z,{size:18}),styles:{input:{fontWeight:500}}})})}),(0,o.jsx)(S.Box,{className:C().filterItem,children:(0,o.jsx)(Y.DatePickerInput,{type:"range",placeholder:"\uD83D\uDCC5 Select date range",value:T,onChange:G,clearable:!0,size:"md",leftSection:(0,o.jsx)(E.Z,{size:18}),styles:{input:{fontWeight:500}}})})]}),(0,o.jsxs)(d.Group,{grow:!0,children:["admin"===ea&&(0,o.jsxs)(S.Box,{children:[(0,o.jsxs)(d.Group,{gap:"xs",mb:8,children:[(0,o.jsx)(u.Text,{size:"sm",fw:500,c:"dimmed",children:"Doctor Commission Basis"}),(0,o.jsx)(b.u,{label:"This setting applies globally to all doctor commissions",children:(0,o.jsx)(w.A,{size:"xs",variant:"transparent",children:(0,o.jsx)(N.Z,{size:14})})}),ej&&(0,o.jsx)(m.C,{size:"sm",variant:"dot",color:"blue",children:"Updating..."})]}),(0,o.jsx)(_.s,{value:eg,onChange:e=>eB(e),disabled:ej,fullWidth:!0,size:"md",data:[{label:"Test-wise",value:"TEST_WISE"},{label:"Category-wise",value:"CATEGORY_WISE"}],styles:{root:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:4},label:{color:"black"}}})]}),(0,o.jsxs)(S.Box,{children:[(0,o.jsx)(u.Text,{size:"sm",fw:500,mb:8,c:"dimmed",children:"Doctor Payment Status"}),(0,o.jsx)(_.s,{value:ev,onChange:e=>eh(e),fullWidth:!0,size:"md",data:[{label:"\uD83D\uDCCB Unpaid",value:"unpaid"},{label:"✅ Paid",value:"paid"},{label:"\uD83D\uDCCA All",value:"all"}],styles:{root:{background:"#f1f3f5"}}})]})]}),(0,o.jsx)(d.Group,{grow:!0,children:(0,o.jsxs)(S.Box,{children:[(0,o.jsx)(u.Text,{size:"sm",fw:500,mb:8,c:"dimmed",children:"PC Commission Status"}),(0,o.jsx)(_.s,{value:null!=ex?ex:"all",onChange:e=>{let i=new URLSearchParams(L);i.set("pcCommissionFilter",null!=e?e:"all"),ee.push("?"+i.toString()),eo((0,O.aT)([])),ep(null!=e?e:"all")},fullWidth:!0,size:"md",data:[{label:"\uD83D\uDCCA All",value:"all"},{label:"✅ PC Paid",value:"paid"},{label:"\uD83D\uDCCB PC Unpaid",value:"unpaid"}],styles:{root:{background:"#f1f3f5"}}})]})}),el&&el.length>0&&(0,o.jsxs)(d.Group,{justify:"space-between",p:"md",style:{background:"#e7f5ff",borderRadius:8},children:[(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsxs)(m.C,{size:"lg",variant:"filled",color:"blue",children:[el.length," Bills Selected"]}),(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Ready for commission processing"})]}),(0,o.jsx)(D.Button,{variant:"light",size:"xs",onClick:()=>eo((0,O.aT)([])),children:"Clear Selection"})]})]})}),(0,o.jsx)(S.Box,{className:C().billsTable,children:h?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eT,{checkBoxRef:ew}),(null==es?void 0:null===(t=es.items)||void 0===t?void 0:t.bills)&&es.items.bills.length>0&&(0,o.jsx)(x.Z,{padding:"lg",mt:"md",children:(0,o.jsxs)(n.Stack,{gap:"md",children:[(0,o.jsxs)(d.Group,{justify:"space-between",wrap:"wrap",children:[(0,o.jsx)(z.P,{label:"Items per page",data:["10","25","50","75","100"],value:L.get("limit")||"50",onChange:e=>{let i=new URLSearchParams(L);i.set("limit",e||"50"),i.set("page","1"),ee.push("?"+i.toString())},w:{base:"100%",sm:150}}),(0,o.jsx)(P.t,{value:parseInt(L.get("page")||"1"),onChange:e=>{let i=new URLSearchParams(L);i.set("page",e.toString()),ee.push("?"+i.toString())},total:(null==es?void 0:es.totalPage)||1,size:"md",withEdges:!0})]}),(0,o.jsx)(d.Group,{justify:"center",children:"paid"===ev?(0,o.jsx)(D.Button,{onClick:()=>{(null==h?void 0:h.id)?eD():ei().fire("Error","Select a doctor from dropdown","error")},size:"md",leftSection:(0,o.jsx)(k.Z,{size:18}),variant:"filled",color:"blue",children:"Print Commission Report"}):(0,o.jsx)(D.Button,{onClick:()=>{(null==h?void 0:h.id)?p(!0):ei().fire("Error","Select a doctor from dropdown","error")},size:"md",variant:"gradient",gradient:{from:"indigo",to:"cyan"},tt:"uppercase",children:"Pay Doctor Commission"})})]})}),(null==es?void 0:null===(l=es.items)||void 0===l?void 0:l.bills)&&0===es.items.bills.length&&(0,o.jsx)(x.Z,{padding:"xl",mt:"md",children:(0,o.jsx)(u.Text,{ta:"center",c:"dimmed",size:"lg",children:"No bills found for the selected criteria"})})]}):(0,o.jsxs)(x.Z,{padding:"xl",className:C().emptyState,children:[(0,o.jsx)("div",{className:C().emptyStateIcon,children:"\uD83E\uDE7A"}),(0,o.jsx)(u.Text,{size:"xl",fw:600,mb:"xs",children:"Select a Doctor to Continue"}),(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Choose a doctor from the dropdown above to view and manage their commission bills"})]})}),(0,o.jsx)("div",{ref:eb,children:(null==ed?void 0:ed.doctorCommissionBasis)==="TEST_WISE"?(0,o.jsx)(ez,{doctorId:(null==h?void 0:h.id)||""}):(0,o.jsx)(eP,{doctorName:null==h?void 0:h.name,paidAmount:0,info:[]})})]})},eR=t(29259),eE=t(81209),eN=t(76283),eG=t(59636),eM=t(32740),eZ=t(83458),eL=e=>{var i,t,l,r,a,c,m,v,h,x,p,g,f,j,T,b,w,B;let{selectedObject:z,isSubmitting:_,setIsSubmitting:P,printButtonRef:I,payCommissionBtnRef:A,setKeyCount:k,keyCount:R,dates:E}=e,N=(0,W.useSearchParams)(),G=N.get("doctorPaymentStatus"),M=(0,ef.v9)(e=>e.bills);(0,s.C)(e=>e.auth.diagnostic);let Z=(0,ef.v9)(e=>e.auth),L=(0,s.C)(e=>e.pcCommissions.commissions),[q,V]=(0,y.useState)([]),Q=(0,s.T)(),{data:Y,refetch:$}=(0,H.bX)(z.id);(0,y.useEffect)(()=>{var e;let i={};null==M||null===(e=M.selectedBills)||void 0===e||e.map(e=>{var t;null==e||null===(t=e.prices)||void 0===t||t.forEach(e=>{i[null==e?void 0:e.testCategoryId]||(i[null==e?void 0:e.testCategoryId]=0),i[null==e?void 0:e.testCategoryId]+=null==e?void 0:e.price})});let t=Object.entries(i).map(e=>{var i,t,o,s,l;let[n,r]=e,d=q.find(e=>e.testCategoryId===n),a=null==Y?void 0:null===(t=Y.data)||void 0===t?void 0:null===(i=t.doctorTestCategoryPercentages)||void 0===i?void 0:i.find(e=>e.testCategoryId===n),c=null==M?void 0:null===(l=M.allBills)||void 0===l?void 0:null===(s=l.items)||void 0===s?void 0:null===(o=s.doctorPayableCategory)||void 0===o?void 0:o.find(e=>e.id===n);return{testCategoryId:n,price:r,discount:(null==d?void 0:d.discount)||(null==a?void 0:a.discount)||(null==c?void 0:c.doctorCommissionAmount)||0,discountType:(null==d?void 0:d.discountType)||(null==a?void 0:a.discountType)||(null==c?void 0:c.doctorCommissionType)||"percentage"}});Q((0,X.RB)(t)),V(t)},[Y,null==M?void 0:M.selectedBills]);let ee=()=>{let e=0;return null==q||q.forEach(i=>{e+="percentage"===i.discountType?i.price*i.discount/100:0!==i.price?i.discount:0}),Math.floor(e)},es=async e=>{if(e)I.current&&I.current.click();else{var i,t,o,s;P(!0);let l=null==M?void 0:null===(i=M.selectedBills)||void 0===i?void 0:i.map(e=>({id:e.id})),n=q.map(e=>({testCategoryId:e.testCategoryId,commission:null==e?void 0:e.discount,commissionType:(null==e?void 0:e.discountType)||"percentage"}));if(null==z?void 0:z.id){let{success:i,data:r}=await U(null==z?void 0:z.id,{bills:l,isPaid:e,commissions:n});i?(await F({firstDate:null!==(t=E[0])&&void 0!==t?t:(0,K.Z)(new Date),finalDate:null!==(s=E[1])&&void 0!==s?s:(0,J.Z)(null!==(o=E[0])&&void 0!==o?o:new Date),dispatch:Q,selectedObject:z,searchParams:N}),ei().fire("Success","Doctor Commission Updated","success"),Q((0,O.aT)([])),V([]),$()):ei().fire("Error",r||"Invalid Server Response","error")}else ei().fire("Error","Select a doctor from dropdown","error");P(!1),k(R+1)}},el=(e,i,t)=>t?Math.floor(i*e/100):i<e?Math.floor(i):0,en=e=>el((null==e?void 0:e.price)||0,(null==e?void 0:e.discount)||0,(null==e?void 0:e.discountType)==="percentage");return"paid"===G?null:(console.log(z,"doctor",Y),!z.id||(null==Y?void 0:Y.data))?(0,o.jsxs)(S.Box,{className:C().bottom,onWheel:function(e){0==e.deltaX&&(e.preventDefault(),e.currentTarget.scrollBy({left:e.deltaY>0?50:-50}))},children:[(0,o.jsxs)(n.Stack,{className:"".concat(C().upper," rounded-3 p-2"),bg:"#c3d5ed",children:[(0,o.jsx)(eo.i,{fz:"md",withRowBorders:!1,children:(0,o.jsxs)(eo.i.Tbody,{children:[(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{children:"Payable"}),(0,o.jsxs)(eo.i.Td,{ta:"right",children:["৳ ",ee().toLocaleString()]})]}),(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{children:"Discount"}),(0,o.jsx)(eo.i.Td,{ta:"right",children:"৳ 0"})]}),(0,o.jsxs)(eo.i.Tr,{style:{borderTop:"1px solid #0000003F"},children:[(0,o.jsx)(eo.i.Th,{children:"Total Commission"}),(0,o.jsxs)(eo.i.Td,{ta:"right",children:["৳ ",(ee()-0).toLocaleString()]})]})]})}),(0,o.jsxs)(d.Group,{justify:"space-between",mt:"auto",children:[(0,o.jsx)(D.Button,{onClick:()=>es(!1),radius:"sm",bg:"#FB9C48",disabled:_||0>=ee(),leftSection:(0,o.jsx)(eN.Z,{size:18}),children:"Save to Expense"}),((null==Z?void 0:null===(i=Z.user)||void 0===i?void 0:i.role)==="admin"||(null==Z?void 0:null===(t=Z.diagnostic)||void 0===t?void 0:t.isDoctorPayPermission)&&(null==Z?void 0:null===(l=Z.user)||void 0===l?void 0:l.role)==="receptionist")&&(0,o.jsx)(D.Button,{ref:A,onClick:()=>I.current&&I.current.click(),radius:"sm",bg:"#1A72E9",disabled:_||0>=ee(),leftSection:(0,o.jsx)(eG.Z,{size:18}),children:"Pay Commission"})]})]}),(0,o.jsx)(eo.i,{fz:"md",w:"auto",className:"text-wrap",children:(0,o.jsxs)(eo.i.Tbody,{children:[(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{w:"10rem",children:(0,o.jsxs)(d.Group,{gap:4,justify:"center",children:[(0,o.jsx)(eM.Z,{size:14}),(0,o.jsx)(u.Text,{children:"Category"})]})}),null==M?void 0:null===(c=M.allBills)||void 0===c?void 0:null===(a=c.items)||void 0===a?void 0:null===(r=a.doctorPayableCategory)||void 0===r?void 0:r.map(e=>(0,o.jsx)(eo.i.Td,{w:"10rem",children:(0,o.jsx)(u.Text,{size:"sm",fw:600,children:e.name})},e.id))]}),(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{w:"10rem",children:"Total Amount"}),null==M?void 0:null===(h=M.allBills)||void 0===h?void 0:null===(v=h.items)||void 0===v?void 0:null===(m=v.doctorPayableCategory)||void 0===m?void 0:m.map(e=>{let i=null==L?void 0:L.find(i=>i.testCategoryId===e.id);return(0,o.jsx)(eo.i.Td,{w:"10rem",children:(0,o.jsxs)(S.Box,{className:C().box,bg:"#DADADA",children:["৳ ",Math.floor((null==i?void 0:i.price)||0).toLocaleString()||0]})},e.id)})]}),(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{w:"10rem",children:"Commission %"}),null==M?void 0:null===(g=M.allBills)||void 0===g?void 0:null===(p=g.items)||void 0===p?void 0:null===(x=p.doctorPayableCategory)||void 0===x?void 0:x.map(e=>{var i,t;let s=null==L?void 0:L.find(i=>i.testCategoryId===e.id),l=null==Y?void 0:null===(t=Y.data)||void 0===t?void 0:null===(i=t.doctorTestCategoryPercentages)||void 0===i?void 0:i.find(i=>i.testCategoryId===e.id);return(0,o.jsx)(eo.i.Td,{w:"10rem",children:(0,o.jsx)(eR.Y,{rightSection:(null==s?void 0:s.discountType)==="percentage"?(0,o.jsx)(eZ.Z,{size:16}):(0,o.jsx)(u.Text,{size:"xs",c:"dimmed",children:"৳"}),min:0,max:(null==s?void 0:s.discountType)==="percentage"?100:null==s?void 0:s.price,disabled:0===M.selectedBills.length,onChange:i=>{let t=q.map(t=>t.testCategoryId===e.id?{testCategoryId:t.testCategoryId,price:t.price,discount:isNaN(parseInt(i))?0:parseInt(i),discountType:t.discountType||"percentage"}:t);Q((0,X.RB)(t)),V(t)},defaultValue:(null==l?void 0:l.discount)||e.doctorCommissionAmount||0,radius:"md",size:"md",styles:{input:{fontWeight:600,textAlign:"center"}}})},e.id)})]}),(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{w:"10rem",children:"Type"}),null==M?void 0:null===(T=M.allBills)||void 0===T?void 0:null===(j=T.items)||void 0===j?void 0:null===(f=j.doctorPayableCategory)||void 0===f?void 0:f.map(e=>{var i,t;let s=null==L?void 0:L.find(i=>i.testCategoryId===e.id),l=null==Y?void 0:null===(t=Y.data)||void 0===t?void 0:null===(i=t.doctorTestCategoryPercentages)||void 0===i?void 0:i.find(i=>i.testCategoryId===e.id);return(0,o.jsx)(eo.i.Td,{w:"10rem",children:(0,o.jsx)(eE.r,{styles:{track:{fontWeight:600,fontSize:14},trackLabel:{minWidth:"7rem"}},onLabel:"Percentage",offLabel:"Amount",size:"xl",defaultChecked:(null==s?void 0:s.discountType)==="percentage"||(null==e?void 0:e.doctorCommissionType)==="percentage"||(null==l?void 0:l.discountType)==="percentage",disabled:0===M.selectedBills.length,onChange:i=>{let t=q.map(t=>t.testCategoryId===e.id?{testCategoryId:t.testCategoryId,price:t.price,discount:t.discount,discountType:i.target.checked?"percentage":"amount"}:t);Q((0,X.RB)(t)),V(t)},color:"blue"})},e.id)})]}),(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{w:"10rem",children:"Payment"}),null==M?void 0:null===(B=M.allBills)||void 0===B?void 0:null===(w=B.items)||void 0===w?void 0:null===(b=w.doctorPayableCategory)||void 0===b?void 0:b.map(e=>{let i=null==L?void 0:L.find(i=>i.testCategoryId===e.id);return(0,o.jsx)(eo.i.Td,{w:"10rem",children:(0,o.jsxs)(S.Box,{className:C().box,bg:"#D9e2ed",children:["৳ ",en(i).toLocaleString()]})},e.id)})]})]})})]}):(0,o.jsx)(et.Z,{})};let eO=async(e,i)=>{try{let t="".concat("http://sasthotech.local:5000/api/v1","/commission/doctor-per-test/").concat(e),o=await M.default.post(t,i,{...G.FD,...G.Hn});return{success:!0,data:o.data}}catch(e){if(e instanceof Z.d7){var t;return{success:!1,data:null===(t=e.response)||void 0===t?void 0:t.data.message}}return{success:!1,data:"An error occurred"}}};var eW=t(22975),eq=t(47720),eF=t(82132);function eU(e){var i,t,l;let{doctorId:r}=e,{data:a,isLoading:c,isError:m,refetch:v}=(0,H.Fp)(r,{refetchOnMountOrArgChange:!0}),h=(0,s.C)(e=>e.bills.selectedBills);console.log("selectedBills0",h);let x=(0,s.C)(e=>e.auth),[p,g]=(0,y.useState)(0),[f,j]=(0,y.useState)(3333),T=(0,y.useRef)(null),[b,w]=(0,y.useState)(!1),[B,z]=(0,y.useState)(void 0),[_,P]=(0,y.useState)(void 0),[I,A]=(0,eF.f)({content:()=>T.current,documentTitle:"Doctor Commission Lists",onBeforeGetContent(){},onAfterPrint(){z(void 0),P(void 0),q((0,O.aT)([])),q((0,O.Im)(null)),w(!1),v()}}),{selectedBills:k,tests:R,totals:E,totalDiscount:N,lastPaidCommissions:G,initialCommissions:M}=(0,y.useMemo)(()=>{var e,i,t,o,s,l,n;if(!a)return{selectedBills:[],tests:[],totals:[],totalDiscount:0,lastPaidCommissions:new Map,initialCommissions:0};let r=B||h,d=new Set(null==r?void 0:r.map(e=>e.billId)),c=null==a?void 0:null===(i=a.data)||void 0===i?void 0:null===(e=i.bills)||void 0===e?void 0:e.filter(e=>d.has(e.billId)),u=new Map;for(let e of c||[])for(let i of(null==e?void 0:e.tests)||[])i.testId&&u.set(i.testId,(u.get(i.testId)||0)+((null==x?void 0:null===(t=x.diagnostic)||void 0===t?void 0:t.isTestDiscountIncludeInBill)?i.price:"amount"===i.discountType?i.price-i.discount:i.price*(1-i.discount/100)));console.log("totalAmountsByTestID",u,c);let m=(null==a?void 0:null===(s=a.data)||void 0===s?void 0:null===(o=s.tests)||void 0===o?void 0:o.filter(e=>u.get(e.id)))||[],v=(null==m?void 0:m.map(e=>u.get(e.id)||0))||[],p=new Map((null==a?void 0:null===(n=a.data)||void 0===n?void 0:null===(l=n.percentages)||void 0===l?void 0:l.map(e=>[e.testId,[e.discount,e.discountType]]))||[]),f=m.map(e=>{var i,t,o,s;let l=null==p?void 0:p.get(e.id);return{commission:(null!==(t=null!==(i=null==l?void 0:l[0])&&void 0!==i?i:e.doctorCommissionAmount)&&void 0!==t?t:0)||0,isPercentage:"amount"!==(null!==(s=null!==(o=null==l?void 0:l[1])&&void 0!==o?o:e.doctorCommissionType)&&void 0!==s?s:"percentage")}}),j=Math.floor((null==f?void 0:f.reduce((e,i,t)=>e+(i.isPercentage?i.commission*(((null==v?void 0:v[t])||0)/100):i.commission),0))||0);g(j);let y=null==c?void 0:c.reduce((e,i)=>e+i.totalAmout-i.totalAmountWithDiscount,0);return{selectedBills:c,totalAmountsByTestID:u,tests:m,totalDiscount:y,totals:v,lastPaidCommissions:p,initialCommissions:j}},[x,a,h,B]),Z=(0,eq.c)({mode:"uncontrolled",initialValues:{commissions:[]},onValuesChange:e=>{g(Math.floor(e.commissions.reduce((e,i,t)=>e+(i.isPercentage?i.commission*(((null==E?void 0:E[t])||0)/100):i.commission),0)))}}),L=(0,y.useRef)(Z);L.current=Z;let{testCommissionControls:W}=(0,y.useMemo)(()=>{if(!R)return{};let e=L.current;e.setInitialValues({commissions:R.map(e=>{let[i,t]=(null==G?void 0:G.get(e.id))||[e.doctorCommissionAmount,e.doctorCommissionType];return{commission:i||0,isPercentage:"amount"!==t}})}),e.reset();let i=R.map((i,t)=>{let s=Math.floor((null==E?void 0:E[t])||0),l=e.getInputProps("commissions.".concat(t,".isPercentage"));return{id:i.id,Test:i.name,"Total Amount":(0,o.jsx)(S.Box,{className:C().box,bg:"#DADADA",children:s}),"Doctor Commission":(0,o.jsx)(eX,{i:t,form:e,total:s}),"Discount Type":(0,o.jsx)(eE.r,{styles:{track:{fontWeight:600,fontSize:14},trackLabel:{minWidth:"7rem"}},onLabel:"Percentage",offLabel:"Amount",size:"xl",defaultChecked:l.defaultValue,...l},e.key("commissions.".concat(t,".isPercentage"))),"Doctor Payment":(0,o.jsx)(S.Box,{className:C().box,bg:"#D9e2ed",children:(0,o.jsx)(eV,{i:t,form:e,total:s})})}});return{testCommissionControls:(0,o.jsx)(eo.i,{fz:"md",w:"auto",className:"text-wrap",children:(0,o.jsx)(eo.i.Tbody,{children:["Test","Total Amount","Doctor Commission","Discount Type","Doctor Payment"].map((e,t)=>{let s=t?eo.i.Td:eo.i.Th;return(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{w:"10rem",children:e}),null==i?void 0:i.map(i=>(0,o.jsx)(s,{w:"10rem",children:i[e]},i.id))]},e)})})})}},[G,R,E]),q=(0,s.T)(),[F,U]=(0,y.useState)(!1),X=(0,y.useRef)(!0);return c?(0,o.jsx)(et.Z,{}):m?(0,o.jsx)("div",{className:"p-3 text-center",children:"An error occurred"}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("form",{onWheel:eH,className:C().bottom,onSubmit:Z.onSubmit(async e=>{if(F||!k||!R)return;U(!0);let i=X.current;i&&h&&z([...h]);let t=e.commissions.map((e,i)=>({testId:R[i].id,commission:e.commission,commissionType:e.isPercentage?"percentage":"amount"}));i&&P(t);let{success:o,data:s}=await eO(r,{bills:k.map(e=>{let{id:i}=e;return{id:i}}),isPaid:X.current,commissions:t});X.current=!0,o?i?w(!0):(q((0,O.aT)([])),q((0,O.Im)(null)),v()):(ei().fire("Error",s||"Invalid Server Response","error"),i&&(z(void 0),P(void 0))),U(!1)}),children:[(0,o.jsxs)(n.Stack,{className:"".concat(C().upper," rounded-3 p-2"),bg:"#c3d5ed",children:[(0,o.jsx)(eo.i,{fz:"md",withRowBorders:!1,children:(0,o.jsxs)(eo.i.Tbody,{children:[(0,o.jsxs)(eo.i.Tr,{children:[(0,o.jsx)(eo.i.Th,{children:"Payable"}),(0,o.jsx)(eo.i.Td,{ta:"right",children:Z.isDirty()?p:M})]}),(0,o.jsxs)(eo.i.Tr,{style:{borderTop:"1px solid #0000003F"},children:[(0,o.jsx)(eo.i.Th,{children:"Total Commission"}),(0,o.jsx)(eo.i.Td,{ta:"right",children:Z.isDirty()?p:M||0})]})]})}),(0,o.jsxs)(d.Group,{justify:"space-between",mt:"auto",children:[(0,o.jsx)(D.Button,{type:"submit",radius:"sm",bg:"#FB9C48",onClick:()=>X.current=!1,disabled:F&&X.current||(Z.isDirty()?p:M||0)<=0,loading:F&&!X.current,children:"Save to Expense"}),((null==x?void 0:null===(i=x.user)||void 0===i?void 0:i.role)==="admin"||(null==x?void 0:null===(t=x.diagnostic)||void 0===t?void 0:t.isDoctorPayPermission)&&(null==x?void 0:null===(l=x.user)||void 0===l?void 0:l.role)==="receptionist")&&(0,o.jsxs)(D.Button,{type:"submit",radius:"sm",bg:"#1A72E9",disabled:F&&!X.current||(Z.isDirty()?p:M||0)<=0,loading:F&&X.current,children:["Pay Commission ",(0,o.jsx)("br",{})," Now"]})]})]}),W]}),(0,o.jsx)("div",{ref:T,children:(0,o.jsx)(ez,{doctorId:r,commissionOverrides:_})},f),(0,o.jsx)(eW.u,{opened:b,onClose:()=>{z(void 0),P(void 0),q((0,O.aT)([])),q((0,O.Im)(null)),w(!1),v()},title:"Payment Successful",centered:!0,size:"md",children:(0,o.jsxs)(n.Stack,{gap:"md",children:[(0,o.jsx)(u.Text,{size:"md",children:"The commission has been paid successfully. Would you like to print the receipt?"}),(0,o.jsxs)(d.Group,{justify:"flex-end",gap:"sm",children:[(0,o.jsx)(D.Button,{variant:"outline",color:"gray",onClick:()=>{z(void 0),P(void 0),q((0,O.aT)([])),q((0,O.Im)(null)),w(!1),v()},children:"Skip Print"}),(0,o.jsx)(D.Button,{color:"blue",onClick:()=>{I()},loading:A,children:"Print Receipt"})]})]})})]})}function eH(e){0==e.deltaX&&(e.preventDefault(),e.currentTarget.scrollBy({left:e.deltaY>0?50:-50}))}function eX(e){let{i,form:t,total:s}=e,[,l]=(0,y.useReducer)(e=>~e,0),{isPercentage:n}=t.getValues().commissions[i];return t.watch("commissions.".concat(i,".isPercentage"),l),(0,o.jsx)(eR.Y,{rightSection:(0,o.jsx)(o.Fragment,{}),min:0,max:n?100:s,radius:"md",size:"md",suffix:n?"%":void 0,...t.getInputProps("commissions.".concat(i,".commission"))},t.key("commissions.".concat(i,".commission")))}function eV(e){let{i,form:t,total:o}=e,[,s]=(0,y.useReducer)(e=>~e,0),{commission:l,isPercentage:n}=t.getValues().commissions[i];return t.watch("commissions.".concat(i,".commission"),s),t.watch("commissions.".concat(i,".isPercentage"),s),n?o/100*l:l}let eQ=e=>{let{icon:i,title:t,value:s,color:l,iconBg:r,isCurrency:c=!0}=e;return(0,o.jsx)(x.Z,{shadow:"sm",p:{base:"md",sm:"lg"},radius:"md",withBorder:!0,className:C().statCard,children:(0,o.jsxs)(d.Group,{justify:"space-between",align:"flex-start",wrap:"nowrap",children:[(0,o.jsxs)(n.Stack,{gap:"xs",style:{flex:1,minWidth:0},children:[(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",fw:500,truncate:"end",children:t}),(0,o.jsxs)(u.Text,{size:"xl",fw:700,c:l,style:{fontSize:"var(--mantine-font-size-xl)",overflowWrap:"break-word",wordBreak:"break-word"},children:[c&&"৳ ",null==s?void 0:s.toLocaleString()]})]}),(0,o.jsx)(a.k,{size:"xl",radius:"md",color:r,variant:"light",style:{flexShrink:0},children:i})]})})};var eY=()=>{var e,i,t,x,T;let b;let w=(0,s.C)(e=>{var i;return null===(i=e.bills)||void 0===i?void 0:i.allBills}),D=(0,s.C)(e=>e.auth.diagnostic),[S,B]=(0,y.useState)(!1),[z,_]=(0,y.useState)(4e3),[P,I]=(0,y.useState)([new Date(2024,1,20),new Date]),A=(0,s.C)(e=>e.auth),k=(0,y.useRef)(null),R=(0,y.useRef)(null),[E,N]=(0,y.useState)(null),[G,M]=(0,y.useState)("category"),Z=()=>{var e,i;let t=0;return null==w||null===(i=w.items)||void 0===i||null===(e=i.bills)||void 0===e||e.forEach(e=>{t+=e.totalAmountWithDiscount}),Math.floor(t)},[L,O]=(0,y.useState)(!1);return(0,o.jsx)(l.Container,{fluid:!0,className:C().container,children:(0,o.jsxs)(n.Stack,{gap:"xl",children:[(0,o.jsx)(r.X,{shadow:"xs",p:"md",radius:"md",withBorder:!0,children:(0,o.jsxs)(d.Group,{justify:"space-between",align:"center",children:[(0,o.jsxs)(d.Group,{gap:"md",children:[(0,o.jsx)(a.k,{size:"xl",radius:"md",variant:"gradient",gradient:{from:"blue",to:"cyan"},children:(0,o.jsx)(p.Z,{size:24})}),(0,o.jsxs)("div",{children:[(0,o.jsx)(c.Title,{order:2,fw:600,children:"Doctor Commission Management"}),(0,o.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Manage and process doctor commissions efficiently"})]})]}),E&&(0,o.jsx)(m.C,{size:"lg",variant:"gradient",gradient:{from:"teal",to:"lime",deg:105},leftSection:(0,o.jsx)(p.Z,{size:16}),children:E.name})]})}),(0,o.jsxs)(v.Grid,{gutter:"md",children:[(0,o.jsx)(v.Grid.Col,{span:{base:12,xs:6,sm:4},children:(0,o.jsx)(eQ,{title:"Total Bills",value:(null==w?void 0:w.totalItems)||0,icon:(0,o.jsx)(g.Z,{size:24}),color:"blue",iconBg:"blue",isCurrency:!1})}),(0,o.jsx)(v.Grid.Col,{span:{base:12,xs:6,sm:4},children:(0,o.jsx)(eQ,{icon:(0,o.jsx)(f.Z,{size:24}),title:"Sub Total",value:Z(),color:"green",iconBg:"green",isCurrency:!0})}),(0,o.jsx)(v.Grid.Col,{span:{base:12,xs:6,sm:4},children:(0,o.jsx)(eQ,{icon:(0,o.jsx)(j.Z,{size:24}),title:"Total Discount",value:(b=0,null==w||null===(T=w.items)||void 0===T||null===(x=T.bills)||void 0===x||x.forEach(e=>{b+=e.totalAmout}),Math.floor(b)-Z()),color:"orange",iconBg:"orange",isCurrency:!0})})]}),(0,o.jsx)(r.X,{shadow:"sm",p:"md",radius:"md",withBorder:!0,children:(0,o.jsx)(ek,{dates:P,setDates:I,keyCount:z,setKeyCount:_,isSubmitting:S,setIsSubmitting:B,payCommissionBtnRef:R,printButtonRef:k,selectedObject:E,setDoctorCommissionVisible:O,setSelectedObject:N,doctorCommissionType:G,setDoctorCommissionType:M})}),L&&E&&((null==A?void 0:null===(e=A.user)||void 0===e?void 0:e.role)==="admin"||(null==A?void 0:null===(i=A.diagnostic)||void 0===i?void 0:i.isDoctorPayPermission)&&(null==A?void 0:null===(t=A.user)||void 0===t?void 0:t.role)==="receptionist")&&(0,o.jsx)(r.X,{shadow:"md",p:"lg",radius:"md",withBorder:!0,className:C().commissionPanel,children:(0,o.jsxs)(n.Stack,{gap:"md",children:[(0,o.jsxs)(d.Group,{justify:"space-between",align:"center",children:[(0,o.jsxs)(d.Group,{gap:"xs",children:[(0,o.jsx)(a.k,{size:"md",radius:"md",variant:"light",color:"violet",children:(0,o.jsx)(f.Z,{size:18})}),(0,o.jsx)(u.Text,{size:"lg",fw:600,children:"Commission Calculator"})]}),(0,o.jsx)(m.C,{size:"lg",variant:"dot",color:(null==D?void 0:D.doctorCommissionBasis)==="CATEGORY_WISE"?"blue":"grape",children:(null==D?void 0:D.doctorCommissionBasis)==="CATEGORY_WISE"?"Category-wise":"Per Test"})]}),(0,o.jsx)(h.Divider,{}),(null==D?void 0:D.doctorCommissionBasis)==="TEST_WISE"?(0,o.jsx)(eU,{doctorId:E.id}):(0,o.jsx)(eL,{dates:P,keyCount:z,setKeyCount:_,isSubmitting:S,setIsSubmitting:B,payCommissionBtnRef:R,printButtonRef:k,selectedObject:E},z)]})})]})})}},7203:function(e,i,t){"use strict";var o=t(68328),s=t(14587);t(4505),i.Z=()=>(0,o.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:600},children:(0,o.jsx)(s.Loader,{color:"teal",variant:"dots"})})},72752:function(e,i,t){"use strict";var o=t(68328),s=t(25499),l=t(22614),n=t(22041),r=t(29593),d=t(77303),a=t(97698);t(4505),i.Z=e=>{let{small:i}=e,t=(0,s.C)(e=>e.dates),c=(0,s.C)(e=>e.auth.user);return(0,o.jsxs)("div",{className:"py-2",children:[(0,o.jsxs)(l.Group,{justify:"space-between",children:[(0,o.jsxs)(l.Group,{className:"fw-bold",gap:"sm",children:[(0,o.jsxs)(n.Text,{fw:700,style:{fontSize:i?10:16},size:"".concat(i?"xs":"md"),children:["Period :"," "]}),(0,o.jsx)(n.Text,{style:{fontSize:i?10:16},styles:{root:{textUnderlineOffset:5}},fw:700,children:(0,a.Z)((null==t?void 0:t.dates[0])?new Date(null==t?void 0:t.dates[0]):new Date,"dd-MMM-yyyy")}),(0,o.jsxs)(n.Text,{style:{fontSize:i?10:16},fw:700,children:[" "," To "," "," "]}),(0,o.jsx)(n.Text,{styles:{root:{textUnderlineOffset:5}},style:{fontSize:i?10:16},fw:700,children:(0,a.Z)((null==t?void 0:t.dates[1])?new Date(null==t?void 0:t.dates[1]):(null==t?void 0:t.dates[0])?new Date(null==t?void 0:t.dates[0]):new Date,"dd-MMM-yyyy")})]}),(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 4 4",fill:"none",children:(0,o.jsx)("circle",{cx:"2",cy:"2",r:"2",fill:"black"})}),(0,o.jsxs)(n.Text,{style:{fontSize:i?10:16},fw:600,children:["Printed By : ",null==c?void 0:c.name]}),(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 4 4",fill:"none",children:(0,o.jsx)("circle",{cx:"2",cy:"2",r:"2",fill:"black"})}),(0,o.jsxs)(n.Text,{style:{fontSize:i?10:16},fw:600,children:["Print Time : ",(0,a.Z)(new Date,"MM/dd/yyyy : hh:mm a")]})]}),!i&&(0,o.jsx)(r.Space,{h:10}),(0,o.jsx)(d.Divider,{color:"#787878"})]})}},72940:function(e,i,t){"use strict";t.d(i,{FD:function(){return s},Hn:function(){return o},y4:function(){return l}});let o={headers:{"Content-Type":"application/json"}},s={withCredentials:!0},l={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},64159:function(e,i,t){"use strict";t.d(i,{J:function(){return a}});var o=t(58539),s=t(95325),l=t(28301),n=t(25499),r=t(4505),d=t(53502);let a=()=>{let e=(0,n.T)(),i=(0,d.v9)(e=>e.doctors);return(0,r.useEffect)(()=>{(async function(){if(!i.adminDoctors){let{success:i,data:t}=await (0,o.c)();i&&e((0,l.v1)(t.items))}if(!i.allDoctors){let{success:i,data:t}=await (0,s.$)(1,1e3);i&&e((0,l.GO)(t.items))}})()},[]),i}},82132:function(e,i,t){"use strict";t.d(i,{f:function(){return d}});var o=t(12700),s=t(4505),l=t(88412),n=t(90660),r=t.n(n);function d(e,i){let[t,n]=(0,s.useState)(!1),d=(0,l.useReactToPrint)(e);return[(0,o.W)(async()=>{n(!0),await (null==i?void 0:i().catch(()=>{r().fire("Error","An unknown error occurred while preparing print content","error")}));let e=3,t=()=>{e-- >0?requestAnimationFrame(t):(n(!1),d())};t()}),t]}},41363:function(e,i,t){"use strict";t.d(i,{$:function(){return n}});var o=t(72940),s=t(6780),l=t(67732);let n=async e=>{try{let i=await s.default.patch("".concat("http://sasthotech.local:5000/api/v1","/admin/diagnostic"),e,o.y4);return{success:!0,data:i.data.data}}catch(e){if(e instanceof l.d7){var i;return{success:!1,data:null===(i=e.response)||void 0===i?void 0:i.data.message}}return{success:!1,data:"An error occurred"}}}},58539:function(e,i,t){"use strict";t.d(i,{c:function(){return l}});var o=t(49854),s=t(67732);let l=async(e,i,t)=>{try{let s=new URLSearchParams(Object.fromEntries(Object.entries({page:e,limit:i,search:t}).filter(e=>{let[i,t]=e;return void 0!==t}).map(e=>{let[i,t]=e;return[i,String(t)]}))),l="admin/doctor?".concat(s.toString()),n=await (0,o.d)(l);return{success:!0,data:n.data}}catch(e){if(e instanceof s.d7){var l;return{success:!1,data:null===(l=e.response)||void 0===l?void 0:l.data.message}}return{success:!1,data:"An error occurred"}}}},95325:function(e,i,t){"use strict";t.d(i,{$:function(){return l}});var o=t(49854),s=t(67732);let l=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{let s=await (0,o.d)("doctor",{page:e,limit:i,search:t});return{success:!0,data:s.data}}catch(e){if(e instanceof s.d7){var l;return{success:!1,data:null===(l=e.response)||void 0===l?void 0:l.data.message}}return{success:!1,data:"An error occurred"}}}},25922:function(e,i,t){"use strict";t.d(i,{BG:function(){return p},Fp:function(){return g},LW:function(){return o},U6:function(){return v},XK:function(){return x},_C:function(){return r},bX:function(){return l},ei:function(){return s},lF:function(){return m},mu:function(){return a},mx:function(){return d},tP:function(){return u}});let{useGetAllDoctorQuery:o,useGetDoctorQuery:s,useGetSingleDoctorQuery:l,useGetAllTimeSlotQuery:n,useCreateAppointmentMutation:r,useAllAppointmentsQuery:d,useGetAppointmentDashboardQuery:a,useUpdateAppointmentMutation:c,useCreateReservedAppointmentMutation:u,useGetAllReservedTimeSlotQuery:m,useStartQueueMutation:v,useGetRunningSessionsQuery:h,useGetAppointmentQuery:x,useAllAppointmentsWithoutGroupingQuery:p,useGetSingleDoctorTestsQuery:g}=t(78101).g.injectEndpoints({endpoints:e=>({getAllDoctor:e.query({query:()=>({url:"/doctorchamber",method:"GET"}),providesTags:["doctor"],transformResponse:e=>({data:e.data})}),getAllAdminDoctor:e.query({query:()=>({url:"/doctorchamber",method:"GET"}),providesTags:["doctor"],transformResponse:e=>({data:e.data})}),getDoctor:e.query({query:e=>({url:"/doctorchamber/".concat(e),method:"GET"}),providesTags:["doctor"],transformResponse:e=>({data:e.data})}),getSingleDoctor:e.query({query:e=>({url:"/doctor/".concat(e),method:"GET"}),providesTags:["doctor"],transformResponse:e=>({data:e.data})}),getAppointmentDashboard:e.query({query:e=>{let{from:i,to:t}=e;return{url:"/appointment/dashboard",method:"GET",params:{from:i instanceof Date?i.toISOString():i,to:t instanceof Date?t.toISOString():t}}},providesTags:["doctor"],keepUnusedDataFor:86400,transformResponse:e=>e}),getAllTimeSlot:e.query({query:e=>({url:"appointment/available-time-slots",method:"GET",params:e}),providesTags:["appointment"],transformResponse:e=>({data:e.data})}),createAppointment:e.mutation({query:e=>({url:"/appointment",method:"POST",body:e}),invalidatesTags:["appointment"]}),getAllReservedTimeSlot:e.query({query:e=>({url:"appointment/reserved-slots",method:"GET",params:e}),providesTags:["appointment"],transformResponse:e=>({data:e.data})}),createReservedAppointment:e.mutation({query:e=>({url:"/appointment/fill-reserved",method:"POST",body:e}),invalidatesTags:["appointment"]}),updateAppointment:e.mutation({query:e=>{let{id:i,...t}=e;return{url:"/appointment/".concat(i),method:"PATCH",body:t}},invalidatesTags:["appointment"]}),allAppointments:e.query({query:e=>({url:"/appointment/doctor",method:"GET",params:e}),providesTags:["appointment"],transformResponse:e=>({data:e.data})}),allAppointmentsWithoutGrouping:e.query({query:e=>({url:"/appointment",method:"GET",params:e}),transformResponse:e=>{var i;return{data:null===(i=e.data)||void 0===i?void 0:i.items}}}),startQueue:e.mutation({query:e=>({url:"/appointment/start-queue",method:"POST",body:e}),invalidatesTags:["appointment"]}),getRunningSessions:e.query({query:()=>({url:"/appointment/live/running-sessions",method:"GET"}),providesTags:["appointment"],transformResponse:e=>({message:e.message,sessions:e.sessions})}),getAppointment:e.query({query:e=>({url:"/appointment/".concat(e),method:"GET"}),providesTags:["appointment"],transformResponse:e=>({data:e.data})}),getSingleDoctorTests:e.query({query:e=>({url:"/doctor/".concat(e,"/tests")})})})})},78101:function(e,i,t){"use strict";t.d(i,{g:function(){return r}});var o=t(49854),s=t(68240),l=t(94183),n=t(28317);let r=(0,s.LC)({baseQuery:(0,l.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,i)=>fetch(e,i).then(async t=>{let s="string"==typeof e?e:e.url;return s.includes("?")||(null==i?void 0:i.body)||"string"!=typeof e&&e.body||await (0,n.t8)(s,await t.clone().json().catch(()=>null),(0,o.x)()),t}).catch(async t=>{if(t instanceof TypeError){let t="string"==typeof e?e:e.url;if(!t.includes("?")&&!(null==i?void 0:i.body)&&!("string"!=typeof e&&e.body)){let e=await (0,n.U2)(t,(0,o.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw t})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},74559:function(e,i,t){"use strict";t.d(i,{Im:function(){return n},av:function(){return l},nC:function(){return s}});let o=(0,t(79258).createSlice)({name:"auth",initialState:{isAuth:null,user:null,isProfileIncomplete:!1,diagnostic:null},reducers:{setUser:(e,i)=>{var t;e.user=i.payload,e.isAuth=!!i.payload,(null===(t=i.payload)||void 0===t?void 0:t.name)?localStorage.setItem("name",i.payload.name):localStorage.removeItem("name")},setDiagnostic:(e,i)=>{let t=i.payload;"hospital.sasthotech.com"===window.location.hostname?t.activeLogo=t.logo:t.activeLogo=t.offlineLogo,e.diagnostic=t},setProfileIncomplete:(e,i)=>{e.isProfileIncomplete=i.payload}}}),s=e=>{var i;return null===(i=e.auth.user)||void 0===i?void 0:i.role},{setUser:l,setDiagnostic:n}=o.actions;i.ZP=o.reducer},81943:function(e,i,t){"use strict";t.d(i,{Im:function(){return s},aE:function(){return n},aT:function(){return r}});let o=(0,t(79258).createSlice)({name:"bills",initialState:{allBills:null,selectedBills:[],categories:[]},reducers:{setBills:(e,i)=>{e.allBills=i.payload},setCategories:(e,i)=>{e.categories=i.payload},setCommissions:(e,i)=>{e.categories=i.payload},removeBill:(e,i)=>{var t;e.allBills=null===(t=e.allBills)||void 0===t?void 0:t.filter(e=>e.id!==i.payload)},setSelectedBills:(e,i)=>{Array.isArray(i.payload)?e.selectedBills=[...e.selectedBills,...i.payload]:e.selectedBills=[...e.selectedBills,i.payload]},removeSelectedBill:(e,i)=>{var t;Array.isArray(i.payload)?e.selectedBills=[]:e.selectedBills=null===(t=e.selectedBills)||void 0===t?void 0:t.filter(e=>e.billId!==i.payload)}}}),{setBills:s,removeBill:l,setSelectedBills:n,removeSelectedBill:r,setCategories:d}=o.actions;i.ZP=o.reducer},28301:function(e,i,t){"use strict";let o;t.d(i,{At:function(){return j},F0:function(){return u},GO:function(){return m},cv:function(){return f},id:function(){return g},ox:function(){return p},pF:function(){return a},v1:function(){return h}});var s=t(79258),l=t(69192),n=t(28317);let r=new Intl.Collator;function d(){return o||(o=(0,n.MT)("doctor-frequency-store","doctor-frequency")),o}let a=(0,s.createAsyncThunk)("doctors/increaseDoctorFrequencies",async e=>(await Promise.resolve((0,n.Vx)(e,e=>(e||0)+1,d())).catch(),await (0,n.qh)(d()).catch(()=>[]))),c=(0,s.createSlice)({name:"doctors",initialState:{allDoctors:null,chamberedDoctors:null,adminDoctors:null,addedDoctors:[],paginatedAdminDoctors:null},reducers:{setAllDoctors:(e,i)=>{e.allDoctors=i.payload},setChamberedDoctors:(e,i)=>{e.chamberedDoctors=i.payload},setAdminDoctors:(e,i)=>{Array.isArray(i.payload)?e.adminDoctors=i.payload:e.adminDoctors?e.adminDoctors=[...e.adminDoctors,i.payload]:e.adminDoctors=i.payload},setPaginatedAdminDoctors:(e,i)=>{e.paginatedAdminDoctors=i.payload},setAddedDoctors:(e,i)=>{e.addedDoctors=[...e.addedDoctors,i.payload]},removeChamberedDoctor:(e,i)=>{e.addedDoctors=e.chamberedDoctors.filter(e=>e.Doctor.id!==i.payload)},removeAdminDoctor:(e,i)=>{var t,o;e.adminDoctors=null!==(o=null===(t=e.adminDoctors)||void 0===t?void 0:t.filter(e=>e.id!==i.payload))&&void 0!==o?o:null},removePaginatedAdminDoctor:(e,i)=>{var t,o;e.paginatedAdminDoctors=null!==(o=null===(t=e.paginatedAdminDoctors)||void 0===t?void 0:t.filter(e=>e.id!==i.payload))&&void 0!==o?o:null}},extraReducers:e=>{e.addCase(a.fulfilled,(e,i)=>{var t;let o=new Map(i.payload);null===(t=e.adminDoctors)||void 0===t||t.sort((e,i)=>{var t,s;return(null!==(t=o.get(i.id))&&void 0!==t?t:0)-(null!==(s=o.get(e.id))&&void 0!==s?s:0)||r.compare(e.name,i.name)})})}}),u=(0,l.createSelector)([e=>e.doctors,e=>{var i;return null===(i=e.auth.diagnostic)||void 0===i?void 0:i.showOnlyAdminDoctor}],(e,i)=>{let{adminDoctors:t,allDoctors:o,chamberedDoctors:s}=e,l=s?s.map(e=>e.Doctor):[],n=new Map;return[...t||[],...l&&!i?l:[],...o&&!i?o:[]].forEach(e=>{var i,t;let o=(null==e?void 0:null===(i=e.name)||void 0===i?void 0:i.trim())+(null==e?void 0:null===(t=e.designation)||void 0===t?void 0:t.trim());n.has(o)||n.set(o,e)}),Array.from(n.values())}),{setAllDoctors:m,setChamberedDoctors:v,setAdminDoctors:h,setAddedDoctors:x,removeChamberedDoctor:p,removeAdminDoctor:g,setPaginatedAdminDoctors:f,removePaginatedAdminDoctor:j}=c.actions;i.ZP=c.reducer},25499:function(e,i,t){"use strict";t.d(i,{C:function(){return l},T:function(){return s}});var o=t(53502);let s=()=>(0,o.I0)(),l=o.v9},58576:function(e,i,t){"use strict";t.d(i,{RB:function(){return s}});let o=(0,t(79258).createSlice)({name:"pcCommissions",initialState:{commissions:[]},reducers:{setPcCommissions:(e,i)=>{e.commissions=i.payload},removePcCommissions:(e,i)=>{var t;e.commissions=null===(t=e.commissions)||void 0===t?void 0:t.filter(e=>e.testCategoryId!==i.payload)}}}),{setPcCommissions:s,removePcCommissions:l}=o.actions;i.ZP=o.reducer},88531:function(e,i,t){"use strict";t.d(i,{V:function(){return function e(i){if(i in o)return o[i];let t="";return i>=1e5&&(t+=e(Math.floor(i/1e5))+" lac ",i%=1e5),i>=1e3&&(t+=e(Math.floor(i/1e3))+" thousand ",i%=1e3),i>=100&&(t+=e(Math.floor(i/100))+" hundred ",i%=100),i>0&&(""!==t&&(t+=" and "),i<20?t+=o[i]:(t+=o[10*Math.floor(i/10)],i%10>0&&(t+="-"+o[i%10]))),t}}});let o={0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine",10:"ten",11:"eleven",12:"twelve",13:"thirteen",14:"fourteen",15:"fifteen",16:"sixteen",17:"seventeen",18:"eighteen",19:"nineteen",20:"twenty",30:"thirty",40:"forty",50:"fifty",60:"sixty",70:"seventy",80:"eighty",90:"ninety"}},49854:function(e,i,t){"use strict";let o;t.d(i,{d:function(){return a},x:function(){return d}});var s=t(72940),l=t(6780),n=t(67732),r=t(28317);function d(){return o||(o=(0,r.MT)("cached-responses-store","cached-responses")),o}async function a(e,i){try{let t=await l.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:i,...s.FD});return await (0,r.t8)(e,t.data,d()),t.data}catch(i){if(i instanceof n.d7&&[n.d7.ERR_NETWORK,n.d7.ETIMEDOUT].includes(i.code)){let i=await (0,r.U2)(e,d());if(i)return i}throw i instanceof n.d7&&i.response&&401===i.response.status||console.error(i),i}}},96579:function(e){e.exports={container:"DoctorCommissionContainer_container__3zLAf",statCard:"DoctorCommissionContainer_statCard__a50QZ",commissionPanel:"DoctorCommissionContainer_commissionPanel__ygIb3",slideUp:"DoctorCommissionContainer_slideUp__RVeSM",bottom:"DoctorCommissionContainer_bottom__vn51n",box:"DoctorCommissionContainer_box__AeNja",title:"DoctorCommissionContainer_title__EEz_i",upper:"DoctorCommissionContainer_upper__syNga",table:"DoctorCommissionContainer_table__ACAje",page:"DoctorCommissionContainer_page__PqBvJ",filterSection:"DoctorCommissionContainer_filterSection__Of2SD",filterGroup:"DoctorCommissionContainer_filterGroup__Pymz7",filterItem:"DoctorCommissionContainer_filterItem__te7Rx",commissionCard:"DoctorCommissionContainer_commissionCard__2t9Wa",commissionSummary:"DoctorCommissionContainer_commissionSummary__NBS4q",billsTable:"DoctorCommissionContainer_billsTable__z2nmB",tableHeader:"DoctorCommissionContainer_tableHeader__8GpGO",tableRow:"DoctorCommissionContainer_tableRow__AHQUf",actionButton:"DoctorCommissionContainer_actionButton__cCFCL",primaryButton:"DoctorCommissionContainer_primaryButton__UH5UA",secondaryButton:"DoctorCommissionContainer_secondaryButton__7TNYG",emptyState:"DoctorCommissionContainer_emptyState__F3_eI",emptyStateIcon:"DoctorCommissionContainer_emptyStateIcon__UW1zQ",loadingOverlay:"DoctorCommissionContainer_loadingOverlay__rM7Nb"}},75326:function(e){e.exports={container:"PcCommissionContainer_container__fXoU7",bottom:"PcCommissionContainer_bottom__88KpH",box:"PcCommissionContainer_box__LULj_",title:"PcCommissionContainer_title__NiFl_",upper:"PcCommissionContainer_upper__gCWrJ",table:"PcCommissionContainer_table__dVM3m",page:"PcCommissionContainer_page__Z6_e5",responsiveButton:"PcCommissionContainer_responsiveButton__8SqIK"}},32839:function(e){e.exports={selectionBar:"DoctorCommissionTable_selectionBar__WCH3x",slideDown:"DoctorCommissionTable_slideDown__C_ym3",tableCard:"DoctorCommissionTable_tableCard__ooZ9Y",doctorTable:"DoctorCommissionTable_doctorTable__xsjxi",headerRow:"DoctorCommissionTable_headerRow__KAXdx",tableRow:"DoctorCommissionTable_tableRow__F4xQu",unpaidRow:"DoctorCommissionTable_unpaidRow__4QJQl",paidRow:"DoctorCommissionTable_paidRow__BHwQb",selectedRow:"DoctorCommissionTable_selectedRow__PPC9l",rowNumber:"DoctorCommissionTable_rowNumber__ml5a8",billIdBadge:"DoctorCommissionTable_billIdBadge__6i5GR",copyButton:"DoctorCommissionTable_copyButton__vqdSc",priceBadge:"DoctorCommissionTable_priceBadge__seDeO",activePriceCell:"DoctorCommissionTable_activePriceCell__B9_Lx",pulse:"DoctorCommissionTable_pulse__4a_0s",actionButton:"DoctorCommissionTable_actionButton__6mOHt",summaryRow:"DoctorCommissionTable_summaryRow__lK_1f",totalBadge:"DoctorCommissionTable_totalBadge__WZOi6",fadeIn:"DoctorCommissionTable_fadeIn__vh1Oi",fadeInScale:"DoctorCommissionTable_fadeInScale__HGbJL"}}}]);