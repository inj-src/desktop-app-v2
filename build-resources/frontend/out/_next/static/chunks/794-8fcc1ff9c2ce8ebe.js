"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[794],{40794:function(e,t,n){n.d(t,{d:function(){return T}});var r=n(68328),a=n(4505),o=n(48604),i=n(22614),s=n(14587),u=n(22041),d=n(41224),c=n(32451),l=n(11114),y=n(85033),v=n(31204),m=n(59832),g=n(76283),h=n(52387),f=n(25499);function T(e){let{userId:t,userEmail:n,selectedStores:T,onStoresChange:p,onSave:q,saving:E=!1,disabled:S=!1}=e,{data:I,isLoading:P}=(0,h.WY)({}),x=(0,f.C)(e=>e.auth.user),[k,b]=(0,a.useState)(T||[]),[j,w]=(0,a.useState)(T||[]);(0,a.useEffect)(()=>{b(T||[]),w(T||[])},[T]);let R=(0,a.useMemo)(()=>(null==I?void 0:I.data)||[],[null==I?void 0:I.data]),D=(0,a.useMemo)(()=>{if((null==x?void 0:x.role)==="admin"||(null==x?void 0:x.role)==="superadmin")return R.filter(e=>e.isActive);let e=Array.isArray(null==x?void 0:x.userInventoryStores)?x.userInventoryStores.map(e=>e.storeId):[];return R.filter(t=>t.isActive&&e.includes(t.id))},[R,x]),G=D.map(e=>{var t,n;return{value:e.id,label:"".concat(e.name).concat((null===(n=e.tag)||void 0===n?void 0:null===(t=n.tag)||void 0===t?void 0:t.name)?" (".concat(e.tag.tag.name,")"):"")}}),A=async()=>{await q(t),w(k)},C=(0,a.useMemo)(()=>{let e=[...k].sort(),t=[...j].sort();return JSON.stringify(e)!==JSON.stringify(t)},[k,j]);return P?(0,r.jsx)(o.Z,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,children:(0,r.jsxs)(i.Group,{justify:"center",p:"xl",children:[(0,r.jsx)(s.Loader,{size:"sm"}),(0,r.jsx)(u.Text,{size:"sm",c:"dimmed",children:"Loading inventory stores..."})]})}):(0,r.jsx)(o.Z,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,children:(0,r.jsxs)(d.Stack,{gap:"md",children:[(0,r.jsxs)(i.Group,{justify:"space-between",align:"center",children:[(0,r.jsxs)(i.Group,{gap:"xs",children:[(0,r.jsx)(m.Z,{size:20}),(0,r.jsxs)(c.Box,{children:[(0,r.jsx)(u.Text,{size:"sm",fw:600,children:"Inventory Access"}),(0,r.jsx)(u.Text,{size:"xs",c:"dimmed",children:n})]})]}),k.length>0&&(0,r.jsxs)(l.C,{size:"sm",variant:"light",color:"blue",children:[k.length," ",1===k.length?"store":"stores"]})]}),(0,r.jsx)(y.N,{label:"Select Inventory Stores",description:"Choose which inventory stores this user can manage",placeholder:D.length>0?"Select stores...":"No stores available",data:G,value:k,onChange:e=>{b(e),p(e)},disabled:S||0===D.length,searchable:!0,clearable:!0,maxDropdownHeight:200}),(0,r.jsx)(i.Group,{justify:"flex-end",children:(0,r.jsx)(v.Button,{leftSection:(0,r.jsx)(g.Z,{size:16}),onClick:A,loading:E,disabled:S,size:"sm",variant:"light",children:"Save Inventory Access"})}),!C&&k.length>0&&(0,r.jsx)(u.Text,{size:"xs",c:"dimmed",ta:"right",children:"âœ“ Saved"})]})})}},72940:function(e,t,n){n.d(t,{FD:function(){return a},Hn:function(){return r},y4:function(){return o}});let r={headers:{"Content-Type":"application/json"}},a={withCredentials:!0},o={headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}},52387:function(e,t,n){n.d(t,{Cf:function(){return O},DD:function(){return C},OB:function(){return j},OE:function(){return s},WK:function(){return y},WY:function(){return r},Xz:function(){return h},Yd:function(){return G},_r:function(){return N},a:function(){return R},aB:function(){return b},aS:function(){return w},ap:function(){return B},bM:function(){return v},bg:function(){return c},fF:function(){return f},fp:function(){return T},fv:function(){return g},gZ:function(){return U},j6:function(){return o},lg:function(){return A},mS:function(){return m},sv:function(){return z},vR:function(){return D},zQ:function(){return L}});let{useGetAllStoresQuery:r,useGetStoreQuery:a,useCreateStoreMutation:o,useUpdateStoreMutation:i,useDeleteStoreMutation:s,useGetAllStoreTagsQuery:u,useGetStoreTagQuery:d,useCreateStoreTagMutation:c,useDeleteStoreTagMutation:l,useGetAllInventoryItemsQuery:y,useGetInventoryItemQuery:v,useCreateInventoryItemMutation:m,useUpdateInventoryItemMutation:g,useDeleteInventoryItemMutation:h,useDeductStockMutation:f,useAddStockMutation:T,useGetAllInventoryPackagesQuery:p,useGetInventoryPackageQuery:q,useCreateInventoryPackageMutation:E,useUpdateInventoryPackageMutation:S,useDeleteInventoryPackageMutation:I,useAddItemToPackageMutation:P,useUpdatePackageItemMutation:x,useRemoveItemFromPackageMutation:k,useGetDeductionPoliciesQuery:b,useCreateDeductionPolicyMutation:j,useUpdateDeductionPolicyMutation:w,useDeleteDeductionPolicyMutation:R,useGetDashboardSummaryQuery:D,useGetStockTrendsQuery:G,useGetCriticalAlertsQuery:A,useGetTransactionLogsQuery:C,useGetBatchesQuery:O,useGetUsersQuery:L,useGetGroupedTransactionsQuery:z,useGetDefaultStoresQuery:U,useAddDefaultStoreMutation:B,useSetDefaultStoresMutation:M,useDeleteDefaultStoreMutation:N}=n(78101).g.injectEndpoints({endpoints:e=>({getAllStores:e.query({query:()=>({url:"/store",method:"GET"}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getStore:e.query({query:e=>({url:"/store/".concat(e),method:"GET"}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),createStore:e.mutation({query:e=>({url:"/store",method:"POST",body:e}),invalidatesTags:["inventory"]}),updateStore:e.mutation({query:e=>{let{id:t,...n}=e;return{url:"/store/".concat(t),method:"PUT",body:n}},invalidatesTags:["inventory"]}),deleteStore:e.mutation({query:e=>({url:"/store/".concat(e),method:"DELETE"}),invalidatesTags:["inventory"]}),getAllStoreTags:e.query({query:()=>({url:"/storeTag",method:"GET"}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getStoreTag:e.query({query:e=>({url:"/storeTag/".concat(e),method:"GET"}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),createStoreTag:e.mutation({query:e=>({url:"/storeTag",method:"POST",body:e}),invalidatesTags:["inventory"]}),deleteStoreTag:e.mutation({query:e=>({url:"/storeTag/".concat(e),method:"DELETE"}),invalidatesTags:["inventory"]}),getAllInventoryItems:e.query({query:e=>({url:"/inventoryItem",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data,pagination:e.pagination})}),getInventoryItem:e.query({query:e=>({url:"/inventoryItem/".concat(e),method:"GET"}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),createInventoryItem:e.mutation({query:e=>({url:"/inventoryItem",method:"POST",body:e}),invalidatesTags:["inventory"]}),updateInventoryItem:e.mutation({query:e=>{let{id:t,...n}=e;return{url:"/inventoryItem/".concat(t),method:"PUT",body:n}},invalidatesTags:["inventory"]}),deleteInventoryItem:e.mutation({query:e=>({url:"/inventoryItem/".concat(e),method:"DELETE"}),invalidatesTags:["inventory"]}),deductStock:e.mutation({query:e=>({url:"/inventoryItem/deduct-stock",method:"POST",body:e}),invalidatesTags:["inventory"]}),addStock:e.mutation({query:e=>({url:"/inventoryItem/add-stock",method:"POST",body:e}),invalidatesTags:["inventory"]}),getAllInventoryPackages:e.query({query:e=>({url:"/inventoryPackage",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data,pagination:e.pagination})}),getInventoryPackage:e.query({query:e=>({url:"/inventoryPackage/".concat(e),method:"GET"}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),createInventoryPackage:e.mutation({query:e=>({url:"/inventoryPackage",method:"POST",body:e}),invalidatesTags:["inventory"]}),updateInventoryPackage:e.mutation({query:e=>{let{id:t,...n}=e;return{url:"/inventoryPackage/".concat(t),method:"PUT",body:n}},invalidatesTags:["inventory"]}),deleteInventoryPackage:e.mutation({query:e=>({url:"/inventoryPackage/".concat(e),method:"DELETE"}),invalidatesTags:["inventory"]}),addItemToPackage:e.mutation({query:e=>{let{packageId:t,...n}=e;return{url:"/inventoryPackage/".concat(t,"/items"),method:"POST",body:n}},invalidatesTags:["inventory"]}),updatePackageItem:e.mutation({query:e=>{let{packageId:t,itemId:n,...r}=e;return{url:"/inventoryPackage/".concat(t,"/items/").concat(n),method:"PUT",body:r}},invalidatesTags:["inventory"]}),removeItemFromPackage:e.mutation({query:e=>{let{packageId:t,itemId:n}=e;return{url:"/inventoryPackage/".concat(t,"/items/").concat(n),method:"DELETE"}},invalidatesTags:["inventory"]}),getDeductionPolicies:e.query({query:e=>({url:"/inventoryItem/".concat(e,"/deduction-policy"),method:"GET"}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),createDeductionPolicy:e.mutation({query:e=>{let{itemId:t,...n}=e;return{url:"/inventoryItem/".concat(t,"/deduction-policy"),method:"POST",body:n}},invalidatesTags:["inventory"]}),updateDeductionPolicy:e.mutation({query:e=>{let{itemId:t,policyId:n,...r}=e;return{url:"/inventoryItem/".concat(t,"/deduction-policy/").concat(n),method:"PATCH",body:r}},invalidatesTags:["inventory"]}),deleteDeductionPolicy:e.mutation({query:e=>{let{itemId:t,policyId:n}=e;return{url:"/inventoryItem/".concat(t,"/deduction-policy/").concat(n),method:"DELETE"}},invalidatesTags:["inventory"]}),getDashboardSummary:e.query({query:e=>({url:"/inventory/dashboard/summary",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getStockTrends:e.query({query:e=>({url:"/inventory/dashboard/trends",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getCriticalAlerts:e.query({query:e=>({url:"/inventory/dashboard/critical-alerts",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getTransactionLogs:e.query({query:e=>({url:"/inventory/transactions",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getBatches:e.query({query:e=>({url:"/inventory/batches",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getUsers:e.query({query:()=>({url:"/admin/user",method:"GET"}),transformResponse:e=>({data:e.data})}),getGroupedTransactions:e.query({query:e=>({url:"/inventory/transactions/grouped",method:"GET",params:e}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),getDefaultStores:e.query({query:e=>({url:"/inventory/default-stores",method:"GET",params:e?{billType:e}:void 0}),providesTags:["inventory"],transformResponse:e=>({data:e.data})}),addDefaultStore:e.mutation({query:e=>({url:"/inventory/default-stores",method:"POST",body:e}),invalidatesTags:["inventory"]}),setDefaultStores:e.mutation({query:e=>({url:"/inventory/default-stores",method:"PUT",body:e}),invalidatesTags:["inventory"]}),deleteDefaultStore:e.mutation({query:e=>({url:"/inventory/default-stores",method:"DELETE",body:e}),invalidatesTags:["inventory"]})})})},78101:function(e,t,n){n.d(t,{g:function(){return s}});var r=n(49854),a=n(68240),o=n(94183),i=n(28317);let s=(0,a.LC)({baseQuery:(0,o.ni)({baseUrl:"http://sasthotech.local:5000/api/v1",credentials:"include",fetchFn:(e,t)=>fetch(e,t).then(async n=>{let a="string"==typeof e?e:e.url;return a.includes("?")||(null==t?void 0:t.body)||"string"!=typeof e&&e.body||await (0,i.t8)(a,await n.clone().json().catch(()=>null),(0,r.x)()),n}).catch(async n=>{if(n instanceof TypeError){let n="string"==typeof e?e:e.url;if(!n.includes("?")&&!(null==t?void 0:t.body)&&!("string"!=typeof e&&e.body)){let e=await (0,i.U2)(n,(0,r.x)());if(e)return new Response(e,{headers:new Headers({"Content-Type":"application/json"})})}}throw n})}),endpoints:()=>({}),tagTypes:["BillTest","doctor","hospitalBill","inventory","appointment","patient","sms","sms-dashboard","sms-messages","sms-analytics","sms-status","notice","template","versionAdmin-services","versionAdmin-versions","versionAdmin-hospitals","versionAdmin-logs","versionAdmin-sessions","versionAdmin-devices","versionAdmin-notifications","versionAdmin-notification-stats","PCMeetup","MarketerTarget","Marketer"]})},25499:function(e,t,n){n.d(t,{C:function(){return o},T:function(){return a}});var r=n(53502);let a=()=>(0,r.I0)(),o=r.v9},49854:function(e,t,n){let r;n.d(t,{d:function(){return d},x:function(){return u}});var a=n(72940),o=n(6780),i=n(67732),s=n(28317);function u(){return r||(r=(0,s.MT)("cached-responses-store","cached-responses")),r}async function d(e,t){try{let n=await o.default.get(e,{baseURL:"http://sasthotech.local:5000/api/v1",params:t,...a.FD});return await (0,s.t8)(e,n.data,u()),n.data}catch(t){if(t instanceof i.d7&&[i.d7.ERR_NETWORK,i.d7.ETIMEDOUT].includes(t.code)){let t=await (0,s.U2)(e,u());if(t)return t}throw t instanceof i.d7&&t.response&&401===t.response.status||console.error(t),t}}}}]);