"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5385],{2929:function(e,t,n){n.d(t,{M:function(){return i}});var r=n(68328),l=n(47137),o=n(28121),a=n.n(o);function i(e){let{html:t,containerRef:n,data:o,pageHeight:i,pageWidth:u}=e,s=null!=t?t:"<section style='width: 210mm; height: 297mm;'></section>";try{s=a().compile(s)(null!=o?o:{})}catch(e){s='\n         <div style="padding: 16px; color: #dc2626;">\n            <strong>Error:</strong> '.concat(e.message,'<br/>\n            <div style="margin-top: 8px; color: #374151; font-size: 0.875rem;">Hint: check your Handlebars expressions, registered helpers, and the shape of the provided data.</div>\n         </div>\n      ')}return(0,r.jsx)(l.i,{html:s,containerRef:n,pageHeight:i,pageWidth:u})}(0,n(36083)._L)()},51930:function(e,t,n){n.d(t,{H:function(){return r}});let r={OUTDOOR_SUMMARY:"Outdoor Summary",INDOOR_SUMMARY:"Indoor Summary",LAB_REPORT:"Lab Report",RECEPTIONIST_SUMMARY:"Receptionist Summary",MONTHLY_SUMMARY:"Monthly Summary",OUTDOOR_TOTAL_BILL:"Outdoor Total Bill",OUTDOOR_BILL:"Outdoor Bill",INDOOR_BILL_SUMMARY:"Indoor Bill Summary",INDOOR_ADMISSION:"Indoor Admission",INDOOR_BILL_DETAILS:"Indoor Bill Details",TEST_SUMMARY:"Test Summary",OPD_SUMMARY:"OPD Summary",APPOINTMENT_SUMMARY:"Appointment Summary",APPOINTMENT_TICKET:"Appointment Ticket",INVENTORY_TRANSACTION_REPORT:"Inventory Transaction Report",TEST_CATEGORY_STATEMENT:"Test Category Statement",TEST_WISE_STATEMENT:"Test Wise Statement",BILL_BY_PC_STATEMENT:"Bill by PC Statement",BILL_BY_DOCTOR_STATEMENT:"Bill by Doctor Statement",PC_WISE_STATEMENT:"PC Wise Statement",DOCTOR_WISE_STATEMENT:"Doctor Wise Statement",PC_COMMISSION_CATEGORY_WISE_STATEMENT:"PC Commission Category Wise Statement",DOCTOR_COMMISSION_CATEGORY_WISE_STATEMENT:"Doctor Commission Category Wise Statement",PC_COMMISSION_TEST_WISE_STATEMENT:"PC Commission Test Wise Statement",DOCTOR_COMMISSION_TEST_WISE_STATEMENT:"Doctor Commission Test Wise Statement",DAILY_EXTRA_INCOME_STATEMENT:"Daily Extra Income Statement",DAILY_EXPENSE_STATEMENT:"Daily Expense Statement"}},72226:function(e,t,n){n.d(t,{s:function(){return function e(t,n,o,a,i){if(!t||"object"!=typeof t)return t;let u=null!=o?o:t,s=null!=i?i:"",c=a?n:function(e){let t={};for(let[n,l]of Object.entries(e))!function e(t,n,l){let o=function(e){let t=e.trim(),n=t.match(/^\{{2,4}([^{}]+)\}{2,4}$/);n&&(t=n[1].trim()),(t.startsWith("#")||t.startsWith("/")||t.startsWith("^")||t.startsWith(">"))&&(t=t.substring(1).trim());let r=t.split(/\s+/);return r.length>1&&["each","if","unless","with","table"].includes(r[0].toLowerCase())?r[1]:r[0]}(t),a=function(e){let t=e.trim(),n=t.match(/^\{{2,4}([^{}]+)\}{2,4}$/);return n&&(t=n[1].trim()),(t.startsWith("#")||t.startsWith("^"))&&t.substring(1).trim().split(/\s+/)[0]||null}(t),i=!!a&&r.has(a.toLowerCase());if("string"==typeof n){l[o]=n;return}if(!n||"object"!=typeof n)return;if(i){for(let[t,r]of(l[o]=n.value||"",Object.entries(n)))"value"!==t&&e(t,r,l);return}let u={value:n.value||""};for(let[t,r]of Object.entries(n))"value"!==t&&e(t,r,u);l[o]=u}(n,l,t);return t}(n);return new Proxy(t,{get(t,n,r){if("symbol"==typeof n)return Reflect.get(t,n,r);let o=String(n),a=s?"".concat(s,".").concat(o):o,i=c[a];if(void 0!==i){if("string"==typeof i)return l(u,i);{let t=l(u,i.value);if(t&&"object"==typeof t){let n={};for(let[e,t]of Object.entries(i))"value"!==e&&(n[e]=t);return Array.isArray(t)?t.map(t=>e(t,n,u,!0,"")):e(t,n,u,!0,"")}return t}}let d=c[o];if(void 0!==d){if("string"==typeof d)return l(u,d);{let t=l(u,d.value);if(t&&"object"==typeof t){let n={};for(let[e,t]of Object.entries(d))"value"!==e&&(n[e]=t);return Array.isArray(t)?t.map(t=>e(t,n,u,!0,"")):e(t,n,u,!0,"")}return t}}let m=Object.keys(c).some(e=>e.startsWith(a+".")),f=Reflect.get(t,n,r);return m?e(f&&"object"==typeof f?f:{},c,u,!0,a):f&&"object"==typeof f?e(f,c,u,!0,a):f},has(e,t){let n="symbol"==typeof t?"":String(t),r=s?"".concat(s,".").concat(n):n;return!!(void 0!==c[r]||Object.keys(c).some(e=>e===r||e.startsWith(r+".")))||Reflect.has(e,t)},ownKeys(e){let t=Reflect.ownKeys(e);for(let e of Object.keys(c)){let n=null;s?e.startsWith(s+".")&&(n=e.slice(s.length+1).split(".")[0]):n=e.split(".")[0],n&&!t.includes(n)&&t.push(n)}return t},getOwnPropertyDescriptor(e,t){let n="symbol"==typeof t?"":String(t),r=s?"".concat(s,".").concat(n):n;if(void 0!==c[r]){let e=c[r];return{value:"string"==typeof e?l(u,e):l(u,e.value),writable:!0,enumerable:!0,configurable:!0}}return Object.keys(c).some(e=>e.startsWith(r+"."))?{value:{},writable:!0,enumerable:!0,configurable:!0}:Reflect.getOwnPropertyDescriptor(e,t)}})}}});let r=new Set(["if","unless"]);function l(e,t){if(e&&"object"==typeof e&&t)return t.split(".").map(e=>{let t=e.match(/^\[(\d+)\]$/);return t?parseInt(t[1],10):e}).reduce((e,t)=>{if(null!=e&&"object"==typeof e)return e[t]},e)}},36083:function(e,t,n){n.d(t,{TP:function(){return u},_L:function(){return o},wj:function(){return i}});var r=n(28121),l=n.n(r);function o(){l().registerHelper("table",a)}function a(e,t){let n;if(!Array.isArray(e))return console.warn("table helper expects an array as the first argument, got:",e),"Handlebars table helper error: first argument is not an array";t.data&&(n=l().createFrame(t.data)),n&&(n.length=e.length);let r={data:n},o=t.fn(void 0,r),a=new DOMParser().parseFromString(o,"text/html"),i=a.querySelector("table");if(!i)return console.warn("table helper: no <table> element found in block content"),o;let u=i.querySelectorAll("tr"),s=[];for(let e of u)for(let t of e.querySelectorAll("td")){var c,d;let n=null!==(d=null===(c=t.textContent)||void 0===c?void 0:c.trim())&&void 0!==d?d:"";if(/^\\?\{\{.+\}\}$/.test(n)){s.push(e);break}}if(0===s.length)return console.warn("table helper: no template row found (no row with <td> elements)"),o;if(0===e.length)return s.forEach(e=>e.remove()),new(l()).SafeString(a.body.innerHTML);let m=s.reduceRight((e,t)=>t.outerHTML+e,""),f=l().compile("{{#each this}}".concat(m,"{{/each}}"))(e,r);return s[0].insertAdjacentHTML("afterend",f),s.forEach(e=>e.remove()),new(l()).SafeString(a.body.innerHTML)}function i(){l().registerHelper("helperMissing",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=t[t.length-1];return new(l()).SafeString('<span style="color: red; font-weight: bold;">[Missing '.concat(r.name,"]</span>"))}),l().registerHelper("blockHelperMissing",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=t[t.length-1],o=t.length>1?t[0]:this,a="function"==typeof r.fn?r.fn(o):"";return new(l()).SafeString('<div style="border: 2px solid orange; padding: 10px; margin: 5px 0;">'+'<strong style="color: orange;">[Property \''.concat(r.name,"' used as block helper]</strong>")+"<div>".concat(a,"</div>")+"</div>")})}function u(){l().unregisterHelper("blockHelperMissing"),l().unregisterHelper("helperMissing")}},47137:function(e,t,n){n.d(t,{i:function(){return i}});var r=n(68328),l=n(4505),o=n(53830),a=n(54133);function i(e){let{html:t,containerRef:n,contentEditable:i,setHtml:s,pageHeight:c,pageWidth:d}=e,m=(0,l.useRef)(t),f=(0,l.useRef)(t);(0,l.useEffect)(()=>()=>{let e=(0,a.jY)(m.current);e!==f.current&&(null==s||s(e),f.current=e)},[s]);let p="<style>\n      section {\n         width: ".concat(d||210,"mm !important; \n         min-height: ").concat(c||297,"mm !important;\n         overflow: hidden;\n      } \n   </style>");return(0,r.jsxs)(o.ZP.div,{children:[(0,r.jsx)(u,{}),(0,r.jsx)("div",{ref:n,dangerouslySetInnerHTML:{__html:p+t},contentEditable:i,onInput:e=>{m.current=e.currentTarget.innerHTML}})]})}function u(){return(0,r.jsx)("style",{children:"\n         section {\n            border: 1px solid #ccc;\n            box-shadow: 0 1px 3px rgba(112, 112, 112, 0.3);\n         }\n         section + section {\n            marginTop: 1rem;\n         }\n      "})}},54133:function(e,t,n){function r(e){return(function(e){let t=new DOMParser;return e.replace(/{{2,}([\s\S]*?)}{2,}/gm,e=>t.parseFromString(e,"text/html").body.textContent||"")})(e).replace(/[“”]/g,'"')}function l(e,t){return t?e?"object"==typeof e&&"object"==typeof t?{customFields:t,...e}:{}:t||{}:e||{}}n.d(t,{M7:function(){return o},SX:function(){return i},ar:function(){return u},b3:function(){return l},jY:function(){return r},l1:function(){return s},o4:function(){return c}});let o=[{key:"A4",width:210,height:297},{key:"A5",width:148,height:210}],a=e=>{if(null==e)return null;if("number"==typeof e)return e;let t=e.trim();if(!t)return null;let n=parseFloat(t.replace("mm",""));return Number.isNaN(n)?null:n};function i(e,t){var n;let r=a(e),l=a(t);return r&&l&&null!==(n=o.find(e=>e.width===r&&e.height===l))&&void 0!==n?n:null}function u(e){let t=o.find(t=>t.key===e);return t?{pageWidth:t.width,pageHeight:t.height}:{pageWidth:210,pageHeight:297}}function s(e){return"".concat(e.key," (").concat(e.width," x ").concat(e.height,"mm)")}function c(e){let t=[],n=null,r=null,l=!1,o=[],a=[],i=e=>e.map((e,t)=>"string"==typeof e&&e.startsWith("[")?".".concat(e):0===t?e:".".concat(e)).join(""),u=(e,t)=>{t&&(e.setAttribute("data-path",t),e.style.cursor="pointer")},s=e=>{if(e.nodeType===Node.ELEMENT_NODE){var c,d;let m=null!==(d=null===(c=e.textContent)||void 0===c?void 0:c.trim())&&void 0!==d?d:"";if(e.classList.contains("hljs-punctuation")){if("{"===m){if(null!==n)t.push(n),r&&(u(r,i(t)),r=null),n=null;else if(l){let e=o[o.length-1];t.push("[".concat(e,"]")),o[o.length-1]++}a.push("object")}else if("}"===m)"object"===a[a.length-1]&&(a.pop(),t.length>0&&t.pop());else if("["===m){if(null!==n)t.push(n),r&&(u(r,i(t)),r=null),n=null;else if(l){let e=o[o.length-1];t.push("[".concat(e,"]")),o[o.length-1]++}a.push("array"),o.push(0),l=!0}else"]"===m&&"array"===a[a.length-1]&&(a.pop(),o.pop(),l=o.length>0,t.length>0&&t.pop())}else if(e.classList.contains("hljs-attr"))n=m.replace(/^"|"$/g,""),r=e;else if(e.classList.contains("hljs-string")||e.classList.contains("hljs-number")||e.classList.contains("hljs-literal")){let a=[...t];if(null!==n)a.push(n),n=null;else if(l){let e=o[o.length-1];a.push("[".concat(e,"]")),o[o.length-1]++}let s=i(a);u(e,s),r&&(u(r,s),r=null)}for(let t of Array.from(e.childNodes))s(t)}};s(e)}},94441:function(e,t,n){n.d(t,{B:function(){return r}});function r(e){if(null==e)return null;let{name:t,smsPhone:n,activeLogo:r,phone1:l,phone2:o,address:a,division:i,city:u,middleDate:s,firstDeliveryDate:c,secondDeliveryDate:d,roomCheckInDate:m,serviceCharge:f,indoorServiceCharge:p,serviceChargePaymentPeriod:h,serviceChargePaymentDate:g}=e;return{name:t,smsPhone:n,activeLogo:r,phone1:l,phone2:o,address:a,division:i,city:u,middleDate:s,firstDeliveryDate:c,secondDeliveryDate:d,roomCheckInDate:m,serviceCharge:f,indoorServiceCharge:p,serviceChargePaymentPeriod:h,serviceChargePaymentDate:g}}},96720:function(e,t,n){n.r(t),n.d(t,{PrintProvider:function(){return O},usePrint:function(){return A}});var r=n(68328),l=n(2929),o=n(41224),a=n(22041),i=n(22975),u=n(22614),s=n(31204),c=n(58185),d=n(4505),m=n(70103),f=n(88412),p=n(51930),h=n(31151),g=n(72226),y=n(25499),T=n(62717),v=n(36083),S=n(94441);let E=(0,d.createContext)(null);function b(e){var t,n;let{uiRef:E}=e,b=(0,d.useRef)(null),[O,A]=(0,d.useState)(!1),[M,_]=(0,d.useState)({}),[C,I]=(0,d.useState)(null),[R]=(0,m.pi)(),j=(0,y.C)(e=>e.auth.diagnostic),{executeFunction:x,lastError:P}=(0,T.U)(),[w,L]=(0,d.useState)(null),[N,D]=(0,d.useState)(null),{html:k,expressionMap:W}=w||{},H=(0,d.useMemo)(()=>(null==C?void 0:C.data)||{},[C]),B=N&&H&&(null==N.dummyData||0==Object.keys(N.dummyData).length),Y=(0,d.useCallback)(async()=>{var e,t;if(null==C||null===(e=C.onAfterPrint)||void 0===e||e.call(C),null==C||null===(t=C.onAfterModalClose)||void 0===t||t.call(C),I(null),A(!1),B)try{await R({ctgId:N.name,dummyData:H}).unwrap(),h.toast.info("Data stored as dummy data for future prints")}catch(e){h.toast.error("Failed to store dummy data"),console.log({ctgId:N,dataToStore:H,dummyData:null==N?void 0:N.dummyData})}},[N,H,B,R,C]),q=(0,f.useReactToPrint)({documentTitle:N?p.H[N.name]:"Print",removeAfterPrint:!0,onAfterPrint:Y}),U=(0,d.useCallback)(()=>{q(void 0,()=>b.current)},[q]);E.current={async update(e){if((0,v.TP)(),!e){A(!1);return}try{let t=(null==w?void 0:w.transformFunction)||"",n=e.data||{},r=t&&n?await x(t,n):{};_(r),I(e),e.modal?A(!0):setTimeout(()=>{q(void 0,()=>b.current)},0)}catch(e){h.toast.error((0,r.jsxs)(o.Stack,{children:[(0,r.jsx)(a.Text,{children:"Failed to calculate custom data for print"}),(0,r.jsx)(a.Text,{size:"xs",c:"dimmed",children:P})]}))}},setup:e=>{e.template&&L(e.template),e.category&&D(e.category)}};let F=(0,d.useMemo)(()=>{let e={customFields:M,...null==C?void 0:C.data,diagnosticInfo:(0,S.B)(j)};return console.log(W),(0,g.s)(e,null!=W?W:{})},[C,W,M,j]);return(0,r.jsxs)(i.u.Root,{opened:O,size:"max-content",maw:"100vw",onClose:()=>A(!1),keepMounted:!0,children:[(0,r.jsx)(i.u.Overlay,{}),(0,r.jsxs)(i.u.Content,{style:{overflowX:"hidden"},children:[(0,r.jsxs)(i.u.Header,{children:[(0,r.jsx)(i.u.Title,{children:"Print Preview"}),(0,r.jsxs)(u.Group,{gap:"xs",children:[(0,r.jsx)(s.Button,{onClick:U,leftSection:(0,r.jsx)(c.Z,{size:14}),size:"xs",children:"Print"}),(0,r.jsx)(i.u.CloseButton,{})]})]}),(0,r.jsx)(i.u.Body,{children:(0,r.jsx)(l.M,{containerRef:b,html:null!==(n=null!==(t=null==C?void 0:C.html)&&void 0!==t?t:k)&&void 0!==n?n:"No Template Provided",data:F})})]})]})}function O(e){let{children:t}=e,n=(0,d.useRef)(null),l=(0,d.useCallback)(e=>{var t;null===(t=n.current)||void 0===t||t.update(e)},[]),o=(0,d.useCallback)(()=>{var e;null===(e=n.current)||void 0===e||e.update(null)},[]),a=(0,d.useCallback)(e=>{var t;null===(t=n.current)||void 0===t||t.setup(e)},[]),i=(0,d.useRef)({print:l,closeModal:o,setup:a}).current;return(0,r.jsxs)(E.Provider,{value:i,children:[t,(0,r.jsx)(b,{uiRef:n})]})}function A(e){var t,n;let r=(0,d.useContext)(E),{data:l}=(0,m.$Q)(e);if(!r)throw Error("usePrint must be used within a PrintProvider");let o=null==l?void 0:null===(t=l.data)||void 0===t?void 0:t[0],a=null==o?void 0:o.diagnosticTemplates,i=null!==(n=null==a?void 0:a.find(e=>e.isDefault))&&void 0!==n?n:null==a?void 0:a[0];return(0,d.useEffect)(()=>{i&&o&&r.setup({category:o,template:i})},[i,o,r,e]),r}},62717:function(e,t,n){n.d(t,{U:function(){return l}});var r=n(4505);function l(){let e=(0,r.useRef)(null),[t,l]=(0,r.useState)(!1),[o,a]=(0,r.useState)(null),i=(0,r.useRef)(null);return{executeFunction:(0,r.useCallback)((t,r)=>new Promise((o,u)=>{l(!0),a(null),e.current||(e.current=new Worker(n.tu(new URL(n.p+n.u(832),n.b))));let s=e.current,c=e=>{if(i.current&&(clearTimeout(i.current),i.current=null),l(!1),s.removeEventListener("message",c),s.removeEventListener("error",d),e.data.success&&e.data.result)o(e.data.result);else{let t=e.data.error||"Execution failed";a(t),u(t)}},d=e=>{i.current&&(clearTimeout(i.current),i.current=null),l(!1),s.removeEventListener("message",c),s.removeEventListener("error",d);let t=e.message||"Worker error";a(t),u(t)};s.addEventListener("message",c),s.addEventListener("error",d),i.current=setTimeout(()=>{s.terminate(),e.current=null,i.current=null,l(!1);let t="Execution timed out (10s)";a(t),u(t)},1e4),s.postMessage({code:t,data:r})}),[]),isExecuting:t,lastError:o,terminate:(0,r.useCallback)(()=>{i.current&&(clearTimeout(i.current),i.current=null),e.current&&(e.current.terminate(),e.current=null),l(!1)},[])}}},70103:function(e,t,n){n.d(t,{$Q:function(){return d},A9:function(){return a},JF:function(){return l},JT:function(){return c},ZM:function(){return r},pi:function(){return m},rg:function(){return s},wD:function(){return i}});let{useCreateAdminTemplateMutation:r,useGetAdminTemplatesQuery:l,useGetAvailableTemplatesQuery:o,useGetAdminTemplateQuery:a,useUpdateAdminTemplateMutation:i,useAssignTemplateMutation:u,useUnassignTemplateMutation:s,useSetDefaultTemplateMutation:c,useGetTemplatesByCategoryQuery:d,useUpdateCategoryMutation:m}=n(78101).g.injectEndpoints({overrideExisting:!0,endpoints:e=>({createAdminTemplate:e.mutation({query:e=>({url:"/template/admin",method:"POST",body:e}),invalidatesTags:["template"]}),getAdminTemplates:e.query({query:e=>({url:"/template/admin",method:"GET",params:e||void 0}),providesTags:["template"],transformResponse:e=>({data:e.data})}),getAvailableTemplates:e.query({query:e=>({url:"/template/admin/available",method:"GET",params:e||void 0}),providesTags:["template"],transformResponse:e=>({data:e.data})}),getAdminTemplate:e.query({query:e=>({url:"/template/admin/".concat(e),method:"GET"}),providesTags:(e,t,n)=>[{type:"template",id:n}],transformResponse:e=>({data:e.data})}),updateAdminTemplate:e.mutation({query:e=>{let{id:t,...n}=e;return{url:"/template/admin/".concat(t),method:"PATCH",body:n}},invalidatesTags:(e,t,n)=>{let{id:r}=n;return["template",{type:"template",id:r}]}}),assignTemplate:e.mutation({query:e=>({url:"/template/admin/assign",method:"POST",body:e}),invalidatesTags:["template"]}),unassignTemplate:e.mutation({query:e=>({url:"/template/admin/".concat(e),method:"DELETE"}),invalidatesTags:(e,t,n)=>["template",{type:"template",id:n}]}),setDefaultTemplate:e.mutation({query:e=>({url:"/template/admin/".concat(e,"/default"),method:"PATCH"}),invalidatesTags:["template"]}),getTemplatesByCategory:e.query({query:e=>({url:"/template/category/".concat(e),method:"GET"}),providesTags:(e,t,n)=>[{type:"template",id:"category-".concat(n)}],transformResponse:e=>({data:e.data})}),updateCategory:e.mutation({query:e=>{let{ctgId:t,...n}=e;return{url:"/template/category/".concat(t),method:"PATCH",body:n}},invalidatesTags:(e,t,n)=>{let{ctgId:r}=n;return["template",{type:"template",id:"category-".concat(r)}]}})})})},74559:function(e,t,n){n.d(t,{Im:function(){return a},av:function(){return o},nC:function(){return l}});let r=(0,n(79258).createSlice)({name:"auth",initialState:{isAuth:null,user:null,isProfileIncomplete:!1,diagnostic:null},reducers:{setUser:(e,t)=>{var n;e.user=t.payload,e.isAuth=!!t.payload,(null===(n=t.payload)||void 0===n?void 0:n.name)?localStorage.setItem("name",t.payload.name):localStorage.removeItem("name")},setDiagnostic:(e,t)=>{let n=t.payload;"hospital.sasthotech.com"===window.location.hostname?n.activeLogo=n.logo:n.activeLogo=n.offlineLogo,e.diagnostic=n},setProfileIncomplete:(e,t)=>{e.isProfileIncomplete=t.payload}}}),l=e=>{var t;return null===(t=e.auth.user)||void 0===t?void 0:t.role},{setUser:o,setDiagnostic:a}=r.actions;t.ZP=r.reducer}}]);